<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SQL Quick Reference Library</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="!RefLibraryFor_SQL__files/libs/clipboard/clipboard.min.js"></script>
<script src="!RefLibraryFor_SQL__files/libs/quarto-html/quarto.js"></script>
<script src="!RefLibraryFor_SQL__files/libs/quarto-html/popper.min.js"></script>
<script src="!RefLibraryFor_SQL__files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="!RefLibraryFor_SQL__files/libs/quarto-html/anchor.min.js"></script>
<link href="!RefLibraryFor_SQL__files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="!RefLibraryFor_SQL__files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="!RefLibraryFor_SQL__files/libs/bootstrap/bootstrap.min.js"></script>
<link href="!RefLibraryFor_SQL__files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="!RefLibraryFor_SQL__files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SQL Quick Reference Library</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="using-this-document" class="level1">
<h1>Using this document</h1>
<section id="code-chunks---fyi" class="level2">
<h2 class="anchored" data-anchor-id="code-chunks---fyi">Code Chunks - FYI</h2>
<p>When creating .qmd documents you can use the following to create code chunks. Eval (evaluation) means you want the code chunk to actually run and display its results in the final document, while include means that you want to display the code chunk (false would mean to hide it) in the final document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="links" class="level1">
<h1>Links</h1>
<p>This is an example of a link format <code>[Link text](https://example.com)</code></p>
</section>
<section id="to-actually-knittstitch-this-document-you-will-need-to-have-python-r-and-quarto-installed-on-your-machine-through-visual-studio-code-or-rstudio." class="level1">
<h1>To actually knitt/stitch this document you will need to have Python, R, and Quarto installed on your machine through Visual Studio Code (or RStudio).</h1>
<p><a href="https://quarto.org/docs/get-started/">Quarto</a></p>
<p><a href="https://cran.r-project.org/bin/windows/base/">Install R</a></p>
<p><a href="https://www.python.org/downloads/">Install Python</a></p>
</section>
<section id="sql-quick-reference-materials-from-w3schools" class="level1">
<h1>SQL Quick Reference Materials from W3Schools</h1>
<p>Many of the original materials for this quick reference library were borrowed from W3Schools and the Google Data Analytics Certification through Coursera. However, after coding SQL for over a year and building hundreds of scripts and thousands of lines of code, and working through ChatGPT to build ideas for unique solutions, this codebase can no longer be considered to have one source. I share it freely, I hope it helps.</p>
<p>Darrell Wolfe, Business Intelligence Analyst (BIA) 08/14/2024</p>
<hr>
<section id="useful-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="useful-comparisons">Useful Comparisons</h2>
<p>From Mike Dunn at XTR: I was talking about the EXCEPT “SET” command This compares two columns in the CADINV table for the annual roll for years 2021 and 2022 You can compare any table in multiple databases, but the number of columns has to be identical.</p>
<p>This will show ALL PIN, AIN that exists in 2021 that DO NOT exist in 2022</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ci.PIN, ci.AIN </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> CADInv ci</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="dt">year</span>(ci.InvEffDate) <span class="op">=</span> <span class="dv">2021</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> RollCaste <span class="op">=</span> <span class="dv">16001</span> <span class="co">-- ANNUAL</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> ci.PIN, ci.AIN</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">EXCEPT</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ci.PIN, ci.AIN </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> CADInv ci</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="dt">year</span>(ci.InvEffDate) <span class="op">=</span> <span class="dv">2022</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> RollCaste <span class="op">=</span> <span class="dv">16001</span> <span class="co">-- ANNUAL</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> ci.PIN, ci.AIN</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a># This will show <span class="kw">ALL</span> PIN, AIN that <span class="kw">exists</span> <span class="kw">in</span> <span class="dv">2021</span> that DO <span class="kw">NOT</span> exist <span class="kw">in</span> <span class="dv">2022</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can flip this: and it shoes al PIN, AIN in 2022 and NOT in 2021</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ci.PIN, ci.AIN </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> CADInv ci</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="dt">year</span>(ci.InvEffDate) <span class="op">=</span> <span class="dv">2022</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> RollCaste <span class="op">=</span> <span class="dv">16001</span> <span class="co">-- ANNUAL</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> ci.PIN, ci.AIN</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">EXCEPT</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ci.PIN, ci.AIN </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> CADInv ci</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="dt">year</span>(ci.InvEffDate) <span class="op">=</span> <span class="dv">2021</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> RollCaste <span class="op">=</span> <span class="dv">16001</span> <span class="co">-- ANNUAL</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> ci.PIN, ci.AIN</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a># <span class="kw">and</span> it shoes al PIN, AIN <span class="kw">in</span> <span class="dv">2022</span> <span class="kw">and</span> <span class="kw">NOT</span> <span class="kw">in</span> <span class="dv">2021</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>the opposite on EXCEPT is INTERSECT</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ci.PIN, ci.AIN </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> CADInv ci</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="dt">year</span>(ci.InvEffDate) <span class="op">=</span> <span class="dv">2022</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> RollCaste <span class="op">=</span> <span class="dv">16001</span> <span class="co">-- ANNUAL</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> ci.PIN, ci.AIN</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">INTERSECT</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ci.PIN, ci.AIN </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> CADInv ci</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> <span class="dt">year</span>(ci.InvEffDate) <span class="op">=</span> <span class="dv">2021</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> RollCaste <span class="op">=</span> <span class="dv">16001</span> <span class="co">-- ANNUAL</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> ci.PIN, ci.AIN</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="most-common-errors" class="level2">
<h2 class="anchored" data-anchor-id="most-common-errors">Most Common Errors</h2>
<section id="joins" class="level3">
<h3 class="anchored" data-anchor-id="joins">Joins</h3>
<section id="improvements-of-any-kind-must-filter-with-extensions" class="level4">
<h4 class="anchored" data-anchor-id="improvements-of-any-kind-must-filter-with-extensions">Improvements of any kind, must filter with Extensions</h4>
<p>If you pull improvements or dwellings without an INNER join on extensions, you will get voided records in your results even if it is otherwise filtered for ACTIVE. You must join extensions on lrsn and on extensions to either of these tables (and probably any other table that has extensions on it)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">From</span> improvements <span class="kw">AS</span> i</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Join</span> extensions <span class="kw">AS</span> e</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">On</span> e.lrsn <span class="op">=</span> i.lrsn</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">And</span> e.extension <span class="op">=</span> i.extension</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">And</span> e.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> dwellings <span class="kw">AS</span> d</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Join</span> extensions <span class="kw">AS</span> e</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">On</span> e.lrsn <span class="op">=</span> d.lrsn</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">And</span> e.extension <span class="op">=</span> d.extension</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">And</span> e.status <span class="op">=</span> <span class="st">'A'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="commas-missing-or-incorrect-placement" class="level3">
<h3 class="anchored" data-anchor-id="commas-missing-or-incorrect-placement">Commas: Missing or Incorrect Placement</h3>
<p>Started using commas behind the select list items</p>
</section>
<section id="with" class="level3">
<h3 class="anchored" data-anchor-id="with">WITH</h3>
<p>CTE Either WITH is missing, or there is an extra WITH</p>
</section>
<section id="cte-in-tableau" class="level3">
<h3 class="anchored" data-anchor-id="cte-in-tableau">CTE in Tableau</h3>
<p>Common table expressions (CTEs) are useful when using “Custom SQL” as a data source in Tableau. CTEs make SQL code more readable, especially for more complex SQL statements. However, Tableau does not support CTEs in “Custom SQL”. Instead, you can use CTEs in “Initial SQL”. To use CTEs in Tableau, you can: Select Data &gt; New Data Source and choose your data source. In the Server Connection dialog box, choose Initial SQL. Enter your CTE in the Initial SQL field. Create a Custom SQL query that selects from the temp table you inserted the records into.</p>
<p>Common Table Expressions (CTEs) are named temporary result sets that are used to manipulate complex sub-query data. CTEs are often preferred over temporary tables when you need to simplify complex queries and improve query readability. CTEs can only be used in the current query scope. Temporary tables are physically created in the tempdb database and can exist for the entire duration of the session. You can use temporary tables when the number of steps needed to solve the problem gets high, or when dealing with really large data sets.</p>
<p>To use CTEs in Tableau, you can: In the Data Source page, click on the caret icon by your current connection and click</p>
<p>Initial SQL.</p>
<p>Add a Custom SQL Query and enter the following:</p>
<p>INTO #temptable</p>
<p>SELECT * FROM #temptable</p>
<p>Tableau does not support CTE expressions in “Custom SQL”.</p>
<hr>
</section>
</section>
<section id="most-common-references" class="level2">
<h2 class="anchored" data-anchor-id="most-common-references">Most Common References</h2>
</section>
<section id="declare-variables" class="level2">
<h2 class="anchored" data-anchor-id="declare-variables">Declare Variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @TaxYear <span class="dt">INT</span>;</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> @TaxYear <span class="op">=</span> <span class="dt">YEAR</span>(GETDATE());</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- You can use @TaxYear in your queries below</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">SET @TaxYear = CASE </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">                   WHEN MONTH(GETDATE()) &gt;= 6 THEN YEAR(GETDATE())</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">                   ELSE YEAR(GETDATE()) - 1</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">               </span><span class="re">END</span><span class="co">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="handling-dates" class="level2">
<h2 class="anchored" data-anchor-id="handling-dates">Handling Dates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>f.date_completed <span class="kw">AS</span> DateCompleted</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>,<span class="dt">YEAR</span>(f.date_completed) <span class="kw">AS</span> Compl_Year</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>,<span class="dt">MONTH</span>(f.date_completed) <span class="kw">AS</span> Compl_Month</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>,<span class="dt">DAY</span>(f.date_completed) <span class="kw">AS</span> Compl_Day</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>,DATENAME(<span class="dt">MONTH</span>, f.date_completed) <span class="kw">AS</span> Compl_MonthName</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">--Declare @Year int = 2024; -- Input THIS year here</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @TaxYear <span class="dt">INT</span>;</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> @TaxYear <span class="op">=</span> <span class="dt">YEAR</span>(GETDATE());</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">--OR </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">--Declare @Year int = 2024; -- Input THIS year here</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @YearPrev <span class="dt">int</span> <span class="op">=</span> @Year <span class="op">-</span> <span class="dv">1</span>; <span class="co">-- Input the year here</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @YearPrev2 <span class="dt">int</span> <span class="op">=</span> @Year <span class="op">-</span> <span class="dv">2</span>; <span class="co">-- Input the year here</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @YearPrev3 <span class="dt">int</span> <span class="op">=</span> @Year <span class="op">-</span> <span class="dv">3</span>; <span class="co">-- Input the year here</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @YearPrev4 <span class="dt">int</span> <span class="op">=</span> @Year <span class="op">-</span> <span class="dv">4</span>; <span class="co">-- Input the year here</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @YearPrev5 <span class="dt">int</span> <span class="op">=</span> @Year <span class="op">-</span> <span class="dv">5</span>; <span class="co">-- Input the year here</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Current <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@Year <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Previous <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Previous2 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev2 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Previous3 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev3 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Previous4 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev4 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Previous5 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev5 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDateCurrent <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@Year <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2023-01-01' for the current year</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDatePrevious <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@YearPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2022-01-01' for the previous year</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDatePrevious2 <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@YearPrev2 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2022-01-01' for the previous year</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDatePrevious3 <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@YearPrev3 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2022-01-01' for the previous year</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDatePrevious4 <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@YearPrev4 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2022-01-01' for the previous year</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDatePrevious5 <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@YearPrev5 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2022-01-01' for the previous year</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYearLike <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@Year <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '2023%' for the previous year</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYearLikePrevious <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '2023%' for the previous year</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYearLikePrevious2 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev2 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '2023%' for the previous year</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYearLikePrevious3 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev3 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '2023%' for the previous year</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYearLikePrevious4 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev4 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '2023%' for the previous year</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYearLikePrevious5 <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev5 <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '2023%' for the previous year</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypehoex <span class="dt">INT</span> <span class="op">=</span> <span class="dv">305</span>;</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">--    305 HOEX_Exemption Homeowner Exemption</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypeimp <span class="dt">INT</span> <span class="op">=</span> <span class="dv">103</span>;</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co">--    103 Imp Assessed Improvement Assessed</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypeland <span class="dt">INT</span> <span class="op">=</span> <span class="dv">102</span>;</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co">--    102 Land Assessed Land Assessed</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypetotal <span class="dt">INT</span> <span class="op">=</span> <span class="dv">109</span>;</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co">--    109 Total Value Total Value</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NetTaxableValueImpOnly <span class="dt">INT</span> <span class="op">=</span> <span class="dv">458</span>;</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co">--    458 Net Imp Only Net Taxable Value Imp Only</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NetTaxableValueTotal <span class="dt">INT</span> <span class="op">=</span> <span class="dv">455</span>;</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="co">--    455 Net Tax Value Net Taxable Value</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NewConstruction <span class="dt">INT</span> <span class="op">=</span> <span class="dv">651</span>;</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">--    651 NewConstByCat New Construction</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @AssessedByCat <span class="dt">INT</span> <span class="op">=</span> <span class="dv">470</span>;</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co">--470 AssessedByCat Assessed Value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">--Declare @Year int = 2024; -- Input THIS year here</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @TaxYear <span class="dt">INT</span>;</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> @TaxYear <span class="op">=</span> <span class="dt">YEAR</span>(GETDATE());</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @YearPrev <span class="dt">int</span> <span class="op">=</span> @Year <span class="op">-</span> <span class="dv">1</span>; <span class="co">-- Input the year here</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @YearPrevPrev <span class="dt">int</span> <span class="op">=</span> @Year <span class="op">-</span> <span class="dv">2</span>; <span class="co">-- Input the year here</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">--VARCHAR String with the two letters plus last two of year, allows for NC Memos in this case</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NCYear <span class="dt">varchar</span>(<span class="dv">4</span>) <span class="op">=</span> <span class="st">'NC'</span> <span class="op">+</span> <span class="kw">Right</span>(<span class="fu">Cast</span>(@Year <span class="kw">as</span> <span class="dt">varchar</span>), <span class="dv">2</span>); <span class="co">-- This will create 'NC24'</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NCYearPrevious <span class="dt">varchar</span>(<span class="dv">4</span>) <span class="op">=</span> <span class="st">'NC'</span> <span class="op">+</span> <span class="kw">Right</span>(<span class="fu">Cast</span>(@YearPrev <span class="kw">as</span> <span class="dt">varchar</span>), <span class="dv">2</span>); <span class="co">-- This will create 'NC23'</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">--EXACT NO-DASHES '20230101'</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Current <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@Year <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101Previous <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101PreviousPrevious <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrevPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'0101'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">--EXACT DASHES '2023-01-01'</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDateCurrent <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@Year <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2023-01-01' for the current year</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValEffDatePrevious <span class="dt">date</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@YearPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>); <span class="co">-- Generates '2022-01-01' for the previous year</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">--And CAST(i.ValEffDate AS DATE) = '2023-01-01'</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">--LIKE Year with Perce Symbol 2023%</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101PreviousLike <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">--Where eff_year LIKE '2023%'Results include --20230101 --20230804</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101PreviousPreviousLike <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@YearPrevPrev <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @EffYear0101CurrentLike <span class="dt">varchar</span>(<span class="dv">8</span>) <span class="op">=</span> <span class="fu">Cast</span>(@Year <span class="kw">as</span> <span class="dt">varchar</span>) <span class="op">+</span> <span class="st">'%'</span>; <span class="co">-- Generates '20230101' for the previous year</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">-- These ValueTypes are for the Cadastre Queries</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypeimp <span class="dt">INT</span> <span class="op">=</span> <span class="dv">103</span>;</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">--    103 Imp Assessed Improvement Assessed</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypeland <span class="dt">INT</span> <span class="op">=</span> <span class="dv">102</span>;</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">--    102 Land Assessed Land Assessed</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypetotal <span class="dt">INT</span> <span class="op">=</span> <span class="dv">109</span>;</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">--    109 Total Value Total Value</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NetTaxableValueImpOnly <span class="dt">INT</span> <span class="op">=</span> <span class="dv">458</span>;</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">--    458 Net Imp Only Net Taxable Value Imp Only</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NetTaxableValueTotal <span class="dt">INT</span> <span class="op">=</span> <span class="dv">455</span>;</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co">--    455 Net Tax Value Net Taxable Value</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @NewConstruction <span class="dt">INT</span> <span class="op">=</span> <span class="dv">651</span>;</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">--    651 NewConstByCat New Construction</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @AssessedByCat <span class="dt">INT</span> <span class="op">=</span> <span class="dv">470</span>;</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">--470 AssessedByCat Assessed Value</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="kw">Declare</span> @ValueTypehoex <span class="dt">INT</span> <span class="op">=</span> <span class="dv">305</span>;</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">--    305 HOEX_Exemption Homeowner Exemption</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">--</span><span class="al">NOTE</span><span class="co">: For HOEX from Cadaster, it will only pull fro a locked roll</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">--If the current year roll is locked, and you use @Year no values will populate</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  <span class="co">--If the @YearPrev is used, you will pull last year's cadasters not this years</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">--Divide by zero error fix. </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>,(wk.Worksheet_Total_Market <span class="op">/</span> <span class="fu">NULLIF</span>(market.Tax_Year_Market, <span class="dv">0</span>)) <span class="kw">AS</span> WorkMarket_Perc_CertMarket_Total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="search-entire-database" class="level3">
<h3 class="anchored" data-anchor-id="search-entire-database">Search Entire Database</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">--Find a table name like... </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> information_schema.<span class="kw">columns</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> table_name <span class="kw">LIKE</span> <span class="st">'CAD%'</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">OR</span> table_name <span class="kw">LIKE</span> <span class="st">'Value%'</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> information_schema.<span class="kw">columns</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> table_name <span class="kw">LIKE</span> <span class="st">'TIF%'</span>;</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">--Find a table with a Column Name like...</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> information_schema.<span class="kw">columns</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name <span class="kw">LIKE</span> <span class="st">'TaxCalcDetail%'</span>;</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> information_schema.<span class="kw">columns</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name <span class="kw">LIKE</span> <span class="st">'%Due%'</span>;</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">--Complex Example</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    tc.table_name <span class="kw">AS</span> foreign_table,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    kcu.column_name <span class="kw">AS</span> foreign_column,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    ccu.table_name <span class="kw">AS</span> primary_table,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    ccu.column_name <span class="kw">AS</span> primary_column</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    information_schema.table_constraints <span class="kw">AS</span> tc</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> information_schema.key_column_usage <span class="kw">AS</span> kcu <span class="kw">ON</span> tc.constraint_name <span class="op">=</span> kcu.constraint_name</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> information_schema.constraint_column_usage <span class="kw">AS</span> ccu <span class="kw">ON</span> ccu.constraint_name <span class="op">=</span> tc.constraint_name</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    tc.constraint_type <span class="op">=</span> <span class="st">'FOREIGN KEY'</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> kcu.table_name <span class="op">=</span> <span class="st">'YourTableName'</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> kcu.column_name <span class="op">=</span> <span class="st">'YourIDColumnName'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="row_number" class="level3">
<h3 class="anchored" data-anchor-id="row_number">ROW_NUMBER</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> ### <span class="kw">ORDER</span> <span class="kw">BY</span> ### <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="kw">RowNum</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a># Explained: </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> #GroupByColumn# <span class="kw">ORDER</span> <span class="kw">BY</span> #FilterOutColumn# <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="kw">RowNum</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a># Example: </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> pm.lrsn <span class="kw">ORDER</span> <span class="kw">BY</span> v.Last_Updated <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="kw">RowNum</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="trim" class="level3">
<h3 class="anchored" data-anchor-id="trim">TRIM()</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a># Newer Style, Post <span class="dv">2017</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">TRIM</span>() <span class="op">&lt;-</span> <span class="cf">For</span> SQL Server <span class="kw">after</span> <span class="dv">2017</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a># Older Style Pre <span class="dv">2017</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">LTRIM</span>(<span class="fu">RTRIM</span>()) <span class="op">&lt;-</span> <span class="cf">For</span> SQL Server <span class="kw">before</span> <span class="dv">2017</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ctes" class="level3">
<h3 class="anchored" data-anchor-id="ctes">CTEs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> CTE_NameYouAssign <span class="kw">AS</span> (</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Example:</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WITH</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    CTE_1 <span class="kw">AS</span> (),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    CTE_2 <span class="kw">AS</span> (),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    CTE_3 <span class="kw">AS</span> ()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="op">*</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> CTE_1 <span class="kw">AS</span> <span class="dv">1</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> CTE_2 <span class="kw">AS</span> <span class="dv">2</span> <span class="kw">ON</span> <span class="fl">1.</span>lrsn<span class="op">=</span><span class="fl">2.</span>RevObjId</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> CTE_3 <span class="kw">AS</span> <span class="dv">3</span> <span class="kw">ON</span> <span class="fl">1.</span>lrsn<span class="op">=</span><span class="fl">3.</span>RevObjId</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span><span class="op">..</span>. </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ctes-with-variables-example-1" class="level3">
<h3 class="anchored" data-anchor-id="ctes-with-variables-example-1">CTEs with Variables Example 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @TaxYear <span class="dt">INT</span> <span class="op">=</span> <span class="dv">2024</span>; </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Current Tax Year -- Change this to the current tax year</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @MemoID <span class="dt">VARCHAR</span>(<span class="dv">4</span>); <span class="co">-- Specify an appropriate length</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">--WHERE m.memo_id='RY24'</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> @MemoID <span class="op">=</span> <span class="fu">CAST</span>(<span class="st">'RY'</span> <span class="op">+</span> <span class="kw">RIGHT</span>(<span class="fu">CAST</span>(@TaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">4</span>)), <span class="dv">2</span>) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">4</span>));</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>CTE_Memos_RY <span class="kw">AS</span> (</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="kw">Select</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>m.lrsn</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>,m.memo_id</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>,m.memo_text <span class="kw">AS</span> RY_Memo</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> memos <span class="kw">AS</span> m</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> m.memo_id <span class="op">=</span> @MemoID</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">--WHERE m.memo_id='RY24'</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> m.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> m.memo_line_number <span class="op">&lt;&gt;</span> <span class="st">'1'</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ctes-with-variables-example-2" class="level3">
<h3 class="anchored" data-anchor-id="ctes-with-variables-example-2">CTEs with Variables Example 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- !preview conn=conn</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">AsTxDBProd</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">GRM_Main</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @TaxYear <span class="dt">INT</span> <span class="op">=</span> <span class="dv">2024</span>; </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">-- Current Tax Year -- Change this to the current tax year</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @MemoID <span class="dt">VARCHAR</span>(<span class="dv">4</span>); <span class="co">-- Specify an appropriate length</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">-----------------</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">-- By changing these years, you will have effectively changed all effective years</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">-----------------</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">--WHERE m.memo_id='RY24'</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> @MemoID <span class="op">=</span> <span class="fu">CAST</span>(<span class="st">'RY'</span> <span class="op">+</span> <span class="kw">RIGHT</span>(<span class="fu">CAST</span>(@TaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">4</span>)), <span class="dv">2</span>) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">4</span>));</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @PrevTaxYear <span class="dt">INT</span> <span class="op">=</span> @TaxYear <span class="op">-</span> <span class="dv">1</span>;</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">-- Now, derive other variables from @TaxYear</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @PrimaryTransferDateFROM <span class="dt">DATE</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@TaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="op">+</span> <span class="st">'-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>);</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @PrimaryTransferDateTO <span class="dt">DATE</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@TaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="op">+</span> <span class="st">'-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>);</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @CertValueDateFROM <span class="dt">INT</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@TaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="op">+</span> <span class="st">'0101'</span> <span class="kw">AS</span> <span class="dt">INT</span>);</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @CertValueDateTO <span class="dt">INT</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@TaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="op">+</span> <span class="st">'1231'</span> <span class="kw">AS</span> <span class="dt">INT</span>);</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @PrevCertValueDateFROM <span class="dt">INT</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@PrevTaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="op">+</span> <span class="st">'0101'</span> <span class="kw">AS</span> <span class="dt">INT</span>);</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @PrevCertValueDateTO <span class="dt">INT</span> <span class="op">=</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(@PrevTaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="op">+</span> <span class="st">'1231'</span> <span class="kw">AS</span> <span class="dt">INT</span>);</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">-- Assuming you want to construct @LandModelId based on the year too, here's a potential way to do it:</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">-- Example assumes the prefix '70' is constant and the year is appended to it.</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @LandModelIdPrefix <span class="dt">VARCHAR</span>(<span class="dv">2</span>) <span class="op">=</span> <span class="st">'70'</span>; <span class="co">-- This is just an example. Adjust as needed.</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @LandModelId <span class="dt">INT</span> <span class="op">=</span> <span class="fu">CAST</span>(@LandModelIdPrefix <span class="op">+</span> <span class="fu">CAST</span>(@TaxYear <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="kw">AS</span> <span class="dt">INT</span>);</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">EXAMPLES without CAST:</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">--DECLARE @LandModelIDYear INT = 2023; </span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co">-- Current Land Model ID Year -- Change this to the desired year</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co">Declare @PrimaryTransferDateFROM DATE = '2023-01-01';</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="co">Declare @PrimaryTransferDateTO DATE = '2023-12-31';</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="co">--pxfer_date</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="co">--AND tr.pxfer_date BETWEEN '2023-01-01' AND '2023-12-31'</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co">Declare @CertValueDateFROM INT = '20230101';</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="co">Declare @CertValueDateTO INT = '20231231';</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="co">--v.eff_year</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="co">---WHERE v.eff_year BETWEEN 20230101 AND 20231231</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="co">--DECLARE @VariableName INT = '';</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="co">--Change year 2023, 2024, 2025, etc. '702023'</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="co">DECLARE @LandModelId INT = '702024';</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>CTE_ParcelMaster <span class="kw">AS</span> (</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="co">--------------------------------</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="co">--ParcelMaster</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="co">--------------------------------</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="kw">Select</span> <span class="kw">Distinct</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="cf">CASE</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">9000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">6003</span> <span class="cf">THEN</span> <span class="st">'District_6'</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">6002</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">6001</span> <span class="cf">THEN</span> <span class="st">'District_6'</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">6000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">5003</span> <span class="cf">THEN</span> <span class="st">'District_5'</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">5002</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">5001</span> <span class="cf">THEN</span> <span class="st">'District_5'</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">5000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">4000</span> <span class="cf">THEN</span> <span class="st">'District_4'</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">3000</span> <span class="cf">THEN</span> <span class="st">'District_3'</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">2000</span> <span class="cf">THEN</span> <span class="st">'District_2'</span></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">1021</span> <span class="cf">THEN</span> <span class="st">'District_1'</span></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">1020</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">1001</span> <span class="cf">THEN</span> <span class="st">'District_1'</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">1000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">451</span> <span class="cf">THEN</span> <span class="st">'Commercial'</span></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">450</span> <span class="cf">THEN</span> <span class="st">'Specialized_Cell_Towers'</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Commercial'</span></span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'N/A_or_Error'</span></span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>  <span class="cf">ELSE</span> <span class="kw">NULL</span></span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a><span class="cf">END</span> <span class="kw">AS</span> District</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a><span class="co">-- # District SubClass</span></span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>,pm.neighborhood <span class="kw">AS</span> GEO</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.NeighborHoodName) <span class="kw">AS</span> GEO_Name</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>,pm.lrsn</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.pin) <span class="kw">AS</span> PIN</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.AIN) <span class="kw">AS</span> AIN</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>,pm.ClassCD</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.PropClassDescr) <span class="kw">AS</span> Property_Class_Description</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.TAG) <span class="kw">AS</span> TAG</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.DisplayName) <span class="kw">AS</span> Owner</span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.DisplayDescr) <span class="kw">AS</span> LegalDescription</span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.SitusAddress) <span class="kw">AS</span> SitusAddress</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.SitusCity) <span class="kw">AS</span> SitusCity</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.SitusState) <span class="kw">AS</span> SitusState</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.SitusZip) <span class="kw">AS</span> SitusZip</span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.AttentionLine) <span class="kw">AS</span> AttentionLine</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.MailingAddress) <span class="kw">AS</span> MailingAddress</span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.AddlAddrLine) <span class="kw">AS</span> AddlAddrLine</span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.MailingCityStZip) <span class="kw">AS</span> MailingCityStZip</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.MailingCity) <span class="kw">AS</span> MailingCity</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.MailingState) <span class="kw">AS</span> MailingState</span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>,<span class="fu">TRIM</span>(pm.MailingZip) <span class="kw">AS</span> MailingZip</span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>,pm.LegalAcres</span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a><span class="co">--,pm.WorkValue_Land</span></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a><span class="co">--,pm.WorkValue_Impv</span></span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a><span class="co">--,pm.WorkValue_Total</span></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a><span class="co">--,pm.CostingMethod</span></span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>,pm.Improvement_Status <span class="co">-- &lt;Improved vs Vacant</span></span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a><span class="kw">From</span> TSBv_PARCELMASTER <span class="kw">AS</span> pm</span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a><span class="kw">Where</span> pm.EffStatus <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> pm.ClassCD <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'070%'</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> pm.neighborhood <span class="op">&lt;&gt;</span> <span class="dv">0</span></span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> pm.neighborhood <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a>CTE_LandInfluenceCodesKey <span class="kw">AS</span> (</span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a>  tbl_element <span class="kw">AS</span> InfluenceCode,</span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a>  tbl_element_desc <span class="kw">AS</span> InfluenceCodeDescription</span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> codes_table</span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> <span class="fu">TRIM</span>(tbl_type_code) <span class="kw">LIKE</span> <span class="st">'landinf%'</span></span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> code_status<span class="op">=</span><span class="st">'A'</span></span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a>CTE_LegendKey <span class="kw">AS</span> (</span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TRIM</span>(sr.tbl_element) <span class="kw">AS</span> Site_Rating,</span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TRIM</span>(sr.tbl_element_desc) <span class="kw">AS</span> Legend,</span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a>  <span class="cf">CASE</span></span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> <span class="fu">TRIM</span>(sr.tbl_element_desc) <span class="kw">LIKE</span> <span class="st">'Leg%'</span> <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="kw">RIGHT</span>(<span class="fu">TRIM</span>(sr.tbl_element_desc),<span class="dv">2</span>) <span class="kw">AS</span> <span class="dt">INT</span>)</span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span></span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>      <span class="cf">CASE</span></span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> sr.tbl_element_desc <span class="kw">IS</span> <span class="kw">NULL</span> <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="dv">1</span> <span class="kw">AS</span> <span class="dt">INT</span>)</span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> sr.tbl_element_desc <span class="kw">LIKE</span> <span class="st">'No%'</span> <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="dv">1</span> <span class="kw">AS</span> <span class="dt">INT</span>)</span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> sr.tbl_element_desc <span class="kw">LIKE</span> <span class="st">'Average%'</span> <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="dv">2</span> <span class="kw">AS</span> <span class="dt">INT</span>)</span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> sr.tbl_element_desc <span class="kw">LIKE</span> <span class="st">'Good%'</span> <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="dv">3</span> <span class="kw">AS</span> <span class="dt">INT</span>)</span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> sr.tbl_element_desc <span class="kw">LIKE</span> <span class="st">'Excellent%'</span> <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="dv">4</span> <span class="kw">AS</span> <span class="dt">INT</span>)</span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">ELSE</span> <span class="dv">0</span></span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a>      <span class="cf">END</span></span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true" tabindex="-1"></a>  <span class="cf">END</span> <span class="kw">AS</span> LegendNum</span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> codes_table <span class="kw">AS</span> sr </span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> sr.tbl_type_code<span class="op">=</span><span class="st">'siterating'</span></span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> code_status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb16-158"><a href="#cb16-158" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true" tabindex="-1"></a>  <span class="co">--JOIN ON</span></span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true" tabindex="-1"></a>  <span class="co">--ON ld.SiteRating = sr.tbl_element</span></span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true" tabindex="-1"></a>CTE_LandDetails <span class="kw">AS</span> (</span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true" tabindex="-1"></a>  lh.RevObjId <span class="kw">AS</span> lrsn</span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true" tabindex="-1"></a>, ld.LandType</span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true" tabindex="-1"></a>,  CONCAT_WS(<span class="st">'-'</span>,ld.LandType,lt.land_type_desc) <span class="kw">AS</span> LandType_Desc</span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true" tabindex="-1"></a>,  STRING_AGG (ld.LDAcres, <span class="st">', '</span>) <span class="kw">AS</span> LDAcres</span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true" tabindex="-1"></a>,  STRING_AGG (leg.Legend, <span class="st">', '</span>) <span class="kw">AS</span> Legend</span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Land Header</span></span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> LandHeader <span class="kw">AS</span> lh</span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Land Detail</span></span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true" tabindex="-1"></a>  <span class="kw">JOIN</span> LandDetail <span class="kw">AS</span> ld <span class="kw">ON</span> lh.<span class="kw">id</span><span class="op">=</span>ld.LandHeaderId </span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ld.EffStatus<span class="op">=</span><span class="st">'A'</span> </span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ld.PostingSource<span class="op">=</span><span class="st">'A'</span></span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> lh.PostingSource<span class="op">=</span>ld.PostingSource</span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Legend Key    </span></span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> CTE_LegendKey <span class="kw">AS</span> leg <span class="kw">ON</span> ld.SiteRating <span class="op">=</span> leg.Site_Rating</span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Land Types</span></span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> land_types <span class="kw">AS</span> lt <span class="kw">ON</span> ld.LandType<span class="op">=</span>lt.land_type</span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Land Influence</span></span>
<span id="cb16-184"><a href="#cb16-184" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> LandInfluence <span class="kw">AS</span> li <span class="kw">ON</span> li.ObjectId <span class="op">=</span> ld.<span class="kw">Id</span></span>
<span id="cb16-185"><a href="#cb16-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> li.EffStatus<span class="op">=</span><span class="st">'A'</span> </span>
<span id="cb16-186"><a href="#cb16-186" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> li.PostingSource<span class="op">=</span><span class="st">'A'</span></span>
<span id="cb16-187"><a href="#cb16-187" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Land Influcnce Code Key for Description</span></span>
<span id="cb16-188"><a href="#cb16-188" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> CTE_LandInfluenceCodesKey <span class="kw">AS</span> lic <span class="kw">ON</span> lic.InfluenceCode<span class="op">=</span>li.InfluenceCode</span>
<span id="cb16-189"><a href="#cb16-189" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-190"><a href="#cb16-190" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> lh.EffStatus<span class="op">=</span> <span class="st">'A'</span> </span>
<span id="cb16-191"><a href="#cb16-191" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> lh.PostingSource<span class="op">=</span><span class="st">'A'</span></span>
<span id="cb16-192"><a href="#cb16-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-193"><a href="#cb16-193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span></span>
<span id="cb16-194"><a href="#cb16-194" aria-hidden="true" tabindex="-1"></a>  lh.RevObjId</span>
<span id="cb16-195"><a href="#cb16-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-196"><a href="#cb16-196" aria-hidden="true" tabindex="-1"></a><span class="co">--  ld.LDAcres</span></span>
<span id="cb16-197"><a href="#cb16-197" aria-hidden="true" tabindex="-1"></a>,  ld.LandType</span>
<span id="cb16-198"><a href="#cb16-198" aria-hidden="true" tabindex="-1"></a>,  lt.land_type_desc</span>
<span id="cb16-199"><a href="#cb16-199" aria-hidden="true" tabindex="-1"></a><span class="co">--  leg.Legend</span></span>
<span id="cb16-200"><a href="#cb16-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-201"><a href="#cb16-201" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-202"><a href="#cb16-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-203"><a href="#cb16-203" aria-hidden="true" tabindex="-1"></a>CTE_WorksheetMarketValues <span class="kw">AS</span>(</span>
<span id="cb16-204"><a href="#cb16-204" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb16-205"><a href="#cb16-205" aria-hidden="true" tabindex="-1"></a>    r.lrsn,</span>
<span id="cb16-206"><a href="#cb16-206" aria-hidden="true" tabindex="-1"></a>    r.<span class="kw">method</span> <span class="kw">AS</span> PriceMethod,</span>
<span id="cb16-207"><a href="#cb16-207" aria-hidden="true" tabindex="-1"></a>    r.land_mkt_val_inc <span class="kw">AS</span> Worksheet_Land,</span>
<span id="cb16-208"><a href="#cb16-208" aria-hidden="true" tabindex="-1"></a>    (r.income_value <span class="op">-</span> r.land_mkt_val_cost) <span class="kw">AS</span> Worksheet_Imp,</span>
<span id="cb16-209"><a href="#cb16-209" aria-hidden="true" tabindex="-1"></a>    r.income_value <span class="kw">AS</span> Worksheet_Total</span>
<span id="cb16-210"><a href="#cb16-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-211"><a href="#cb16-211" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> reconciliation <span class="kw">AS</span> r </span>
<span id="cb16-212"><a href="#cb16-212" aria-hidden="true" tabindex="-1"></a><span class="co">--ON parcel.lrsn = r.lrsn</span></span>
<span id="cb16-213"><a href="#cb16-213" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> r.status <span class="op">=</span> <span class="st">'W'</span></span>
<span id="cb16-214"><a href="#cb16-214" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> r.<span class="kw">method</span> <span class="op">=</span> <span class="st">'I'</span> </span>
<span id="cb16-215"><a href="#cb16-215" aria-hidden="true" tabindex="-1"></a><span class="co">--AND r.land_model = @LandModelId</span></span>
<span id="cb16-216"><a href="#cb16-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-217"><a href="#cb16-217" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb16-218"><a href="#cb16-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-219"><a href="#cb16-219" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb16-220"><a href="#cb16-220" aria-hidden="true" tabindex="-1"></a>    r.lrsn,</span>
<span id="cb16-221"><a href="#cb16-221" aria-hidden="true" tabindex="-1"></a>    r.<span class="kw">method</span> <span class="kw">AS</span> PriceMethod,</span>
<span id="cb16-222"><a href="#cb16-222" aria-hidden="true" tabindex="-1"></a>    r.land_mkt_val_cost <span class="kw">AS</span> Worksheet_Land,</span>
<span id="cb16-223"><a href="#cb16-223" aria-hidden="true" tabindex="-1"></a>    r.cost_value <span class="kw">AS</span> Worksheet_Imp,</span>
<span id="cb16-224"><a href="#cb16-224" aria-hidden="true" tabindex="-1"></a>    (r.cost_value <span class="op">+</span> r.land_mkt_val_cost) <span class="kw">AS</span> Worksheet_Total</span>
<span id="cb16-225"><a href="#cb16-225" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-226"><a href="#cb16-226" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> reconciliation <span class="kw">AS</span> r </span>
<span id="cb16-227"><a href="#cb16-227" aria-hidden="true" tabindex="-1"></a><span class="co">--ON parcel.lrsn = r.lrsn</span></span>
<span id="cb16-228"><a href="#cb16-228" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> r.status<span class="op">=</span><span class="st">'W'</span></span>
<span id="cb16-229"><a href="#cb16-229" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> r.<span class="kw">method</span> <span class="op">=</span> <span class="st">'C'</span> </span>
<span id="cb16-230"><a href="#cb16-230" aria-hidden="true" tabindex="-1"></a><span class="co">--AND r.land_model = @LandModelId</span></span>
<span id="cb16-231"><a href="#cb16-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-232"><a href="#cb16-232" aria-hidden="true" tabindex="-1"></a><span class="co">--ORDER BY GEO, PIN;</span></span>
<span id="cb16-233"><a href="#cb16-233" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-234"><a href="#cb16-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-235"><a href="#cb16-235" aria-hidden="true" tabindex="-1"></a>CTE_ParcelCounter <span class="kw">AS</span> (</span>
<span id="cb16-236"><a href="#cb16-236" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb16-237"><a href="#cb16-237" aria-hidden="true" tabindex="-1"></a>Owner</span>
<span id="cb16-238"><a href="#cb16-238" aria-hidden="true" tabindex="-1"></a>,<span class="fu">COUNT</span>(lrsn) <span class="kw">AS</span> CountParcels_PerOwner</span>
<span id="cb16-239"><a href="#cb16-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-240"><a href="#cb16-240" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> CTE_ParcelMaster</span>
<span id="cb16-241"><a href="#cb16-241" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> GEO <span class="op">=</span> <span class="st">'42'</span></span>
<span id="cb16-242"><a href="#cb16-242" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> Owner</span>
<span id="cb16-243"><a href="#cb16-243" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-244"><a href="#cb16-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-245"><a href="#cb16-245" aria-hidden="true" tabindex="-1"></a>CTE_LegalAcresCounter <span class="kw">AS</span> (</span>
<span id="cb16-246"><a href="#cb16-246" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb16-247"><a href="#cb16-247" aria-hidden="true" tabindex="-1"></a>Owner</span>
<span id="cb16-248"><a href="#cb16-248" aria-hidden="true" tabindex="-1"></a>,<span class="fu">COUNT</span>(LegalAcres) <span class="kw">AS</span> CountLegalAcres_PerOwner</span>
<span id="cb16-249"><a href="#cb16-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-250"><a href="#cb16-250" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> CTE_ParcelMaster</span>
<span id="cb16-251"><a href="#cb16-251" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> GEO <span class="op">=</span> <span class="st">'42'</span></span>
<span id="cb16-252"><a href="#cb16-252" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> Owner</span>
<span id="cb16-253"><a href="#cb16-253" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-254"><a href="#cb16-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-255"><a href="#cb16-255" aria-hidden="true" tabindex="-1"></a>  <span class="co">-------------------------------------</span></span>
<span id="cb16-256"><a href="#cb16-256" aria-hidden="true" tabindex="-1"></a><span class="co">--CTE_TransferSales</span></span>
<span id="cb16-257"><a href="#cb16-257" aria-hidden="true" tabindex="-1"></a><span class="co">-------------------------------------</span></span>
<span id="cb16-258"><a href="#cb16-258" aria-hidden="true" tabindex="-1"></a>CTE_TransferSales <span class="kw">AS</span> (</span>
<span id="cb16-259"><a href="#cb16-259" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb16-260"><a href="#cb16-260" aria-hidden="true" tabindex="-1"></a><span class="co">--  pmd.[GEO_Name],</span></span>
<span id="cb16-261"><a href="#cb16-261" aria-hidden="true" tabindex="-1"></a>  t.lrsn,</span>
<span id="cb16-262"><a href="#cb16-262" aria-hidden="true" tabindex="-1"></a>  t.status,</span>
<span id="cb16-263"><a href="#cb16-263" aria-hidden="true" tabindex="-1"></a><span class="co">--Transfer Table Sale Details</span></span>
<span id="cb16-264"><a href="#cb16-264" aria-hidden="true" tabindex="-1"></a>  t.AdjustedSalePrice <span class="kw">AS</span> SalePrice,</span>
<span id="cb16-265"><a href="#cb16-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">CAST</span>(t.pxfer_date <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> SaleDate,</span>
<span id="cb16-266"><a href="#cb16-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TRIM</span>(t.SaleDesc) <span class="kw">AS</span> SaleDescr,</span>
<span id="cb16-267"><a href="#cb16-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TRIM</span>(t.TfrType) <span class="kw">AS</span> TranxType,</span>
<span id="cb16-268"><a href="#cb16-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TRIM</span>(t.DocNum) <span class="kw">AS</span> DocNumber <span class="co">-- Multiples will have the same DocNum</span></span>
<span id="cb16-269"><a href="#cb16-269" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> transfer <span class="kw">AS</span> t <span class="co">-- ON t.lrsn for joins</span></span>
<span id="cb16-270"><a href="#cb16-270" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb16-271"><a href="#cb16-271" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> t.AdjustedSalePrice <span class="op">&lt;&gt;</span> <span class="st">'0'</span></span>
<span id="cb16-272"><a href="#cb16-272" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> t.pxfer_date <span class="kw">BETWEEN</span> @PrimaryTransferDateFROM <span class="kw">AND</span> @PrimaryTransferDateTO</span>
<span id="cb16-273"><a href="#cb16-273" aria-hidden="true" tabindex="-1"></a>  <span class="co">--AND t.pxfer_date BETWEEN '2023-01-01' AND '2023-12-31'</span></span>
<span id="cb16-274"><a href="#cb16-274" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-275"><a href="#cb16-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-276"><a href="#cb16-276" aria-hidden="true" tabindex="-1"></a>CTE_Cert <span class="kw">AS</span> (</span>
<span id="cb16-277"><a href="#cb16-277" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> </span>
<span id="cb16-278"><a href="#cb16-278" aria-hidden="true" tabindex="-1"></a>    lrsn,</span>
<span id="cb16-279"><a href="#cb16-279" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Certified Values</span></span>
<span id="cb16-280"><a href="#cb16-280" aria-hidden="true" tabindex="-1"></a>    v.land_market_val <span class="kw">AS</span> CertValue_Land_Current,</span>
<span id="cb16-281"><a href="#cb16-281" aria-hidden="true" tabindex="-1"></a>    v.imp_val <span class="kw">AS</span> CertValue_Imp_Current,</span>
<span id="cb16-282"><a href="#cb16-282" aria-hidden="true" tabindex="-1"></a>    (v.imp_val <span class="op">+</span> v.land_market_val) <span class="kw">AS</span> CertValue_Total_Current,</span>
<span id="cb16-283"><a href="#cb16-283" aria-hidden="true" tabindex="-1"></a>    v.eff_year <span class="kw">AS</span> Tax_Year_Cert,</span>
<span id="cb16-284"><a href="#cb16-284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> v.lrsn <span class="kw">ORDER</span> <span class="kw">BY</span> v.last_update <span class="kw">DESC</span>) <span class="kw">AS</span> RowNumber</span>
<span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> valuation <span class="kw">AS</span> v</span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> v.eff_year <span class="kw">BETWEEN</span> @CertValueDateFROM <span class="kw">AND</span> @CertValueDateTO</span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a><span class="co">--Change to desired year</span></span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> v.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a>CTE_Cert_Prev <span class="kw">AS</span> (</span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> </span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a>    lrsn,</span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Certified Values</span></span>
<span id="cb16-295"><a href="#cb16-295" aria-hidden="true" tabindex="-1"></a>    v.land_market_val <span class="kw">AS</span> CertValue_Land_Previous,</span>
<span id="cb16-296"><a href="#cb16-296" aria-hidden="true" tabindex="-1"></a>    v.imp_val <span class="kw">AS</span> CertValue_Imp_Previous,</span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a>    (v.imp_val <span class="op">+</span> v.land_market_val) <span class="kw">AS</span> CertValue_Total_Previous,</span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a>    v.eff_year <span class="kw">AS</span> Tax_Year_Cert,</span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> v.lrsn <span class="kw">ORDER</span> <span class="kw">BY</span> v.last_update <span class="kw">DESC</span>) <span class="kw">AS</span> RowNumber</span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> valuation <span class="kw">AS</span> v</span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a>  <span class="co">--WHERE v.eff_year BETWEEN @PrevCertValueDateFROM AND @PrevCertValueDateTO</span></span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> v.eff_year <span class="kw">BETWEEN</span> <span class="st">'20230101'</span> <span class="kw">AND</span> <span class="st">'20231231'</span></span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a><span class="co">--Change to desired year</span></span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> v.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a>CTE_Assessed <span class="kw">AS</span> (</span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> </span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a>    lrsn,</span>
<span id="cb16-310"><a href="#cb16-310" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Assessed Values</span></span>
<span id="cb16-311"><a href="#cb16-311" aria-hidden="true" tabindex="-1"></a>    v.land_assess <span class="kw">AS</span> AssessedValue_Land_wEx,</span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a>    v.imp_assess <span class="kw">AS</span> AssessedValue_Imp,</span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a>    (v.imp_assess <span class="op">+</span> v.land_assess) <span class="kw">AS</span> AssessedValue_Total,</span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a>    v.eff_year <span class="kw">AS</span> Tax_Year_Assessed,</span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> v.lrsn <span class="kw">ORDER</span> <span class="kw">BY</span> v.last_update <span class="kw">DESC</span>) <span class="kw">AS</span> RowNumber</span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> valuation <span class="kw">AS</span> v</span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> v.eff_year <span class="kw">BETWEEN</span> @CertValueDateFROM <span class="kw">AND</span> @CertValueDateTO</span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a><span class="co">--Change to desired year</span></span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> v.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a>CTE_Memos_RY <span class="kw">AS</span> (</span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a><span class="kw">Select</span></span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>m.lrsn</span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a>,m.memo_id</span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a>,m.memo_text <span class="kw">AS</span> RY_Memo</span>
<span id="cb16-327"><a href="#cb16-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-328"><a href="#cb16-328" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> memos <span class="kw">AS</span> m</span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> m.memo_id <span class="op">=</span> @MemoID</span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a><span class="co">--WHERE m.memo_id='RY24'</span></span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> m.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> m.memo_line_number <span class="op">&lt;&gt;</span> <span class="st">'1'</span></span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="op">*</span></span>
<span id="cb16-337"><a href="#cb16-337" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb16-338"><a href="#cb16-338" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> CTE_ParcelMaster <span class="kw">AS</span> pmd</span>
<span id="cb16-339"><a href="#cb16-339" aria-hidden="true" tabindex="-1"></a><span class="kw">Left</span> <span class="kw">Join</span> CTE_WorksheetMarketValues <span class="kw">AS</span> ws</span>
<span id="cb16-340"><a href="#cb16-340" aria-hidden="true" tabindex="-1"></a>  <span class="kw">On</span> ws.lrsn <span class="op">=</span> pmd.lrsn</span>
<span id="cb16-341"><a href="#cb16-341" aria-hidden="true" tabindex="-1"></a><span class="kw">Left</span> <span class="kw">Join</span> CTE_ParcelCounter <span class="kw">AS</span> pc</span>
<span id="cb16-342"><a href="#cb16-342" aria-hidden="true" tabindex="-1"></a>  <span class="kw">On</span> pmd.owner <span class="op">=</span> pc.owner</span>
<span id="cb16-343"><a href="#cb16-343" aria-hidden="true" tabindex="-1"></a>  <span class="co">--,COUNT(lrsn) AS CountParcels_PerOwner</span></span>
<span id="cb16-344"><a href="#cb16-344" aria-hidden="true" tabindex="-1"></a><span class="kw">Left</span> <span class="kw">Join</span> CTE_LegalAcresCounter <span class="kw">AS</span> lac</span>
<span id="cb16-345"><a href="#cb16-345" aria-hidden="true" tabindex="-1"></a>  <span class="kw">On</span> pmd.owner <span class="op">=</span> lac.owner</span>
<span id="cb16-346"><a href="#cb16-346" aria-hidden="true" tabindex="-1"></a>  <span class="co">--,COUNT(LegalAcres) AS CountLegalAcres_PerOwner</span></span>
<span id="cb16-347"><a href="#cb16-347" aria-hidden="true" tabindex="-1"></a><span class="kw">Left</span> <span class="kw">Join</span> CTE_Cert <span class="kw">AS</span> <span class="fu">cv</span></span>
<span id="cb16-348"><a href="#cb16-348" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> pmd.lrsn<span class="op">=</span><span class="fu">cv</span>.lrsn</span>
<span id="cb16-349"><a href="#cb16-349" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> <span class="fu">cv</span>.RowNumber <span class="op">=</span> <span class="st">'1'</span></span>
<span id="cb16-350"><a href="#cb16-350" aria-hidden="true" tabindex="-1"></a><span class="kw">Left</span> <span class="kw">Join</span> CTE_Cert_Prev <span class="kw">AS</span> cvp</span>
<span id="cb16-351"><a href="#cb16-351" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> pmd.lrsn<span class="op">=</span>cvp.lrsn</span>
<span id="cb16-352"><a href="#cb16-352" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> cvp.RowNumber <span class="op">=</span> <span class="st">'1'</span></span>
<span id="cb16-353"><a href="#cb16-353" aria-hidden="true" tabindex="-1"></a><span class="kw">Left</span> <span class="kw">Join</span> CTE_Memos_RY <span class="kw">AS</span> mry</span>
<span id="cb16-354"><a href="#cb16-354" aria-hidden="true" tabindex="-1"></a>  <span class="kw">On</span> pmd.lrsn <span class="op">=</span> mry.lrsn</span>
<span id="cb16-355"><a href="#cb16-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-356"><a href="#cb16-356" aria-hidden="true" tabindex="-1"></a><span class="kw">Where</span> pmd.GEO <span class="op">=</span> <span class="st">'42'</span></span>
<span id="cb16-357"><a href="#cb16-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-358"><a href="#cb16-358" aria-hidden="true" tabindex="-1"></a><span class="kw">Order</span> <span class="kw">By</span> pmd.Owner;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="case_single-vs-multiple" class="level3">
<h3 class="anchored" data-anchor-id="case_single-vs-multiple">CASE_Single vs Multiple</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a># <span class="cf">Case</span> <span class="dt">Single</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">CASE</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> field1 <span class="op">=</span> <span class="st">'value1'</span> <span class="cf">THEN</span> <span class="st">'Category1'</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">ELSE</span> <span class="st">'Other'</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="cf">END</span> <span class="kw">AS</span> [YourNewColumnName]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a># <span class="cf">Case</span> Multiple</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="cf">CASE</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> field1 <span class="op">=</span> <span class="st">'value1'</span> <span class="cf">THEN</span> <span class="st">'Category1'</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> field1 <span class="op">=</span> <span class="st">'value2'</span> <span class="cf">THEN</span> <span class="st">'Category2'</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">WHEN</span> field1 <span class="op">=</span> <span class="st">'value3'</span> <span class="cf">THEN</span> <span class="st">'Category3'</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">ELSE</span> <span class="st">'Other'</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="cf">END</span> <span class="kw">AS</span> [YourNewColumnName]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="insert-into-text" class="level3">
<h3 class="anchored" data-anchor-id="insert-into-text">Insert into text:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>SUBSTRING(<span class="kw">column</span>, <span class="dv">1</span>, <span class="dv">3</span>) <span class="op">+</span> <span class="st">'-'</span> <span class="op">+</span> SUBSTRING(<span class="kw">column</span>, <span class="dv">4</span>, <span class="dv">3</span>) <span class="kw">AS</span> TAG,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>Example: </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>TAGDescr,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>SUBSTRING(TAGDescr, <span class="dv">1</span>, <span class="dv">3</span>) <span class="op">+</span> <span class="st">'-'</span> <span class="op">+</span> SUBSTRING(TAGDescr, <span class="dv">4</span>, <span class="dv">3</span>) <span class="kw">AS</span> TAG,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>LevyRate</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> KCv_TAGLevyRate22a</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> TAGDescr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="cast-examples" class="level2">
<h2 class="anchored" data-anchor-id="cast-examples">CAST Examples</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">CAST</span>(expression <span class="kw">AS</span> data_type)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(<span class="dv">42</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">10</span>));</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">CONVERT</span>(data_type, expression [, style])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Data</span> <span class="kw">Type</span> Options:</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(ColumnName <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">10</span>)) <span class="kw">AS</span> NumericToString;</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(ColumnName <span class="kw">AS</span> <span class="dt">FLOAT</span>) <span class="kw">AS</span> StringToNumeric;</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(ColumnName <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> StringToDate;</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(GETDATE() <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">25</span>)) <span class="kw">AS</span> DateToString;</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(ColumnName <span class="kw">AS</span> <span class="dt">DECIMAL</span>(<span class="dv">10</span>, <span class="dv">2</span>)) <span class="kw">AS</span> IntegerToDecimal;</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(ColumnName <span class="kw">AS</span> <span class="dt">INT</span>) <span class="kw">AS</span> DecimalToInteger;</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> <span class="cf">WHEN</span> <span class="fu">CAST</span>(<span class="st">'True'</span> <span class="kw">AS</span> BIT) <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>         <span class="cf">ELSE</span> <span class="st">'No'</span> <span class="cf">END</span> <span class="kw">AS</span> StringToBoolean;</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> IIF(<span class="fu">CAST</span>(<span class="st">'False'</span> <span class="kw">AS</span> BIT) <span class="op">=</span> <span class="dv">1</span>, <span class="st">'Yes'</span>, <span class="st">'No'</span>) <span class="kw">AS</span> StringToBoolean;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="common-syntax-references" class="level2">
<h2 class="anchored" data-anchor-id="common-syntax-references">Common Syntax References</h2>
<p>ASC Sorts the result set in ascending order CAST Converts a value (of any type) into a specified datatype DESC Sorts the result set in descending order DISTINCT Selects only distinct (different) values BETWEEN Selects values within a given range CASE Creates different outputs based on conditions LIKE Searches for a specified pattern in a column LIMIT Specifies the number of records to return in the result set NOT Only includes rows where a condition is not true NOT NULL A constraint that enforces a column to not accept NULL values UNION Combines the result set of two or more SELECT statements (only distinct values) UNION ALL Combines the result set of two or more SELECT statements (allows duplicate values)</p>
<hr>
</section>
<section id="cast-explained" class="level2">
<h2 class="anchored" data-anchor-id="cast-explained">CAST Explained</h2>
<p>In SQL Server, the <code>CAST</code> function is used to explicitly convert one data type to another. The basic syntax for the <code>CAST</code> function is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CAST</span>(expression <span class="kw">AS</span> data_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here: - <code>expression</code>: The value or column that you want to convert to another data type. - <code>data_type</code>: The target data type to which you want to convert the expression.</p>
<p>For example, to convert a numeric value to a varchar data type, you can use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(<span class="dv">42</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">10</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will convert the numeric value 42 to a varchar data type, resulting in the string <code>'42'</code>.</p>
<p>Note that when using <code>CAST</code>, be careful about potential data loss or conversion errors, especially when converting between different data types that have different ranges or precision.</p>
<p>Additionally, SQL Server also provides the <code>CONVERT</code> function, which is similar to <code>CAST</code> but provides more formatting options for certain data types, like converting dates to specific formats. The syntax for <code>CONVERT</code> is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CONVERT</span>(data_type, expression [, style])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where <code>style</code> is an optional parameter used for formatting when converting dates. If you don’t need specific formatting, you can use <code>CAST</code> as it is more concise.</p>
<p>Let’s demonstrate various <code>CAST</code> data type options in SQL Server using some examples:</p>
<ol type="1">
<li>Numeric to String Conversion:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(<span class="dv">42</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">10</span>)) <span class="kw">AS</span> NumericToString;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output:</p>
<pre><code>NumericToString
--------------
42</code></pre>
<ol start="2" type="1">
<li>String to Numeric Conversion:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">CAST</span>(<span class="st">'3.14'</span> <span class="kw">AS</span> <span class="dt">FLOAT</span>) <span class="kw">AS</span> StringToNumeric;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output:</p>
<pre><code>StringToNumeric
---------------
3.14</code></pre>
<ol start="3" type="1">
<li>String to Date Conversion:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CAST</span>(<span class="st">'2023-08-03'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> StringToDate;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output:</p>
<pre><code>StringToDate
------------
2023-08-03</code></pre>
<ol start="4" type="1">
<li>Date to String Conversion:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CAST</span>(GETDATE() <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">25</span>)) <span class="kw">AS</span> DateToString;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output (will vary based on the current date):</p>
<pre><code>DateToString
-------------------------
2023-08-03 15:30:00.123</code></pre>
<ol start="5" type="1">
<li>Integer to Decimal Conversion:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CAST</span>(<span class="dv">123</span> <span class="kw">AS</span> <span class="dt">DECIMAL</span>(<span class="dv">10</span>, <span class="dv">2</span>)) <span class="kw">AS</span> IntegerToDecimal;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output:</p>
<pre><code>IntegerToDecimal
----------------
123.00</code></pre>
<ol start="6" type="1">
<li>Decimal to Integer Conversion (Note: Truncation will occur):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CAST</span>(<span class="fl">456.78</span> <span class="kw">AS</span> <span class="dt">INT</span>) <span class="kw">AS</span> DecimalToInteger;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output:</p>
<pre><code>DecimalToInteger
----------------
456</code></pre>
<ol start="7" type="1">
<li>String to Boolean Conversion (Using CASE expression):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">WHEN</span> <span class="fu">CAST</span>(<span class="st">'True'</span> <span class="kw">AS</span> BIT) <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">ELSE</span> <span class="st">'No'</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span> <span class="kw">AS</span> StringToBoolean;</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output:</p>
<pre><code>StringToBoolean
--------------
Yes</code></pre>
<ol start="8" type="1">
<li>String to Boolean Conversion (Using IIF function):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  IIF(<span class="fu">CAST</span>(<span class="st">'False'</span> <span class="kw">AS</span> BIT) <span class="op">=</span> <span class="dv">1</span>, <span class="st">'Yes'</span>, <span class="st">'No'</span>) <span class="kw">AS</span> StringToBoolean</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output:</p>
<pre><code>StringToBoolean
--------------
No</code></pre>
<p>Remember that the exact output and behavior will depend on the specific values and data types used in your database. Always be cautious when performing data type conversions, as unexpected results may occur if the data cannot be converted correctly.</p>
<hr>
</section>
<section id="gpt-4-explains-trim-vs-trim" class="level2">
<h2 class="anchored" data-anchor-id="gpt-4-explains-trim-vs-trim">GPT-4 Explains TRIM vs TRIM</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LTRIM</span>(<span class="fu">RTRIM</span>()) </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>#vs </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">TRIM</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The difference between <code>LTRIM(RTRIM(pm.pin)) AS [PIN]</code> and <code>TRIM(pm.pin) AS [PIN]</code> in SQL Server comes down to the versions of SQL Server you are using.</p>
<p>Before SQL Server 2017, the <code>TRIM</code> function did not exist. So, to remove both leading and trailing spaces, you had to use <code>LTRIM(RTRIM(pm.pin)) AS [PIN]</code>. This first applies the <code>RTRIM</code> function to remove trailing spaces and then the <code>LTRIM</code> function to remove leading spaces.</p>
<p>Starting from SQL Server 2017, Microsoft introduced the <code>TRIM</code> function, which removes both leading and trailing spaces from a string. So, in SQL Server 2017 and later versions, you can simply use <code>TRIM(pm.pin) AS [PIN]</code> to achieve the same result as <code>LTRIM(RTRIM(pm.pin)) AS [PIN]</code>.</p>
<p>In terms of functionality, there’s no practical difference between the two in SQL Server 2017 and later – they both remove leading and trailing spaces. However, <code>TRIM</code> is more concise and easier to read. So if you’re using a newer version of SQL Server, I’d recommend using <code>TRIM</code> for simplicity.</p>
<p>Do keep in mind that if your scripts need to be backward compatible with versions of SQL Server prior to 2017, you should stick with using <code>LTRIM(RTRIM())</code>.</p>
<hr>
</section>
<section id="table-queries---basics-of-the-code-you-need-to-grab-information-from-a-sql-database-most-materials-from-w3-schools" class="level2">
<h2 class="anchored" data-anchor-id="table-queries---basics-of-the-code-you-need-to-grab-information-from-a-sql-database-most-materials-from-w3-schools">TABLE QUERIES - BASICS OF THE CODE YOU NEED TO GRAB INFORMATION FROM A SQL DATABASE, MOST MATERIALS FROM W3 SCHOOLS</h2>
<p><a href="https://www.w3schools.com/sql/sql_quickref.asp" title="W3 Schools LINK">W3 Schools LINK</a></p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">--**-- SELECT TYPES</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">--SELECT</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">--SELECT *  </span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">--SELECT DISTINCT   </span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> column_name(s)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co">--SELECT INTO   </span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span> new_table_name [<span class="kw">IN</span> externaldatabase]</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> old_table_name</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="kw">or</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span> new_table_name [<span class="kw">IN</span> externaldatabase]</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> old_table_name</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="co">--SELECT TOP    </span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> TOP <span class="dt">number</span>|<span class="kw">percent</span> column_name(s)</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co">--**--JOIN TYPES</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co">--INNER JOIN    </span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name1</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> table_name2</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> table_name1.column_name<span class="op">=</span>table_name2.column_name</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a><span class="co">--LEFT JOIN </span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name1</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> table_name2</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> table_name1.column_name<span class="op">=</span>table_name2.column_name</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a><span class="co">--RIGHT JOIN    </span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name1</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="kw">RIGHT</span> <span class="kw">JOIN</span> table_name2</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> table_name1.column_name<span class="op">=</span>table_name2.column_name</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a><span class="co">--FULL JOIN </span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name1</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a><span class="kw">FULL</span> <span class="kw">JOIN</span> table_name2</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> table_name1.column_name<span class="op">=</span>table_name2.column_name</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="co">--**-- CONDITIONS</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a><span class="co">--WHERE</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name <span class="kw">operator</span> <span class="fu">value</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a><span class="co">--IN</span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a><span class="kw">IN</span> (value1,value2,<span class="op">..</span>)</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a><span class="co">--AS (alias)    </span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name <span class="kw">AS</span> column_alias</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a><span class="kw">or</span></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name  <span class="kw">AS</span> table_alias</span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a><span class="co">--AND / OR  </span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> condition</span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span>|<span class="kw">OR</span> condition</span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a><span class="co">--BETWEEN</span></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a><span class="kw">BETWEEN</span> value1 <span class="kw">AND</span> value2</span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a><span class="co">--LIKE</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name <span class="kw">LIKE</span> pattern</span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a><span class="co">--**-- ORDERING RESULTS OF QUERY (FOR SELECT, DIFFERENT THAN GROUP BY)</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a><span class="co">--ORDER BY  </span></span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name(s)</span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> column_name [<span class="kw">ASC</span>|<span class="kw">DESC</span>]</span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a><span class="co">--**-- AGGREGATES </span></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a><span class="co">--GROUP BY  </span></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name, aggregate_function(column_name)</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name <span class="kw">operator</span> <span class="fu">value</span></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> column_name</span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a><span class="co">--HAVING</span></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> column_name, aggregate_function(column_name)</span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> column_name <span class="kw">operator</span> <span class="fu">value</span></span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> column_name</span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> aggregate_function(column_name) <span class="kw">operator</span> <span class="fu">value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sub-queries" class="level2">
<h2 class="anchored" data-anchor-id="sub-queries">SUB QUERIES</h2>
<section id="exists" class="level3">
<h3 class="anchored" data-anchor-id="exists">EXISTS</h3>
<p>The SQL EXISTS Operator is used to test for the existence of any record in a subquery. The EXISTS operator returns TRUE if the subquery returns one or more records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">IF</span> <span class="kw">EXISTS</span> (<span class="kw">SELECT</span> \<span class="op">*</span> <span class="kw">FROM</span> table_name <span class="kw">WHERE</span> <span class="kw">id</span> <span class="op">=</span> ?) <span class="cf">BEGIN</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>IF EXISTS (SELECT * FROM table_name WHERE id = ?) BEGIN –do what needs to be done if exists END ELSE BEGIN –do what needs to be done if not END</p>
<p>CTE ((WITH common_table_expression)) (Transact-SQL) <a href="https://learn.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-ver16" class="uri">https://learn.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-ver16</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>WITH CTE_NameYouAssign AS ( SELECT column1 column2 column3 ROW_NUMBER() OVER (PARTITION BY column3 ORDER BY column1 DESC) AS RowNum FROM TableNameYouAreReferencing AS aliashere WHERE columnwhatever = ‘some condition’ )</p>
<p>SELECT DISTINCT a.column1 a.column2 a.column3 a.column4 a.column5 b.column – from CTE above, uses table join alias below, this is the part that confused me.</p>
<p>FROM primarytable AS a LEFT OUTER JOIN CTE_NameYouAssign AS b ON a.columnkey=b.columnkey WHERE a.column1 = ‘some condition’ AND a.column2 = ‘some condition’ ORDER BY columnwhatever;</p>
<p>–**– COMBINING QUERIES</p>
<p>–**– APPEND TWO MATCHING TABLES (LIKE APPEND IN POWER QUERY)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–UNION SELECT column_name(s) FROM table_name1 UNION SELECT column_name(s) FROM table_name2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–UNION ALL SELECT column_name(s) FROM table_name1 UNION ALL SELECT column_name(s) FROM table_name2</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;">QUERY-ONLY ABOVE THIS LINE DATABASE ALTERING CODE BELOW THIS LINE, USE CAUTION, RUN IN TEST BEFORE COMMITTING CHANGES</td>
</tr>
<tr class="even">
<td style="text-align: left;">FOR PRACTICE OR PERSONAL USE SEE: SQL Server 2022 Express is a free edition of SQL Server, ideal for development and production for desktop, web, and small server applications. <a href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads?rtc=1" class="uri">https://www.microsoft.com/en-us/sql-server/sql-server-downloads?rtc=1</a></td>
</tr>
</tbody>
</table>
<p>–** DATABASE &amp; TABLE MAINTENCE –**–DATABASE MAINTENCE –CREATE DATABASE<br>
CREATE DATABASE database_name</p>
<p>–DROP DATABASE DROP DATABASE database_name</p>
<p>–**–TABLE MAINTENCE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–CREATE TABLE<br>
CREATE TABLE table_name ( column_name1 data_type, column_name2 data_type, column_name3 data_type, … )</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–CREATE INDEX</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>CREATE INDEX index_name</code></pre>
<p>ON table_name (column_name) or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>CREATE UNIQUE INDEX index_name ON table_name (column_name)</p>
<p>–INSERT INTO</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>INSERT INTO table_name</code></pre>
<p>VALUES (value1, value2, value3,….) or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>INSERT INTO table_name (column1, column2, column3,…) VALUES (value1, value2, value3,….)</p>
<p>–CREATE VIEW</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>CREATE VIEW view_name AS</code></pre>
<p>SELECT column_name(s) FROM table_name WHERE condition</p>
<p>–DELETE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>DELETE FROM table_name</code></pre>
<p>WHERE some_column=some_value or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>DELETE FROM table_name (Note: Deletes the entire table!!)</p>
<p>–DROP INDEX</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>DROP INDEX table_name.index_name (SQL Server)</code></pre>
<p>DROP INDEX index_name ON table_name (MS Access) DROP INDEX index_name (DB2/Oracle) ALTER TABLE table_name DROP INDEX index_name (MySQL)</p>
<p>–DROP TABLE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>DROP TABLE table_name</p>
<p>–ALTER TABLE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ALTER TABLE table_name ADD column_name datatype or</p>
<p>–ALTER TABLE table_name</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>DROP COLUMN column_name</p>
<p>–TRUNCATE TABLE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>TRUNCATE TABLE table_name</p>
<p>–UPDATE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>UPDATE table_name</code></pre>
<p>SET column1=value, column2=value,… WHERE some_column=some_value</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">SQL Keywords Reference <a href="https://www.w3schools.com/sql/sql_ref_keywords.asp" class="uri">https://www.w3schools.com/sql/sql_ref_keywords.asp</a></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Keyword Description ADD Adds a column in an existing table ADD CONSTRAINT Adds a constraint after a table is already created ALL Returns true if all of the subquery values meet the condition ALTER Adds, deletes, or modifies columns in a table, or changes the data type of a column in a table ALTER COLUMN Changes the data type of a column in a table ALTER TABLE Adds, deletes, or modifies columns in a table AND Only includes rows where both conditions is true ANY Returns true if any of the subquery values meet the condition AS Renames a column or table with an alias ASC Sorts the result set in ascending order BACKUP DATABASE Creates a back up of an existing database BETWEEN Selects values within a given range CASE Creates different outputs based on conditions CHECK A constraint that limits the value that can be placed in a column COLUMN Changes the data type of a column or deletes a column in a table CONSTRAINT Adds or deletes a constraint CREATE Creates a database, index, view, table, or procedure CREATE DATABASE Creates a new SQL database CREATE INDEX Creates an index on a table (allows duplicate values) CREATE OR REPLACE VIEW Updates a view CREATE TABLE Creates a new table in the database CREATE PROCEDURE Creates a stored procedure CREATE UNIQUE INDEX Creates a unique index on a table (no duplicate values) CREATE VIEW Creates a view based on the result set of a SELECT statement DATABASE Creates or deletes an SQL database DEFAULT A constraint that provides a default value for a column DELETE Deletes rows from a table DESC Sorts the result set in descending order DISTINCT Selects only distinct (different) values DROP Deletes a column, constraint, database, index, table, or view DROP COLUMN Deletes a column in a table DROP CONSTRAINT Deletes a UNIQUE, PRIMARY KEY, FOREIGN KEY, or CHECK constraint DROP DATABASE Deletes an existing SQL database DROP DEFAULT Deletes a DEFAULT constraint DROP INDEX Deletes an index in a table DROP TABLE Deletes an existing table in the database DROP VIEW Deletes a view EXEC Executes a stored procedure EXISTS Tests for the existence of any record in a subquery FOREIGN KEY A constraint that is a key used to link two tables together FROM Specifies which table to select or delete data from FULL OUTER JOIN Returns all rows when there is a match in either left table or right table GROUP BY Groups the result set (used with aggregate functions: COUNT, MAX, MIN, SUM, AVG) HAVING Used instead of WHERE with aggregate functions IN Allows you to specify multiple values in a WHERE clause INDEX Creates or deletes an index in a table INNER JOIN Returns rows that have matching values in both tables INSERT INTO Inserts new rows in a table INSERT INTO SELECT Copies data from one table into another table IS NULL Tests for empty values IS NOT NULL Tests for non-empty values JOIN Joins tables LEFT JOIN Returns all rows from the left table, and the matching rows from the right table LIKE Searches for a specified pattern in a column LIMIT Specifies the number of records to return in the result set NOT Only includes rows where a condition is not true NOT NULL A constraint that enforces a column to not accept NULL values OR Includes rows where either condition is true ORDER BY Sorts the result set in ascending or descending order OUTER JOIN Returns all rows when there is a match in either left table or right table PRIMARY KEY A constraint that uniquely identifies each record in a database table PROCEDURE A stored procedure RIGHT JOIN Returns all rows from the right table, and the matching rows from the left table ROWNUM Specifies the number of records to return in the result set SELECT Selects data from a database SELECT DISTINCT Selects only distinct (different) values SELECT INTO Copies data from one table into a new table SELECT TOP Specifies the number of records to return in the result set SET Specifies which columns and values that should be updated in a table TABLE Creates a table, or adds, deletes, or modifies columns in a table, or deletes a table or data inside a table TOP Specifies the number of records to return in the result set TRUNCATE TABLE Deletes the data inside a table, but not the table itself UNION Combines the result set of two or more SELECT statements (only distinct values) UNION ALL Combines the result set of two or more SELECT statements (allows duplicate values) UNIQUE A constraint that ensures that all values in a column are unique UPDATE Updates existing rows in a table VALUES Specifies the values of an INSERT INTO statement VIEW Creates, updates, or deletes a view WHERE Filters a result set to include only records that fulfill a specified condition</td>
</tr>
</tbody>
</table>
<p>ADDITIONAL RESOURCES - SQL Server Functions <a href="https://www.w3schools.com/sql/sql_ref_sqlserver.asp" class="uri">https://www.w3schools.com/sql/sql_ref_sqlserver.asp</a> ——————————————————————————————————————————————————– –SQL Server String Functions Function Description ASCII Returns the ASCII value for the specific character CHAR Returns the character based on the ASCII code CHARINDEX Returns the position of a substring in a string CONCAT Adds two or more strings together Concat with + Adds two or more strings together CONCAT_WS Adds two or more strings together with a separator DATALENGTH Returns the number of bytes used to represent an expression DIFFERENCE Compares two SOUNDEX values, and returns an integer value FORMAT Formats a value with the specified format LEFT Extracts a number of characters from a string (starting from left) LEN Returns the length of a string LOWER Converts a string to lower-case LTRIM Removes leading spaces from a string NCHAR Returns the Unicode character based on the number code PATINDEX Returns the position of a pattern in a string QUOTENAME Returns a Unicode string with delimiters added to make the string a valid SQL Server delimited identifier REPLACE Replaces all occurrences of a substring within a string, with a new substring REPLICATE Repeats a string a specified number of times REVERSE Reverses a string and returns the result RIGHT Extracts a number of characters from a string (starting from right) RTRIM Removes trailing spaces from a string SOUNDEX Returns a four-character code to evaluate the similarity of two strings SPACE Returns a string of the specified number of space characters STR Returns a number as string STUFF Deletes a part of a string and then inserts another part into the string, starting at a specified position SUBSTRING Extracts some characters from a string TRANSLATE Returns the string from the first argument after the characters specified in the second argument are translated into the characters specified in the third argument. TRIM Removes leading and trailing spaces (or other specified characters) from a string UNICODE Returns the Unicode value for the first character of the input expression UPPER Converts a string to upper-case</p>
<p>–SQL Server Math/Numeric Functions Function Description ABS Returns the absolute value of a number ACOS Returns the arc cosine of a number ASIN Returns the arc sine of a number ATAN Returns the arc tangent of a number ATN2 Returns the arc tangent of two numbers AVG Returns the average value of an expression CEILING Returns the smallest integer value that is &gt;= a number COUNT Returns the number of records returned by a select query COS Returns the cosine of a number COT Returns the cotangent of a number DEGREES Converts a value in radians to degrees EXP Returns e raised to the power of a specified number FLOOR Returns the largest integer value that is &lt;= to a number LOG Returns the natural logarithm of a number, or the logarithm of a number to a specified base LOG10 Returns the natural logarithm of a number to base 10 MAX Returns the maximum value in a set of values MIN Returns the minimum value in a set of values PI Returns the value of PI POWER Returns the value of a number raised to the power of another number RADIANS Converts a degree value into radians RAND Returns a random number ROUND Rounds a number to a specified number of decimal places SIGN Returns the sign of a number SIN Returns the sine of a number SQRT Returns the square root of a number SQUARE Returns the square of a number SUM Calculates the sum of a set of values TAN Returns the tangent of a number</p>
<p>–SQL Server Date Functions Function Description CURRENT_TIMESTAMP Returns the current date and time DATEADD Adds a time/date interval to a date and then returns the date DATEDIFF Returns the difference between two dates DATEFROMPARTS Returns a date from the specified parts (year, month, and day values) DATENAME Returns a specified part of a date (as string) DATEPART Returns a specified part of a date (as integer) DAY Returns the day of the month for a specified date GETDATE Returns the current database system date and time GETUTCDATE Returns the current database system UTC date and time ISDATE Checks an expression and returns 1 if it is a valid date, otherwise 0 MONTH Returns the month part for a specified date (a number from 1 to 12) SYSDATETIME Returns the date and time of the SQL Server YEAR Returns the year part for a specified date</p>
<p>–SQL Server Advanced Functions Function Description CAST Converts a value (of any type) into a specified datatype COALESCE Returns the first non-null value in a list CONVERT Converts a value (of any type) into a specified datatype CURRENT_USER Returns the name of the current user in the SQL Server database IIF Returns a value if a condition is TRUE, or another value if a condition is FALSE ISNULL Return a specified value if the expression is NULL, otherwise return the expression ISNUMERIC Tests whether an expression is numeric NULLIF Returns NULL if two expressions are equal SESSION_USER Returns the name of the current user in the SQL Server database SESSIONPROPERTY Returns the session settings for a specified option SYSTEM_USER Returns the login name for the current user USER_NAME Returns the database user name based on the specified id</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">ADDITIONAL RESOURCES - MySQL Functions <a href="https://www.w3schools.com/sql/sql_ref_mysql.asp" class="uri">https://www.w3schools.com/sql/sql_ref_mysql.asp</a></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">–MySQL String Functions Function Description ASCII Returns the ASCII value for the specific character CHAR_LENGTH Returns the length of a string (in characters) CHARACTER_LENGTH Returns the length of a string (in characters) CONCAT Adds two or more expressions together CONCAT_WS Adds two or more expressions together with a separator FIELD Returns the index position of a value in a list of values FIND_IN_SET Returns the position of a string within a list of strings FORMAT Formats a number to a format like “#,###,###.##”, rounded to a specified number of decimal places INSERT Inserts a string within a string at the specified position and for a certain number of characters INSTR Returns the position of the first occurrence of a string in another string LCASE Converts a string to lower-case LEFT Extracts a number of characters from a string (starting from left) LENGTH Returns the length of a string (in bytes) LOCATE Returns the position of the first occurrence of a substring in a string LOWER Converts a string to lower-case LPAD Left-pads a string with another string, to a certain length LTRIM Removes leading spaces from a string MID Extracts a substring from a string (starting at any position) POSITION Returns the position of the first occurrence of a substring in a string REPEAT Repeats a string as many times as specified REPLACE Replaces all occurrences of a substring within a string, with a new substring REVERSE Reverses a string and returns the result RIGHT Extracts a number of characters from a string (starting from right) RPAD Right-pads a string with another string, to a certain length RTRIM Removes trailing spaces from a string SPACE Returns a string of the specified number of space characters STRCMP Compares two strings SUBSTR Extracts a substring from a string (starting at any position) SUBSTRING Extracts a substring from a string (starting at any position) SUBSTRING_INDEX Returns a substring of a string before a specified number of delimiter occurs TRIM Removes leading and trailing spaces from a string UCASE Converts a string to upper-case UPPER Converts a string to upper-case</td>
</tr>
<tr class="even">
<td style="text-align: left;">–MySQL Numeric Functions Function Description ABS Returns the absolute value of a number ACOS Returns the arc cosine of a number ASIN Returns the arc sine of a number ATAN Returns the arc tangent of one or two numbers ATAN2 Returns the arc tangent of two numbers AVG Returns the average value of an expression CEIL Returns the smallest integer value that is &gt;= to a number CEILING Returns the smallest integer value that is &gt;= to a number COS Returns the cosine of a number COT Returns the cotangent of a number COUNT Returns the number of records returned by a select query DEGREES Converts a value in radians to degrees DIV Used for integer division EXP Returns e raised to the power of a specified number FLOOR Returns the largest integer value that is &lt;= to a number GREATEST Returns the greatest value of the list of arguments LEAST Returns the smallest value of the list of arguments LN Returns the natural logarithm of a number LOG Returns the natural logarithm of a number, or the logarithm of a number to a specified base LOG10 Returns the natural logarithm of a number to base 10 LOG2 Returns the natural logarithm of a number to base 2 MAX Returns the maximum value in a set of values MIN Returns the minimum value in a set of values MOD Returns the remainder of a number divided by another number PI Returns the value of PI POW Returns the value of a number raised to the power of another number POWER Returns the value of a number raised to the power of another number RADIANS Converts a degree value into radians RAND Returns a random number ROUND Rounds a number to a specified number of decimal places SIGN Returns the sign of a number SIN Returns the sine of a number SQRT Returns the square root of a number SUM Calculates the sum of a set of values TAN Returns the tangent of a number TRUNCATE Truncates a number to the specified number of decimal places</td>
</tr>
<tr class="odd">
<td style="text-align: left;">–MySQL Date Functions Function Description ADDDATE Adds a time/date interval to a date and then returns the date ADDTIME Adds a time interval to a time/datetime and then returns the time/datetime CURDATE Returns the current date CURRENT_DATE Returns the current date CURRENT_TIME Returns the current time CURRENT_TIMESTAMP Returns the current date and time CURTIME Returns the current time DATE Extracts the date part from a datetime expression DATEDIFF Returns the number of days between two date values DATE_ADD Adds a time/date interval to a date and then returns the date DATE_FORMAT Formats a date DATE_SUB Subtracts a time/date interval from a date and then returns the date DAY Returns the day of the month for a given date DAYNAME Returns the weekday name for a given date DAYOFMONTH Returns the day of the month for a given date DAYOFWEEK Returns the weekday index for a given date DAYOFYEAR Returns the day of the year for a given date EXTRACT Extracts a part from a given date FROM_DAYS Returns a date from a numeric datevalue HOUR Returns the hour part for a given date LAST_DAY Extracts the last day of the month for a given date LOCALTIME Returns the current date and time LOCALTIMESTAMP Returns the current date and time MAKEDATE Creates and returns a date based on a year and a number of days value MAKETIME Creates and returns a time based on an hour, minute, and second value MICROSECOND Returns the microsecond part of a time/datetime MINUTE Returns the minute part of a time/datetime MONTH Returns the month part for a given date MONTHNAME Returns the name of the month for a given date NOW Returns the current date and time PERIOD_ADD Adds a specified number of months to a period PERIOD_DIFF Returns the difference between two periods QUARTER Returns the quarter of the year for a given date value SECOND Returns the seconds part of a time/datetime SEC_TO_TIME Returns a time value based on the specified seconds STR_TO_DATE Returns a date based on a string and a format SUBDATE Subtracts a time/date interval from a date and then returns the date SUBTIME Subtracts a time interval from a datetime and then returns the time/datetime SYSDATE Returns the current date and time TIME Extracts the time part from a given time/datetime TIME_FORMAT Formats a time by a specified format TIME_TO_SEC Converts a time value into seconds TIMEDIFF Returns the difference between two time/datetime expressions TIMESTAMP Returns a datetime value based on a date or datetime value TO_DAYS Returns the number of days between a date and date “0000-00-00” WEEK Returns the week number for a given date WEEKDAY Returns the weekday number for a given date WEEKOFYEAR Returns the week number for a given date YEAR Returns the year part for a given date YEARWEEK Returns the year and week number for a given date</td>
</tr>
<tr class="even">
<td style="text-align: left;">–MySQL Advanced Functions Function Description BIN Returns a binary representation of a number BINARY Converts a value to a binary string CASE Goes through conditions and return a value when the first condition is met CAST Converts a value (of any type) into a specified datatype COALESCE Returns the first non-null value in a list CONNECTION_ID Returns the unique connection ID for the current connection CONV Converts a number from one numeric base system to another CONVERT Converts a value into the specified datatype or character set CURRENT_USER Returns the user name and host name for the MySQL account that the server used to authenticate the current client DATABASE Returns the name of the current database IF Returns a value if a condition is TRUE, or another value if a condition is FALSE IFNULL Return a specified value if the expression is NULL, otherwise return the expression ISNULL Returns 1 or 0 depending on whether an expression is NULL LAST_INSERT_ID Returns the AUTO_INCREMENT id of the last row that has been inserted or updated in a table NULLIF Compares two expressions and returns NULL if they are equal. Otherwise, the first expression is returned SESSION_USER Returns the current MySQL user name and host name SYSTEM_USER Returns the current MySQL user name and host name USER Returns the current MySQL user name and host name VERSION Returns the current version of the MySQL database</td>
</tr>
</tbody>
</table>
<p>ADDITIONAL RESOURCES - CTE EXPLAINED</p>
<p>–Basic structure, layman’s terms. A Common Table Expression (CTE) can be used many ways, but for the most basic use, think of it as a sub-query, or temp-query that you can reference within your primary query.</p>
<p>In Microsoft Power Query (Excel/PowerBI), this would be akin to pulling in a table as “connection only”, doing some transformations within that connection only table, and then referencing or merging that connection only table into your final results. But unlike PowerQuery tables, you can do all the transformations in a few lines of code, without pulling in millions of rows of data before transformations.</p>
<p>//Start Example CTE –CTE PRECEDING MAIN QUERY, This is you sub-query, or “connection only” query, which you will reference in your final query(s). –CTE can be used to get a RowNum as below, MAX, AVERAGE, SUM, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>WITH CTE_TableNameYouAssign AS ( SELECT column1 column2 column3 ROW_NUMBER() OVER (PARTITION BY column3 ORDER BY column1 DESC) AS RowNum</p>
<p>FROM TableNameYouAreReferencing AS aliashere WHERE columnwhatever = ‘some condition’ )</p>
<p>–MAIN QUERY STARTS HERE, Now you will build the original query you wanted, and pull in the results of the CTE (often just the one column you needed). –Select Statements</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>SELECT DISTINCT a.column1 a.column2 a.column3 a.column4 a.column5 b.column – from CTE above, uses table join alias below, this is the part that confused me.</p>
<p>–From, Join Where(s), Order By</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>FROM primarytable AS a LEFT OUTER JOIN CTE_TableNameYouAssign AS b ON a.columnkey=b.columnkey WHERE a.column1 = ‘some condition’ AND a.column2 = ‘some condition’ ORDER BY columnwhatever;</p>
<p>//End Example CTE</p>
<p>–**–An example I’ve actually used with a CTE, Treasurer_Warrants //Begin example</p>
<p>–CTE PRECEDING MAIN QUERY</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>WITH CTE_DescrHeader AS ( SELECT dh.Id, dh.BegEffDate, dh.TranId, dh.RevObjId, dh.DescrHeaderType, dh.DisplayDescr, ROW_NUMBER() OVER (PARTITION BY dh.RevObjId ORDER BY dh.BegEffDate DESC) AS RowNum FROM DescrHeader AS dh WHERE dh.EffStatus = ‘A’ )</p>
<p>–MAIN QUERY STARTS HERE</p>
<p>–Select Statements</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>SELECT DISTINCT –Demographics LTRIM(RTRIM(kcv.ain)) AS [AIN], LTRIM(RTRIM(kcv.pin)) AS [PIN], LTRIM(RTRIM(pb.OwnerName1)) AS [Owner], LTRIM(RTRIM(pb.OwnerName2)) AS [AltOwner], LTRIM(RTRIM(kcv.AttentionLine)) AS [Comm_Attn], LTRIM(RTRIM(kcv.MailingAddress)) AS [MailingAddress], LTRIM(RTRIM(kcv.MailingCityStZip)) AS [Mailing_CSZ], LTRIM(RTRIM(pb.OwnerCountry)) AS [OwnerCountry], LTRIM(RTRIM(kcv.SitusAddress)) AS [SitusAddress], LTRIM(RTRIM(kcv.DisplayDescr)) AS [LegalDescription], dd.DisplayDescr AS [ParcelBase_LegalDesc], –Amounts (incomplete, still searching for these figures) del.TaxAmount AS [TaxDue], del.PenAmount AS [Penalty], del.IntAmount AS [Interest], del.FeeAmount AS [Fees], –Year, Vin, Make, if applicable i.year_built AS [YearBuilt], LTRIM(RTRIM(mh.mh_serial_num)) AS [VIN], LTRIM(RTRIM(ct.tbl_element_desc)) AS [Make]</p>
<p>–From tables/joined tables</p>
<p>FROM KCv_PARCELMASTER1 AS kcv LEFT OUTER JOIN parcel_base_data AS pb ON kcv.lrsn=pb.lrsn LEFT OUTER JOIN CTE_DescrHeader AS dd ON pb.lrsn=dd.RevObjId LEFT OUTER JOIN manuf_housing AS mh ON kcv.lrsn=mh.lrsn LEFT OUTER JOIN codes_table AS ct ON mh.mh_make=ct.tbl_element AND ct.tbl_type_code=‘mhmake’ LEFT OUTER JOIN improvements AS i ON mh.lrsn=i.lrsn AND mh.extension=i.extension LEFT OUTER JOIN eGovDelq_T AS del ON kcv.lrsn=del.RevObjId</p>
<p>–Where conditions WHERE kcv.EffStatus=‘A’ AND pb.status=‘A’ AND mh.status=‘A’ AND i.status=‘A’ AND dd.RowNum = 1 AND i.improvement_id=‘M’ AND kcv.pin NOT LIKE ‘GENERAL PARCEL’ AND kcv.pin LIKE ‘M%’ OR kcv.pin LIKE ‘L%’ OR kcv.pin LIKE ‘G%’ OR kcv.pin LIKE ‘E%’ OR (kcv.pin LIKE ‘R%’ AND kcv.DisplayDescr LIKE ‘%Golden Spike%’) OR (kcv.pin LIKE ‘U%’ AND kcv.ClassCD=‘010 Operating Property’) OR (kcv.pin LIKE ‘%’ AND kcv.DisplayDescr LIKE ‘%PP On Real%’)</p>
<p>ORDER BY [PIN]; //End example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–**–Microsoft SQL Server 2022: WITH common_table_expression (Transact-SQL) <a href="https://learn.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-ver16" class="uri">https://learn.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-ver16</a> Specifies a temporary named result set, known as a common table expression (CTE). This is derived from a simple query and defined within the execution scope of a single SELECT, INSERT, UPDATE, DELETE or MERGE statement. This clause can also be used in a CREATE VIEW statement as part of its defining SELECT statement. A common table expression can include references to itself. This is referred to as a recursive common table expression.</p>
<p>The following guidelines apply to nonrecursive common table expressions. For guidelines that apply to recursive common table expressions, see Guidelines for Defining and Using Recursive Common Table Expressions that follows.</p>
<p>A CTE must be followed by a single SELECT, INSERT, UPDATE, or DELETE statement that references some or all the CTE columns. A CTE can also be specified in a CREATE VIEW statement as part of the defining SELECT statement of the view. Multiple CTE query definitions can be defined in a nonrecursive CTE. The definitions must be combined by one of these set operators: UNION ALL, UNION, INTERSECT, or EXCEPT. A CTE can reference itself and previously defined CTEs in the same WITH clause. Forward referencing isn’t allowed. Specifying more than one WITH clause in a CTE isn’t allowed. For example, if a CTE_query_definition contains a subquery, that subquery can’t contain a nested WITH clause that defines another CTE.</p>
<p>The following clauses can’t be used in the CTE_query_definition:</p>
<p>ORDER BY (except when a TOP clause is specified) INTO OPTION clause with query hints FOR BROWSE</p>
<p>When a CTE is used in a statement that is part of a batch, the statement before it must be followed by a semicolon. A query referencing a CTE can be used to define a cursor. Tables on remote servers can be referenced in the CTE. When executing a CTE, any hints that reference a CTE may conflict with other hints that are discovered when the CTE accesses its underlying tables, in the same manner as hints that reference views in queries. When this occurs, the query returns an error.</p>
<p>–**– SQLSHACK SQL Server Common Table Expressions (CTE) <a href="https://www.sqlshack.com/sql-server-common-table-expressions-cte/" class="uri">https://www.sqlshack.com/sql-server-common-table-expressions-cte/</a> A Common Table Expression, also called as CTE in short form, is a temporary named result set that you can reference within a SELECT, INSERT, UPDATE, or DELETE statement. The CTE can also be used in a View.</p>
<p>EXPLANATION: The CTE query starts with a ?With? and is followed by the Expression Name. We will be using this expression name in our select query to display the result of our CTE Query and be writing our CTE query definition. To view the CTE result we use a Select query with the CTE expression name.</p>
<p>-EXAMPLE: WITH expression_name [ ( column_name [,…n] ) ] AS ( CTE_query_definition ) Select [Column1,Column2,Column3 ?..] from expression_name</p>
<p>–Or</p>
<p>WITH expression_name [ ( column_name [,…n] ) ] AS ( CTE_query_definition ) Select * from expression_name</p>
<p>–CTE with Union All In order to display the result from start date to end date one by one as recursive, we use a Union All to increment RowNo, to add the day one by one till the condition satisfied the date range, in order to stop the recursion we need set some condition. In this example, we repeat the recursion to display our records until the date is less than or equal to the end date.</p>
<p>-EXAMPLE declare <span class="citation" data-cites="startDate">@startDate</span> datetime,<br>
<span class="citation" data-cites="endDate">@endDate</span> datetime;</p>
<p>select <span class="citation" data-cites="startDate">@startDate</span> = getdate(),<br>
<span class="citation" data-cites="endDate">@endDate</span> = getdate()+16;<br>
– select <span class="citation" data-cites="sDate">@sDate</span> StartDate,<span class="citation" data-cites="eDate">@eDate</span> EndDate<br>
;with myCTE as<br>
(<br>
select 1 as ROWNO,<span class="citation" data-cites="startDate">@startDate</span> StartDate,‘W -’+convert(varchar(2),<br>
DATEPART( wk, <span class="citation" data-cites="startDate">@startDate</span>))+’ / D (‘+convert(varchar(2),<span class="citation" data-cites="startDate">@startDate</span>,106)+’)’ as ‘WeekNumber’<br>
union all<br>
select ROWNO+1 ,dateadd(DAY, 1, StartDate) ,<br>
‘W -’+convert(varchar(2),DATEPART( wk, StartDate))+’ / D (‘+convert(varchar(2),<br>
dateadd(DAY, 1, StartDate),106)+’)’ as ‘WeekNumber’<br>
FROM myCTE<br>
WHERE dateadd(DAY, 1, StartDate)&lt;= <span class="citation" data-cites="endDate">@endDate</span><br>
)<br>
select ROWNO,Convert(varchar(10),StartDate,105) as StartDate ,WeekNumber from myCTE</p>
<p>–ANOTHER EXAMPLE FROM SQL SERVER TUTORIAL <a href="https://www.sqlservertutorial.net/sql-server-basics/sql-server-cte/" class="uri">https://www.sqlservertutorial.net/sql-server-basics/sql-server-cte/</a></p>
<p>WITH cte_sales AS ( SELECT staff_id, COUNT(*) order_count<br>
FROM sales.orders WHERE YEAR(order_date) = 2018 GROUP BY staff_id )</p>
<p>SELECT AVG(order_count) average_orders_by_staff FROM cte_sales;</p>
<p>–MORE EXAMPLES AT MS SQL TIPS <a href="https://www.mssqltips.com/sqlservertip/6861/cte-in-sql-server-examples/" class="uri">https://www.mssqltips.com/sqlservertip/6861/cte-in-sql-server-examples/</a> -EX 1</p>
<p>WITH Sum_OrderQuantity_CTE AS ( SELECT ProductKey ,EnglishMonthName ,SUM(OrderQuantity) AS TotalOrdersByMonth FROM [dbo].[FactInternetSales] fs INNER JOIN [dbo].[DimDate] dd ON dd.DateKey = fs.OrderDateKey GROUP BY ProductKey, EnglishMonthName</p>
<p>) SELECT ProductKey, AVG(TotalOrdersByMonth) AS ‘Average Total Orders By Month’ FROM Sum_OrderQuantity_CTE GROUP BY ProductKey ORDER BY ProductKey</p>
<p>-EX 2 WITH Simple_CTE AS ( SELECT dd.CalendarYear ,fs.OrderDateKey ,fs.ProductKey ,fs.OrderQuantity * fs.UnitPrice AS TotalSale ,dc.FirstName ,dc.LastName FROM [dbo].[FactInternetSales] fs INNER JOIN [dbo].[DimCustomer] dc ON dc.CustomerKey = fs.CustomerKey INNER JOIN [dbo].[DimDate] dd ON dd.DateKey = fs.OrderDateKey ) SELECT * FROM Simple_CTE</p>
<hr>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;">ADDITIONAL RESOURCES -</td>
</tr>
</tbody>
</table>
<p>*/</p>
</section>
<section id="format" class="level3">
<h3 class="anchored" data-anchor-id="format">Format</h3>
<p><img src="Images/FORMAT1.jpg" class="img-fluid"></p>
<p><img src="Images/FORMAT2.jpg" class="img-fluid"></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>