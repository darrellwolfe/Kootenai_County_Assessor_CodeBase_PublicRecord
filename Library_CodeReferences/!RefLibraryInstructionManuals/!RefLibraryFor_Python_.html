<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Python Quick Reference Library</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="!RefLibraryFor_Python__files/libs/clipboard/clipboard.min.js"></script>
<script src="!RefLibraryFor_Python__files/libs/quarto-html/quarto.js"></script>
<script src="!RefLibraryFor_Python__files/libs/quarto-html/popper.min.js"></script>
<script src="!RefLibraryFor_Python__files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="!RefLibraryFor_Python__files/libs/quarto-html/anchor.min.js"></script>
<link href="!RefLibraryFor_Python__files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="!RefLibraryFor_Python__files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="!RefLibraryFor_Python__files/libs/bootstrap/bootstrap.min.js"></script>
<link href="!RefLibraryFor_Python__files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="!RefLibraryFor_Python__files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Python Quick Reference Library</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="what-is-the-python-quick-reference-library" class="level1">
<h1>What is the Python Quick Reference Library?</h1>
<p>While learning to create Python solutions, we thought it wise to pause and document our progress, what we have learned, and what solutions worked for us. This will act as a guide for future developers within our office and beyond.</p>
<p>#C:Files.1 #C:Files.1exe #QUARTO_R: “C:/Program Files/R/R-4.4.1/bin/R.exe” setx QUARTO_R: “C:/Program Files/R/R-4.4.1/bin/R.exe”</p>
</section>
<section id="installs" class="level1">
<h1>Installs</h1>
<p>To actually knitt/stitch this document you will need to have Python, R, and Quarto installed on your machine through Visual Studio Code (or RStudio).</p>
<p><a href="https://quarto.org/docs/get-started/">Quarto</a></p>
<p><a href="https://cran.r-project.org/bin/windows/base/">Install R</a></p>
<p><a href="https://www.python.org/downloads/">Install Python</a></p>
<section id="ensure-r-and-python-interoperability-with-reticulate" class="level2">
<h2 class="anchored" data-anchor-id="ensure-r-and-python-interoperability-with-reticulate">Ensure R and Python Interoperability with <code>reticulate</code></h2>
<p><strong>(this allows a .rmd or .qmd document to work)</strong></p>
<p>The following code chunk will ensure that the <code>reticulate</code> package is installed, which is necessary for Python and R to work together in this document. When running this, you may get a pop-up asking you to select a <code>Secure CRAN mirror</code>, being in the Pacific Northwest (PNW) we typically use <code>USA (OR)[https]</code>, then select <code>OK</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to install a package if it is not already installed</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>install_if_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(package) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(package, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(package)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the 'reticulate' package</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install_if_missing</span>(<span class="st">"reticulate"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="python-basics" class="level1">
<h1>Python Basics</h1>
<p>In Python, there isn’t a single “base structure” like SQL’s <code>SELECT * FROM Table</code> that is universally used to introduce beginners to the language. However, there are a few fundamental concepts and structures that are often used to start teaching Python, much like how <code>SELECT * FROM Table</code> is a common starting point in SQL.</p>
<section id="the-basic-print-function" class="level2">
<h2 class="anchored" data-anchor-id="the-basic-print-function">1. The Basic print() Function</h2>
<ul>
<li>The print() function is often the very first thing taught in Python. It’s a simple way to display output, much like how SELECT * retrieves data in SQL.</li>
<li>This introduces the user to the syntax of Python and demonstrates how to run a basic command.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hello, World!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hello, World!</code></pre>
</div>
</div>
</section>
<section id="basic-variables-and-data-types" class="level2">
<h2 class="anchored" data-anchor-id="basic-variables-and-data-types">2. Basic Variables and Data Types</h2>
<ul>
<li>After introducing print(), the next step is usually to show how to create and use variables.</li>
<li>This teaches the concept of data types (str, int, bool, etc.) and how to store and use data in Python.</li>
</ul>
<p><strong><em>Note: in Python, variables do not need to be explicity called out as their data type as they do in SQL.</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compared to a SQL Example:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># DECLARE name VARCHAR = 'Alice';</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigning values to variables in Python </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   only requires the variable name you will call later, </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   and the `=` </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   and the variable. </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Python auto recognizes the data type.</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   Also note, that strings require quotes, int and booleans do not</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>name <span class="op">=</span> <span class="st">"Alice"</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>age <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>is_student <span class="op">=</span> <span class="va">True</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the variables</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Alice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(is_student)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="basic-data-structures" class="level2">
<h2 class="anchored" data-anchor-id="basic-data-structures">3. Basic Data Structures</h2>
<ul>
<li>The next step is often to introduce basic data structures like lists and dictionaries, which are central to Python programming.</li>
<li>This gives users a sense of how Python can store collections of data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fruits <span class="op">=</span> [<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fruits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['apple', 'banana', 'cherry']</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionary</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>person <span class="op">=</span> {<span class="st">"name"</span>: <span class="st">"Alice"</span>, <span class="st">"age"</span>: <span class="dv">30</span>, <span class="st">"is_student"</span>: <span class="va">True</span>}</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(person)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'name': 'Alice', 'age': 30, 'is_student': True}</code></pre>
</div>
</div>
</section>
<section id="control-flow-statements" class="level2">
<h2 class="anchored" data-anchor-id="control-flow-statements">4. Control Flow Statements</h2>
<p><strong><em>(aka If/Else logic and Loops)</em></strong></p>
<ul>
<li>Once variables and data types are understood, introducing control flow with if, for, and while statements is a logical next step.</li>
<li>This introduces users to decision-making and iteration in Python.</li>
<li>This is how you would use database connections to pull in dataframes and loop through them, more on that later.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conditional statement</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> age <span class="op">&gt;</span> <span class="dv">18</span>:</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Adult"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Minor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adult</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fruit <span class="kw">in</span> fruits:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(fruit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>apple
banana
cherry</code></pre>
</div>
</div>
</section>
<section id="functions" class="level2">
<h2 class="anchored" data-anchor-id="functions">5. Functions</h2>
<ul>
<li>Finally, teaching how to define and call functions is often a good way to encapsulate everything learned so far.</li>
<li>Functions show how to organize code into reusable blocks, similar to how queries and procedures are organized in SQL.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(name):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(greet(<span class="st">"Alice"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hello, Alice!</code></pre>
</div>
</div>
</section>
<section id="syntax" class="level2">
<h2 class="anchored" data-anchor-id="syntax">6. Syntax</h2>
<ul>
<li>Most code must be written in lower case for Python.
<ul>
<li>Ex: Print ()vs PRINT() vs print()</li>
<li>Only print() will actually run.</li>
</ul></li>
</ul>
</section>
<section id="notescomments" class="level2">
<h2 class="anchored" data-anchor-id="notescomments">7. Notes/Comments</h2>
<ul>
<li>Notes or Comments are important for leaving behind instructions or thought processess for future developers/coders to understand your script and then fix it or re-purpose it. This is especially true in an officer with other users coming behind you to use your tools.</li>
<li>In Python, there are essentially two ways to comment.
<ul>
<li>Single line comments: <code># This is a comment</code></li>
<li>Multi line comments: <code>""" This is comment """</code></li>
</ul></li>
</ul>
<p><strong><em>Note: In Python, when you include a multi-line string that’s not assigned or used in an expression, it’s technically treated as an object and not just a comment, especially in the context of an interactive or execution environment like Quarto. You can either use several single line comments or use the <code>if False:</code> to keep it from rendering as an object. Outside of Quarto (.qmd) in a normal code, the triple quotes will keep it from being read as code, but this could still be good practice to keep.</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Single Line Comment</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">False</span>:</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">    This</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Is A</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Multi</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Line Comment</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Comment Examples"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Comment Examples</code></pre>
</div>
</div>
</section>
<section id="indent" class="level2">
<h2 class="anchored" data-anchor-id="indent">8. Indent</h2>
<p>Unlike SQL, spaces/indenting matters for Python. The script flows such that a function that is not indented to run in the right way will break the cascading logic.</p>
<p>In the following example the function ``</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example function with indenting:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_image(image_path, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(image_path):</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Image file not found: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        screenshot <span class="op">=</span> pyautogui.screenshot()</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        screenshot <span class="op">=</span> cv2.cvtColor(np.array(screenshot), cv2.COLOR_BGR2GRAY)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> cv2.matchTemplate(screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        min_val, max_val, min_loc, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence:</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>            top_left <span class="op">=</span> max_loc</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>            h, w <span class="op">=</span> ref_image.shape</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>            center_x, center_y <span class="op">=</span> top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>            pyautogui.moveTo(center_x, center_y)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>            pyautogui.click()</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Clicked on the image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>            logging.warning(<span class="ss">f"Could not locate the image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss"> with confidence </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to click the image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Exception: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="python-code-structuring" class="level1">
<h1>Python Code Structuring</h1>
<p>While the exact structure a script takes can vary wildy, I have found that the frist tool I built worked best with a cascading flow of content as follows. This worked to both help the script ensure things were caling on items above them, and help the human reader understand what was happening.</p>
<p><strong><em>Include comments at each stage explaning what is happening… </em></strong></p>
<section id="libraries" class="level4">
<h4 class="anchored" data-anchor-id="libraries">1. Libraries</h4>
<p>Libraries required for the script to function.</p>
<ul>
<li>Import Libraries</li>
</ul>
</section>
<section id="global-logic" class="level4">
<h4 class="anchored" data-anchor-id="global-logic">2. Global Logic</h4>
<p>Functions that ensure the entire document flows and works</p>
<ul>
<li>Logging: A logging function to ensure all activities are logged for debugging</li>
<li>Kill Script: A kill script function to ensure you can stop the script, calling this at appropriate times in the script to ensure it works, at the beggining of each loop.</li>
<li>Connections:
<ul>
<li>Connection to database</li>
<li>Connection to stored images, image paths</li>
</ul></li>
<li>Glocal Logic (like ensure caps lock is off)</li>
<li>Establishing any GUI (graphic user interface) for the end user</li>
</ul>
</section>
<section id="specific-functions" class="level4">
<h4 class="anchored" data-anchor-id="specific-functions">3. Specific Functions</h4>
<p>Specific functions required to make the script run the tasks assigned - Screen capture OCR logic - Click image logic - Specific logic for script</p>
</section>
<section id="specific-commands-and-loops" class="level4">
<h4 class="anchored" data-anchor-id="specific-commands-and-loops">4. Specific Commands and loops</h4>
<ul>
<li>Establish/start the loop(s)
<ul>
<li>Specific commands, which may or may not call in earlier functions</li>
</ul></li>
<li>End loop(s)</li>
<li>End connection(s)</li>
</ul>
</section>
</section>
<section id="breaking-it-down" class="level1">
<h1>Breaking it down</h1>
<p>The following will break down specific examples and use cases of those code structures.</p>
<section id="python-libraries" class="level2">
<h2 class="anchored" data-anchor-id="python-libraries">1. Python Libraries</h2>
<p>The following libraries have been found useful for the building of automation tools for the Kootenai County Assessor’s Office.</p>
<section id="python-libraries-weve-used-or-found-helpful" class="level3">
<h3 class="anchored" data-anchor-id="python-libraries-weve-used-or-found-helpful">Python Libraries we’ve used or found helpful</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyautogui  <span class="co"># For automating GUI interactions like mouse movements and clicks</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyodbc  <span class="co"># For establishing database connections and executing SQL queries</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time  <span class="co"># For adding delays and managing time-related functions</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># For numerical operations and handling arrays/matrices</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keyboard  <span class="co"># For detecting and handling keyboard key presses</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> threading  <span class="co"># For running background tasks and creating concurrent threads</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk  <span class="co"># For creating basic GUI elements in Python applications</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkinter <span class="im">import</span> ttk, messagebox, scrolledtext  <span class="co"># For advanced Tkinter widgets, dialog boxes, and scrolled text areas</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytesseract  <span class="co"># For OCR (Optical Character Recognition) to read text from images</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image  <span class="co"># For working with image data</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2  <span class="co"># For image processing and computer vision tasks (OpenCV library)</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes  <span class="co"># For interacting with C data types and Windows API functions</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkcalendar <span class="im">import</span> Calendar, DateEntry  <span class="co"># For adding calendar widgets to Tkinter GUIs</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging  <span class="co"># For logging events, errors, and information during script execution</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> configparser  <span class="co"># For handling configuration files (.ini)</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os  <span class="co"># For interacting with the operating system, e.g., file and directory management</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, date  <span class="co"># For handling date and time operations</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> psutil  <span class="co"># For retrieving information on running processes and system utilization</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pygetwindow <span class="im">as</span> gw  <span class="co"># For getting and manipulating window information</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pywinauto <span class="im">import</span> Application  <span class="co"># For interacting with Windows applications programmatically</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime <span class="co"># For handling dates and times</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="python-libraries-used" class="level3">
<h3 class="anchored" data-anchor-id="python-libraries-used">Python Libraries Used</h3>
<section id="pyautogui" class="level5">
<h5 class="anchored" data-anchor-id="pyautogui"><code>pyautogui</code></h5>
<ul>
<li><strong>Purpose:</strong> Automates GUI (Graphical User Interface) interactions such as mouse clicks, keystrokes, and screen captures.</li>
<li><strong>Usage:</strong> To control mouse and keyboard actions, such as clicking buttons, typing text, and capturing screenshots of the screen.</li>
</ul>
</section>
<section id="pyodbc" class="level5">
<h5 class="anchored" data-anchor-id="pyodbc"><code>pyodbc</code></h5>
<ul>
<li><strong>Purpose:</strong> Enables connections to databases using ODBC (Open Database Connectivity).</li>
<li><strong>Usage:</strong> To connect to SQL Server databases, execute queries, and fetch results.</li>
</ul>
</section>
<section id="pywinauto.application" class="level5">
<h5 class="anchored" data-anchor-id="pywinauto.application"><code>pywinauto.Application</code></h5>
<ul>
<li><strong>Purpose:</strong> Facilitates interaction with Windows GUI applications.</li>
<li><strong>Usage:</strong> To automate tasks within Windows applications, such as focusing on specific windows.</li>
</ul>
</section>
<section id="time" class="level5">
<h5 class="anchored" data-anchor-id="time"><code>time</code></h5>
<ul>
<li><strong>Purpose:</strong> Provides time-related functions.</li>
<li><strong>Usage:</strong> To introduce delays (e.g., <code>time.sleep()</code>) between automated actions to ensure proper execution.</li>
</ul>
</section>
<section id="numpy" class="level5">
<h5 class="anchored" data-anchor-id="numpy"><code>numpy</code></h5>
<ul>
<li><strong>Purpose:</strong> Supports large, multi-dimensional arrays and matrices, along with a large collection of mathematical functions.</li>
<li><strong>Usage:</strong> To perform numerical operations, particularly in image processing.</li>
</ul>
</section>
<section id="keyboard" class="level5">
<h5 class="anchored" data-anchor-id="keyboard"><code>keyboard</code></h5>
<ul>
<li><strong>Purpose:</strong> Detects and handles keyboard events.</li>
<li><strong>Usage:</strong> To detect specific key presses, such as the ‘esc’ key to stop the script.</li>
</ul>
</section>
<section id="threading" class="level5">
<h5 class="anchored" data-anchor-id="threading"><code>threading</code></h5>
<ul>
<li><strong>Purpose:</strong> Allows for running multiple threads (tasks) concurrently.</li>
<li><strong>Usage:</strong> To run background tasks like monitoring for a kill key press.</li>
</ul>
</section>
<section id="tkinter" class="level5">
<h5 class="anchored" data-anchor-id="tkinter"><code>tkinter</code></h5>
<ul>
<li><strong>Purpose:</strong> Provides tools for creating graphical user interfaces (GUIs).</li>
<li><strong>Usage:</strong> To create input forms for collecting user inputs through a pop-up window.</li>
</ul>
</section>
<section id="tkinter.ttk-tkinter.messagebox" class="level5">
<h5 class="anchored" data-anchor-id="tkinter.ttk-tkinter.messagebox"><code>tkinter.ttk</code>, <code>tkinter.messagebox</code></h5>
<ul>
<li><strong>Purpose:</strong> <code>ttk</code> offers advanced widgets for Tkinter, and <code>messagebox</code> provides standard dialogs for showing messages.</li>
<li><strong>Usage:</strong> To enhance the GUI with better-looking widgets and display error messages or other notifications.</li>
</ul>
</section>
<section id="pytesseract" class="level5">
<h5 class="anchored" data-anchor-id="pytesseract"><code>pytesseract</code></h5>
<ul>
<li><strong>Purpose:</strong> Optical Character Recognition (OCR) tool for extracting text from images.</li>
<li><strong>Usage:</strong> To recognize and read text from screenshots or other images captured during the script’s execution.</li>
</ul>
</section>
<section id="pil.imagegrab" class="level5">
<h5 class="anchored" data-anchor-id="pil.imagegrab"><code>PIL.ImageGrab</code></h5>
<ul>
<li><strong>Purpose:</strong> Provides functionality to capture the screen or parts of it.</li>
<li><strong>Usage:</strong> To capture specific regions of the screen for further processing with OCR.</li>
</ul>
</section>
<section id="cv2-opencv" class="level5">
<h5 class="anchored" data-anchor-id="cv2-opencv"><code>cv2</code> (OpenCV)</h5>
<ul>
<li><strong>Purpose:</strong> A library for computer vision tasks, including image processing.</li>
<li><strong>Usage:</strong> To process images, match templates, and recognize UI elements on the screen.</li>
</ul>
</section>
<section id="os" class="level5">
<h5 class="anchored" data-anchor-id="os"><code>os</code></h5>
<ul>
<li><strong>Purpose:</strong> Provides functions to interact with the operating system, including file handling.</li>
<li><strong>Usage:</strong> To check if image files exist and interact with the file system.</li>
</ul>
</section>
<section id="datetime" class="level5">
<h5 class="anchored" data-anchor-id="datetime"><code>datetime</code></h5>
<ul>
<li><strong>Purpose:</strong> Supplies classes for manipulating dates and times.</li>
<li><strong>Usage:</strong> To generate timestamps, work with dates, and format date strings.</li>
</ul>
</section>
<section id="ctypes" class="level5">
<h5 class="anchored" data-anchor-id="ctypes"><code>ctypes</code></h5>
<ul>
<li><strong>Purpose:</strong> Provides C compatible data types and allows calling functions in DLLs or shared libraries.</li>
<li><strong>Usage:</strong> To interact with Windows system calls, such as checking if the CAPS LOCK key is on.</li>
</ul>
</section>
<section id="tkcalendar.dateentry" class="level5">
<h5 class="anchored" data-anchor-id="tkcalendar.dateentry"><code>tkcalendar.DateEntry</code></h5>
<ul>
<li><strong>Purpose:</strong> A widget to select dates from a calendar.</li>
<li><strong>Usage:</strong> To provide an easy way for the user to select dates in the GUI.</li>
</ul>
</section>
<section id="logging" class="level5">
<h5 class="anchored" data-anchor-id="logging"><code>logging</code></h5>
<ul>
<li><strong>Purpose:</strong> Provides a way to report status, error, and informational messages to a file or console.</li>
<li><strong>Usage:</strong> To record logs of the script’s execution, including errors, warnings, and information for debugging.</li>
</ul>
</section>
<section id="pygetwindow" class="level5">
<h5 class="anchored" data-anchor-id="pygetwindow"><code>pygetwindow</code></h5>
<ul>
<li><strong>Purpose:</strong> A simple cross-platform module to find and manipulate open windows on your computer.</li>
<li><strong>Usage:</strong> To retrieve window handles, bring specific windows into focus, or manipulate window states (e.g., minimize, maximize).</li>
</ul>
</section>
<section id="configparser" class="level5">
<h5 class="anchored" data-anchor-id="configparser"><code>configparser</code></h5>
<ul>
<li><strong>Purpose:</strong> Provides functionality for handling configuration files in the <code>.ini</code> format.</li>
<li><strong>Usage:</strong> To read, write, and modify configuration settings in a structured manner, often used for setting up initial parameters or options for scripts.</li>
</ul>
</section>
<section id="psutil" class="level5">
<h5 class="anchored" data-anchor-id="psutil"><code>psutil</code></h5>
<ul>
<li><strong>Purpose:</strong> A library for retrieving information on running processes and system utilization (CPU, memory, disks, network, sensors) in Python.</li>
<li><strong>Usage:</strong> To monitor system resources, manage processes, and gather statistics, often used to check if specific processes are running or to ensure enough system resources are available before executing tasks.</li>
</ul>
</section>
</section>
<section id="python-library-installation" class="level3">
<h3 class="anchored" data-anchor-id="python-library-installation">Python Library Installation</h3>
<p>This section will ensure that all necessary Python libraries are installed and ready to use. If a library is missing, it will be installed automatically. You can alter this in your script to match the libraries you choose. You can also comment it out after the install if it causes run problems. These libraries work together to automate and manage the input process, ensuring a smooth and accurate transfer of data into the ProVal system.</p>
<p><strong>Installing</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pkg_resources</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_if_missing(package):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        pkg_resources.get_distribution(package)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> pkg_resources.DistributionNotFound:</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        subprocess.check_call([sys.executable, <span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, package])</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># List of packages you want to ensure are installed</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>packages <span class="op">=</span> [</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pyautogui"</span>,       <span class="co"># For automating GUI interactions</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pyodbc"</span>,          <span class="co"># For database connections</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"numpy"</span>,           <span class="co"># For numerical operations</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"keyboard"</span>,        <span class="co"># For detecting key presses</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pytesseract"</span>,     <span class="co"># For OCR (Optical Character Recognition)</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pillow"</span>,          <span class="co"># For image processing related to Image</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"opencv-python"</span>,   <span class="co"># For image processing (cv2)</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tkcalendar"</span>       <span class="co"># For calendar widget in Tkinter</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the install_if_missing function to each package</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> package <span class="kw">in</span> packages:</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    install_if_missing(package)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co"># After ensuring all packages are installed, you can import them as needed in your script</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyautogui  <span class="co"># For automating GUI interactions like mouse movements and clicks</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyodbc  <span class="co"># For establishing database connections and executing SQL queries</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time  <span class="co"># For adding delays and managing time-related functions</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># For numerical operations and handling arrays/matrices</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keyboard  <span class="co"># For detecting and handling keyboard key presses</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> threading  <span class="co"># For running background tasks and creating concurrent threads</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk  <span class="co"># For creating basic GUI elements in Python applications</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkinter <span class="im">import</span> ttk, messagebox  <span class="co"># For advanced Tkinter widgets and displaying dialog boxes</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytesseract  <span class="co"># For OCR (Optical Character Recognition) to read text from images</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image  <span class="co"># For working with image data</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2  <span class="co"># For image processing and computer vision tasks (OpenCV library)</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes  <span class="co"># For interacting with C data types and Windows API functions</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkcalendar <span class="im">import</span> DateEntry  <span class="co"># For adding a calendar widget to Tkinter GUIs</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging  <span class="co"># For logging events, errors, and information during script execution</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime <span class="co"># For handling dates and times</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic logging setup</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Installing - commented out</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">import subprocess</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">import pkg_resources</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">import sys</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">def install_if_missing(package):</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">    try:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">        pkg_resources.get_distribution(package)</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">    except pkg_resources.DistributionNotFound:</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">        subprocess.check_call([sys.executable, "-m", "pip", "install", package])</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># List of packages you want to ensure are installed</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">packages = [</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">    "pyautogui",       # For automating GUI interactions</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">    "pyodbc",          # For database connections</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">    "numpy",           # For numerical operations</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">    "keyboard",        # For detecting key presses</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co">    "pytesseract",     # For OCR (Optical Character Recognition)</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">    "Pillow",          # For image processing related to Image</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co">    "opencv-python",   # For image processing (cv2)</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">    "tkcalendar"       # For calendar widget in Tkinter</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co">]</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the install_if_missing function to each package</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co">for package in packages:</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co">    install_if_missing(package)</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="co"># After ensuring all packages are installed, you can import them as needed in your script</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyautogui  <span class="co"># For automating GUI interactions like mouse movements and clicks</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyodbc  <span class="co"># For establishing database connections and executing SQL queries</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time  <span class="co"># For adding delays and managing time-related functions</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># For numerical operations and handling arrays/matrices</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keyboard  <span class="co"># For detecting and handling keyboard key presses</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> threading  <span class="co"># For running background tasks and creating concurrent threads</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk  <span class="co"># For creating basic GUI elements in Python applications</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkinter <span class="im">import</span> ttk, messagebox  <span class="co"># For advanced Tkinter widgets and displaying dialog boxes</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytesseract  <span class="co"># For OCR (Optical Character Recognition) to read text from images</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image  <span class="co"># For working with image data</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2  <span class="co"># For image processing and computer vision tasks (OpenCV library)</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes  <span class="co"># For interacting with C data types and Windows API functions</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkcalendar <span class="im">import</span> DateEntry  <span class="co"># For adding a calendar widget to Tkinter GUIs</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging  <span class="co"># For logging events, errors, and information during script execution</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime <span class="co"># For handling dates and times</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic logging setup</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="global-logics---connections" class="level2">
<h2 class="anchored" data-anchor-id="global-logics---connections">2. GLOBAL LOGICS - CONNECTIONS</h2>
<section id="logging-1" class="level3">
<h3 class="anchored" data-anchor-id="logging-1">Logging</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the path and file name to ensure it is unique to this script</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    filename='S:/Common/Comptroller Tech/Reports/Python/finalfolderinpath/filename.log',</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">'S:/Common/Comptroller Tech/Reports/Python/Auto_Mapping_Packet/MappingPacketsAutomation.log'</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span>logging.DEBUG,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>console_handler <span class="op">=</span> logging.StreamHandler()</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>console_handler.setLevel(logging.DEBUG)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>console_handler.setFormatter(logging.Formatter(<span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>logging.getLogger().addHandler(console_handler)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co"># It is used much like print("Attempting to..."), but includes the printout in the log created by the function.</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>logging.info(<span class="st">"Attempting to locate and click on the 'Land' tab..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kill-script" class="level3">
<h3 class="anchored" data-anchor-id="kill-script">Kill Script</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Global flag to indicate if the script should be stopped</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>stop_script <span class="op">=</span> <span class="va">False</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monitor_kill_key():</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> stop_script</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Kill key monitor started. Press 'esc' to stop the script."</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    keyboard.wait(<span class="st">'esc'</span>)  <span class="co"># Set 'esc' as the kill key</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    stop_script <span class="op">=</span> <span class="va">True</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Kill key pressed. Stopping the script..."</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the kill key monitoring in a separate thread</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>kill_key_thread <span class="op">=</span> threading.Thread(target<span class="op">=</span>monitor_kill_key)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>kill_key_thread.daemon <span class="op">=</span> <span class="va">True</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>kill_key_thread.start()</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Below in the actual code, include the following at various breakpoints,</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Typically at the start of loops.</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure indentation matches the loop point</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> stop_script:</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of use and indentation</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    DBAIN, DBACRE <span class="op">=</span> row</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process each AIN individually</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    set_focus_and_type(<span class="st">'ProVal'</span>, DBAIN)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="connections-database" class="level3">
<h3 class="anchored" data-anchor-id="connections-database">Connections: Database</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration for database connection</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>db_connection_string <span class="op">=</span> (</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Driver={SQL Server};"</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Server=astxdbprod;"</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Database=GRM_Main;"</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trusted_Connection=yes;"</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to connect to the database</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> connect_to_database(connection_string):</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pyodbc.<span class="ex">connect</span>(connection_string)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to execute a SQL query and fetch data</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> execute_query(cursor, query):</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    cursor.execute(query)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cursor.fetchall()</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co">Connect to the database, </span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co">pull a simple SQL query with two columns,</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co">then the  for row in rows assigns those columns as variables </span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> connect_to_database(db_connection_string)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> conn.cursor()</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co"># The query should accommodate multiple AINs in a list</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: in-between the quotes is a SQL script that uses the user input field function as a condition.</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   In this use-case, the user-input gui pop-up function would be between the database function and this call, but theoretically you could call the connection later when you are ready to use it.</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="ss">f"SELECT TRIM(pm.AIN), pm.LegalAcres FROM TSBv_Parcelmaster AS pm WHERE pm.AIN IN (</span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(AINLIST)<span class="sc">}</span><span class="ss">)"</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> execute_query(cursor, query)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="graphic-user-interface-gui-logic---start" class="level4">
<h4 class="anchored" data-anchor-id="graphic-user-interface-gui-logic---start">Graphic User Interface (GUI) Logic - START</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Graphic User Interface (GUI) Logic - START</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize variables to avoid 'NameError', will call them into the final product after variable selections</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>MemoTXT <span class="op">=</span> <span class="st">""</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>PDESC <span class="op">=</span> <span class="st">""</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> on_submit():</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> AINLIST, AINFROM, AINTO, PDESC, PFILE, PNUMBER, TREVIEW, MappingPacketType, Initials, MemoTXT, ForYear</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect inputs for AINFROM and AINTO, and split by commas</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    AINFROM <span class="op">=</span> [ain.strip() <span class="cf">for</span> ain <span class="kw">in</span> entry_ainfrom.get().strip().upper().split(<span class="st">","</span>)]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    AINTO <span class="op">=</span> [ain.strip() <span class="cf">for</span> ain <span class="kw">in</span> entry_ainto.get().strip().upper().split(<span class="st">","</span>)]</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine the AINFROM and AINTO lists, removing duplicates</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    combined_ain_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(AINFROM <span class="op">+</span> AINTO))</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace AINLIST with the combined list</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    AINLIST <span class="op">=</span> combined_ain_list</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    PFILE <span class="op">=</span> entry_pfile.get().strip().upper()</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    PNUMBER <span class="op">=</span> entry_pnumber.get().strip().upper()</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    TREVIEW <span class="op">=</span> entry_treview.get().strip().upper()</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    MappingPacketType <span class="op">=</span> combobox_mappingpackettype.get().strip().upper()</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    Initials <span class="op">=</span> entry_initials.get().strip().upper()</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    ForYear <span class="op">=</span> for_year_combobox.get().strip()  <span class="co"># Get the selected year</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    the_month <span class="op">=</span> datetime.now().month</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    the_day <span class="op">=</span> datetime.now().day</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    the_year <span class="op">=</span> datetime.now().year</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_month = datetime.datetime.now().month</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_day = datetime.datetime.now().day</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_year = datetime.datetime.now().year</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    AINFROM_str <span class="op">=</span> <span class="st">', '</span>.join(AINFROM)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    AINTO_str <span class="op">=</span> <span class="st">', '</span>.join(AINTO)</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    MemoTXT <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>Initials<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>the_month<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">str</span>(the_year)[<span class="op">-</span><span class="dv">2</span>:]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>MappingPacketType<span class="sc">}</span><span class="ss"> from </span><span class="sc">{</span>AINFROM_str<span class="sc">}</span><span class="ss"> into </span><span class="sc">{</span>AINTO_str<span class="sc">}</span><span class="ss"> for </span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Generated MemoTXT: </span><span class="sc">{</span>MemoTXT<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    PDESC <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>MappingPacketType<span class="sc">}</span><span class="ss"> for </span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> AINLIST <span class="kw">or</span> <span class="kw">not</span> PFILE <span class="kw">or</span> <span class="kw">not</span> PNUMBER <span class="kw">or</span> <span class="kw">not</span> TREVIEW <span class="kw">or</span> <span class="kw">not</span> MappingPacketType <span class="kw">or</span> <span class="kw">not</span> Initials <span class="kw">or</span> <span class="kw">not</span> MemoTXT <span class="kw">or</span> <span class="kw">not</span> PDESC:</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>        messagebox.showerror(<span class="st">"Input Error"</span>, <span class="st">"All input fields are required."</span>)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    root.destroy()  <span class="co"># Close the GUI</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup_gui():</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> tk.Tk()</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    root.title(<span class="st">"User Input Form"</span>)</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    setup_widgets(root)</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> root</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_initials(action, value_if_allowed):</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Allow only alphabetic characters and limit to 3 characters</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> action <span class="op">==</span> <span class="st">'1'</span>:  <span class="co"># 1 means an insertion operation</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(value_if_allowed) <span class="op">&gt;</span> <span class="dv">3</span>:</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> value_if_allowed.isalpha()</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup_widgets(root):</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> entry_ainfrom, entry_ainto, entry_pfile, entry_pnumber, entry_treview, combobox_mappingpackettype, entry_initials, for_year_combobox</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the current and next year</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>    current_year <span class="op">=</span> datetime.now().year</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    next_year <span class="op">=</span> current_year <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Mapping packet FOR what year?:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>    for_year_combobox <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>[current_year, next_year], width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the current year</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AINFROM input</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"List AINs FROM (separated by comma):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">0</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    entry_ainfrom <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>    entry_ainfrom.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">0</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AINTO input</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"List AINs TO (separated by comma):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    entry_ainto <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>    entry_ainto.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Existing fields continue below...</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Mapping packet FOR what year?:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">2</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>    for_year_combobox <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>[current_year, next_year], width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">2</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the current year</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Filing Date (Top Date):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">3</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>    entry_pfile <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>    entry_pfile.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">3</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Permit Number (Bottom Date):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">4</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>    entry_pnumber <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>    entry_pnumber.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">4</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Timber or AG review? Y/N:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">5</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>    entry_treview <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>    entry_treview.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">5</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Select Mapping Packet Type:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">6</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>    mapping_packet_types <span class="op">=</span> [</span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MERGE"</span>, <span class="st">"SPLIT"</span>, <span class="st">"BLA"</span>, <span class="st">"LLA"</span>, <span class="st">"RW VACATION"</span>, <span class="st">"RW SPLIT"</span>, <span class="st">"REDESCRIBE"</span>,</span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RW AUDIT"</span>, <span class="st">"RW Cat19"</span>, <span class="st">"AIRPORT LEASE NEW PARCEL"</span>, <span class="st">"PLAT VACATION"</span>,</span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PARCEL DELETED"</span>, <span class="st">"ACERAGE AUDIT"</span>, <span class="st">"NEW PLAT"</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>mapping_packet_types, width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">6</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the first item</span></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validation for the Initials Entry</span></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a>    vcmd <span class="op">=</span> (root.register(validate_initials), <span class="st">'</span><span class="sc">%d</span><span class="st">'</span>, <span class="st">'%P'</span>)</span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Enter (3) Initials:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">7</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>    entry_initials <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>, validate<span class="op">=</span><span class="st">'key'</span>, validatecommand<span class="op">=</span>vcmd)</span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>    entry_initials.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">7</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>    entry_initials.insert(<span class="dv">0</span>, <span class="st">"DGW"</span>)</span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>    submit_button <span class="op">=</span> ttk.Button(root, text<span class="op">=</span><span class="st">"Submit"</span>, command<span class="op">=</span>on_submit)</span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>    submit_button.grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">8</span>, columnspan<span class="op">=</span><span class="dv">2</span>, pady<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> setup_gui()</span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a><span class="co">### Graphic User Interface (GUI) Logic - </span><span class="re">END</span></span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a><span class="co"># EXAMPLES OF USE CASES</span></span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> AINLIST <span class="kw">or</span> <span class="kw">not</span> MemoTXT <span class="kw">or</span> <span class="kw">not</span> PDESC <span class="kw">or</span> <span class="kw">not</span> PFILE <span class="kw">or</span> <span class="kw">not</span> PNUMBER <span class="kw">or</span> <span class="kw">not</span> TREVIEW:</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a>    logging.error(<span class="st">"All input fields are required."</span>)</span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>    exit()</span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> connect_to_database(db_connection_string)</span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> conn.cursor()</span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a><span class="co"># The query should accommodate multiple AINs in a list</span></span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="ss">f"SELECT TRIM(pm.AIN), pm.LegalAcres FROM TSBv_Parcelmaster AS pm WHERE pm.AIN IN (</span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(AINLIST)<span class="sc">}</span><span class="ss">)"</span></span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> execute_query(cursor, query)</span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(<span class="bu">str</span>(DBAIN))</span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a>logging.info(<span class="ss">f"Sent AIN </span><span class="sc">{</span>DBAIN<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(MemoTXT)</span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(PNUMBER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="global-logics---logic-functions" class="level2">
<h2 class="anchored" data-anchor-id="global-logics---logic-functions">3. GLOBAL LOGICS - LOGIC FUNCTIONS</h2>
<section id="caps-lock" class="level4">
<h4 class="anchored" data-anchor-id="caps-lock">CAPS LOCK</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CAPS Lock Logic</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_capslock_on():</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This will return 1 if CAPS LOCK is on, 0 if it's off</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    hllDll <span class="op">=</span> ctypes.WinDLL(<span class="st">"User32.dll"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    VK_CAPITAL <span class="op">=</span> <span class="bn">0x14</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hllDll.GetKeyState(VK_CAPITAL) <span class="op">&amp;</span> <span class="dv">1</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ensure_capslock_off():</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_capslock_on():</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'capslock'</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"CAPS LOCK was on. It has been turned off."</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"CAPS LOCK is already off."</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(MemoTXT)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-focus" class="level4">
<h4 class="anchored" data-anchor-id="set-focus">SET FOCUS</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">SET FOCUS LOGIC - can be called to set focus to different screens at different points in the process</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_focus_and_type(window_title, keys):</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    window <span class="op">=</span> pyautogui.getWindowsWithTitle(window_title)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> window:</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        window[<span class="dv">0</span>].activate()</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(keys)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>set_focus_and_type(<span class="st">'ProVal'</span>, DBAIN)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>time.sleep(<span class="dv">1</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>logging.info(<span class="st">"set_focus_and_type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="press-click-key-logic" class="level4">
<h4 class="anchored" data-anchor-id="press-click-key-logic">PRESS &amp; CLICK KEY LOGIC</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">PRESS &amp; CLICK LOGIC -- sets logic for various kinds of click tasks</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_with_modifier_multiple_times(modifier, key, times):</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        pyautogui.hotkey(modifier, key)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_multiple_times(key, times):</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(key)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> triple_click(x, y):</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    pyautogui.click(x, y, clicks<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>press_key_with_modifier_multiple_times(<span class="st">'shift'</span>, <span class="st">'tab'</span>, <span class="dv">6</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>time.sleep(<span class="dv">1</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>press_key_multiple_times(<span class="st">'up'</span>, <span class="dv">12</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>logging.info(<span class="st">"press_key_multiple_times"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="global-logics---screen-handling-functions" class="level2">
<h2 class="anchored" data-anchor-id="global-logics---screen-handling-functions">4. GLOBAL LOGICS - SCREEN HANDLING FUNCTIONS</h2>
<section id="connections-ocr-and-image-paths" class="level3">
<h3 class="anchored" data-anchor-id="connections-ocr-and-image-paths">Connections: OCR and Image Paths</h3>
<section id="ocr" class="level4">
<h4 class="anchored" data-anchor-id="ocr">OCR</h4>
<p>OCR stands for Optical Character Recognition. It is a technology used to convert different types of documents, such as scanned paper documents, PDF files, or images captured by a digital camera, into editable and searchable data. OCR software analyzes the shapes and patterns of the characters in the image and translates them into machine-readable text.</p>
<p>In our use-case, OCR can be used to read ProVal and Aumentum screens, match a stored image to that screenshot, find the location of that image on the current screen, and then click that image.</p>
<p>OCR requires downloading and installing the <code>tesseract</code> OCR tool from the GitHub repo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL LOGICS - SCREEN HANDLING FUNCTIONS</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">### Connections: OCR and Image Paths</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#### OCR</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># This OCR program is required to work with this script, it is available on GitHub</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the tesseract executable path if not in the system path</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Update this path as necessary by user you will need to download and install tesseract from GitHub</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Link https://github.com/tesseract-ocr/tesseract</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Link https://github.com/UB-Mannheim/tesseract/wiki</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>pytesseract.pytesseract.tesseract_cmd <span class="op">=</span> <span class="vs">r'C:\Users\dwolfe\AppData\Local\Programs\Tesseract-OCR\tesseract.exe'</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#### Image Paths - Active and Inactive</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>land_tab_images <span class="op">=</span> [</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_tab.PNG'</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_tab_active.PNG'</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>land_base_tab_images <span class="op">=</span> [</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_base_tab.PNG'</span>,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_base_tab_active.PNG'</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>permits_tab_images <span class="op">=</span> [</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_tab.PNG'</span>,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_tab_active.PNG'</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>permits_add_permit_button <span class="op">=</span> [</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_permit_button.PNG'</span>,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_permit_button_active.PNG'</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="co">#### Image Paths - Single Images Only</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>duplicate_memo_image_path <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_memo_duplicate.PNG'</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>add_field_visit_image_path <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_fieldvisit_button.PNG'</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>aggregate_land_type_add_button <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_aggregate_land_type_add_button.PNG'</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>farm_total_acres_image <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_farm_total_acres.PNG'</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>permit_description <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permit_description.PNG'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="capture-screen-in-greyscale-2-click-using-a-reference-greyscale-screenshot-to-a-stored-greyscale-image-includes-ability-to-click-relative-position" class="level4">
<h4 class="anchored" data-anchor-id="capture-screen-in-greyscale-2-click-using-a-reference-greyscale-screenshot-to-a-stored-greyscale-image-includes-ability-to-click-relative-position">1 CAPTURE SCREEN IN GREYSCALE &amp; 2 CLICK USING A REFERENCE GREYSCALE SCREENSHOT TO A STORED GREYSCALE IMAGE INCLUDES ABILITY TO CLICK RELATIVE POSITION</h4>
<ul>
<li><code>capture_and_convert_screenshot</code>, captures the screen in greyscale</li>
<li><code>click_on_image</code>, pulls the captured screen from <code>capture_and_convert_screenshot</code> and determines location</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 CAPTURE SCREEN IN GREYSCALE</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> capture_and_convert_screenshot():</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Capture the screenshot using pyautogui</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    screenshot <span class="op">=</span> pyautogui.screenshot()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the screenshot to a numpy array, then to BGR, and finally to greyscale</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    screenshot_np <span class="op">=</span> np.array(screenshot)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    screenshot_np <span class="op">=</span> cv2.cvtColor(screenshot_np, cv2.COLOR_RGB2BGR)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> cv2.cvtColor(screenshot_np, cv2.COLOR_BGR2GRAY)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grey_screenshot</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 CLICK USING A REFERENCE GREYSCALE SCREENSHOT TO A STORED GREYSCALE IMAGE INCLUDES ABILITY TO CLICK RELATIVE POSITION</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_on_image(image_path, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">10</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the reference image in greyscale</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ref_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to load reference image from </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cv2.matchTemplate(grey_screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    _, max_val, _, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence:</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        top_left <span class="op">=</span> max_loc</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>        h, w <span class="op">=</span> ref_image.shape</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>        right <span class="op">=</span> top_left[<span class="dv">0</span>] <span class="op">+</span> w</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> top_left[<span class="dv">1</span>] <span class="op">+</span> h</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate click position based on direction and inset/offset</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>        click_positions <span class="op">=</span> {</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'right'</span>: (right <span class="op">+</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'left'</span>: (top_left[<span class="dv">0</span>] <span class="op">-</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'above'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">-</span> offset),</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">'below'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">+</span> offset),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_right_corner'</span>: (right <span class="op">-</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_right_corner'</span>: (right <span class="op">-</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">-</span> inset),</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">'center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>        click_x, click_y <span class="op">=</span> click_positions[direction]</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform the click</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>        pyautogui.click(click_x, click_y)</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of the image at (</span><span class="sc">{</span>click_x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>click_y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="ss">f"No good match found at the confidence level of </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="co">        # Ref Function click_on_image in the following functions 3, 4, 5, etc... </span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="co">        # These reference functions can be called in the final automation script </span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-click_on_image-function" class="level4">
<h4 class="anchored" data-anchor-id="using-click_on_image-function">3 USING click_on_image FUNCTION</h4>
<p>Both version of the following click_images functions will call an image and click on it. However, in some cases, the image may look slightly different if it is already selected vs if it is not. In those cases, having more than one optoin to click is helpful. Therefore: - <code>click_images_multiple</code>, will cycle through image options (selected vs not-selected, or, active vs inactive) - <code>click_image_single</code>, will click the single stored image</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 USING click_on_image FUNCTION</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Specific Click Functions Here, See click_on_image for directionals, and image pathes for images</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_images_multiple(paths, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">50</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.75</span>):</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image_path <span class="kw">in</span> paths:</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Trying to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> on image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_on_image(image_path, direction<span class="op">=</span>direction, offset<span class="op">=</span>offset, inset<span class="op">=</span>inset, confidence<span class="op">=</span>confidence):</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Successfully clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>            logging.warning(<span class="ss">f"Failed to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_image_single(image_path, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">50</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.75</span>):</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Trying to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> on image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_on_image(image_path, direction<span class="op">=</span>direction, offset<span class="op">=</span>offset, inset<span class="op">=</span>inset, confidence<span class="op">=</span>confidence):</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Successfully clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="ss">f"Failed to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How to use these click_images_multiple &amp; click_image_single functions in script</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click below all specified images</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_images_multiple(multiple_image_path_name_here, direction<span class="op">=</span><span class="st">'below'</span>, offset<span class="op">=</span><span class="dv">100</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully."</span>)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click at the center of a single image</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(single_image_path_name_here, direction<span class="op">=</span><span class="st">'center'</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully."</span>)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click at the bottom right corner of a single image</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(single_image_path_name_here, direction<span class="op">=</span><span class="st">'bottom_right_corner'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully."</span>)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click to right of permit_description, by calling offset=5 it was just barely below the image, which is what I wanted</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(permit_description, direction<span class="op">=</span><span class="st">'below'</span>, offset<span class="op">=</span><span class="dv">5</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully permit_description."</span>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-if-image-is-present" class="level4">
<h4 class="anchored" data-anchor-id="checking-if-image-is-present">4 CHECKING IF IMAGE IS PRESENT</h4>
<ul>
<li><code>is_image_found</code>, performs a simple logical test to see if the image is present, which can then be used to create branched senarios.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 CHECKING IF IMAGE IS PRESENT</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_image_found(image_path, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Check if an image is present on the screen with a specified confidence level.</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">    :param image_path: Path to the image file to be checked.</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">    :param confidence: The confidence level for the image matching.</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: bool - True if image is found, False otherwise.</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the existing function to capture and convert the screenshot</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the reference image in greyscale</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ref_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to load reference image from </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cv2.matchTemplate(grey_screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    _, max_val, _, _ <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    found <span class="op">=</span> max_val <span class="op">&gt;=</span> confidence</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> found:</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Image found with confidence </span><span class="sc">{</span>max_val<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Image not found with sufficient confidence </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> found</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="co"># How to use the is_image_found function below in script:</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the image is found and decide based on that</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_image_found(image_path_name_here, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Image was found - executing related tasks."</span>)</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform tasks related to the image being found</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Image was not found - executing alternative tasks."</span>)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform alternative tasks</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Example:</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the image is found and decide based on that</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_image_found(farm_total_acres_image, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Image was found - executing related tasks."</span>)</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform tasks related to the image being found</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click to the right of Farm Acres</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_image_single(farm_total_acres_image, direction<span class="op">=</span><span class="st">'right'</span>, offset<span class="op">=</span><span class="dv">15</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully farm_total_acres_image."</span>)</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Delete the contents and send DBACRE</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'delete'</span>)</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="bu">str</span>(DBACRE))</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"farm_total_acres_image Image was not found - executing alternative tasks."</span>)</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform alternative tasks</span></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click to the right of Farm Acres</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_image_single(aggregate_land_type_add_button, direction<span class="op">=</span><span class="st">'bottom_right_corner'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully aggregate_land_type_add_button."</span>)</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send the DBACRE value after clicking the fallback button</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="st">'f'</span>)</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="bu">str</span>(DBACRE))</span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-text-from-screen" class="level4">
<h4 class="anchored" data-anchor-id="read-text-from-screen">5 READ TEXT FROM SCREEN</h4>
<ul>
<li><code>check_for_text_on_screen</code>, performs a check to see if particular text is found on the screen at this stage in the script, then branches based on the outcome.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 READ TEXT FROM SCREEN</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_for_text_on_screen(target_text):</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Captures the screen, converts it to greyscale, performs OCR, and checks for the specified text.</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">    :param target_text: Text to search for in the OCR results.</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: True if the text is found, False otherwise.</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    grey_screenshot_pil <span class="op">=</span> Image.fromarray(grey_screenshot)  <span class="co"># Convert numpy array back to a PIL Image</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    screen_text <span class="op">=</span> pytesseract.image_to_string(grey_screenshot_pil)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> target_text <span class="kw">in</span> screen_text</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co"># How to use the check_for_text_on_screen function below in script:</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the specific text you're looking for</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>specific_text <span class="op">=</span> <span class="st">"text_you_want_to_check_here"</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the variable in your function call and print statements</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> check_for_text_on_screen(specific_text):</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Found '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Did not find '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Example:</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Enter Land Memos</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CHECK IF LAND</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the specific text you're looking for</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    specific_text <span class="op">=</span> <span class="st">"LAND"</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the variable in your function call and print statements</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> check_for_text_on_screen(specific_text):</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Found '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'l'</span>)</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(MemoTXT)</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Did not find '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'l'</span>)</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(MemoTXT)</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="keyboard-automation-using-pyautogui-to-automate-various-keyboard-actions" class="level1">
<h1>KEYBOARD AUTOMATION – USING <code>pyautogui</code> TO AUTOMATE VARIOUS KEYBOARD ACTIONS</h1>
<section id="pyautogui-automations" class="level3">
<h3 class="anchored" data-anchor-id="pyautogui-automations">pyautogui automations</h3>
<p>The <code>pyautogui</code> library can be used either directly in the script or as part of a larger function, but examples below.</p>
<section id="pyautogui-as-stand-alone" class="level4">
<h4 class="anchored" data-anchor-id="pyautogui-as-stand-alone"><code>pyautogui</code> As stand-alone</h4>
<ul>
<li>pyautogui.press()</li>
<li>pyautogui.typewrite()</li>
<li>pyautogui.hotkey()</li>
</ul>
</section>
<section id="pyautogui-as-part-of-a-function" class="level4">
<h4 class="anchored" data-anchor-id="pyautogui-as-part-of-a-function"><code>pyautogui</code> As part of a function</h4>
<ul>
<li><p>press_key_multiple_times</p></li>
<li><p>press_key_with_modifier_multiple_times</p></li>
<li><p>pyautogui.click() &gt; This one is only used once in my script, as part of a function, and then that function is called many times in various ways.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### `pyautogui` As stand-alone</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pyautogui.typewrite()</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(<span class="bu">str</span>(DBACRE))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(<span class="bu">str</span>(DBAIN))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(MemoTXT)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(PNUMBER)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(<span class="st">'f'</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(<span class="ss">f"04/01/</span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(<span class="ss">f"</span><span class="sc">{</span>PDESC<span class="sc">}</span><span class="ss"> FOR TIMBER REVIEW"</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>pyautogui.typewrite(<span class="st">'p'</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co"># pyautogui.hotkey()</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'o'</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'shift'</span>, <span class="st">'m'</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co"># pyautogui.press()</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>pyautogui.press([<span class="st">'tab'</span>])</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>pyautogui.press([<span class="st">'delete'</span>])</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>pyautogui.press(<span class="st">'l'</span>)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>pyautogui.press(<span class="st">'right'</span>)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="co">#### `pyautogui` As part of a function</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_multiple_times(key, times):</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(key)</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>press_key_multiple_times(<span class="st">'up'</span>, <span class="dv">12</span>)</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>press_key_multiple_times(<span class="st">'down'</span>, <span class="dv">4</span>)</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>press_key_multiple_times([<span class="st">'tab'</span>], <span class="dv">3</span>)</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_with_modifier_multiple_times(modifier, key, times):</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>        pyautogui.hotkey(modifier, key)</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>press_key_with_modifier_multiple_times(<span class="st">'shift'</span>, <span class="st">'tab'</span>, <span class="dv">6</span>)</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a><span class="co"># pyautogui.click()</span></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 CLICK USING A REFERENCE GREYSCALE SCREENSHOT TO A STORED GREYSCALE IMAGE INCLUDES ABILITY TO CLICK RELATIVE POSITION</span></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_on_image(image_path, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">10</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the reference image in greyscale</span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>    ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ref_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to load reference image from </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cv2.matchTemplate(grey_screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a>    _, max_val, _, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence:</span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>        top_left <span class="op">=</span> max_loc</span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>        h, w <span class="op">=</span> ref_image.shape</span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>        right <span class="op">=</span> top_left[<span class="dv">0</span>] <span class="op">+</span> w</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> top_left[<span class="dv">1</span>] <span class="op">+</span> h</span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate click position based on direction and inset/offset</span></span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>        click_positions <span class="op">=</span> {</span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">'right'</span>: (right <span class="op">+</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">'left'</span>: (top_left[<span class="dv">0</span>] <span class="op">-</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">'above'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">-</span> offset),</span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">'below'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">+</span> offset),</span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_right_corner'</span>: (right <span class="op">-</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_right_corner'</span>: (right <span class="op">-</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">-</span> inset),</span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">'center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a>        click_x, click_y <span class="op">=</span> click_positions[direction]</span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pyautogui.click()</span></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform the click</span></span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a>        pyautogui.click(click_x, click_y)</span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of the image at (</span><span class="sc">{</span>click_x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>click_y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="ss">f"No good match found at the confidence level of </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="putting-it-all-together-into-a-final-script" class="level1">
<h1>PUTTING IT ALL TOGETHER INTO A FINAL SCRIPT</h1>
<section id="example-mappingpacketsautomation_final.py" class="level2">
<h2 class="anchored" data-anchor-id="example-mappingpacketsautomation_final.py">EXAMPLE: <code>MappingPacketsAutomation_FINAL.py</code></h2>
<p>The previous example portions were taken from the <code>MappingPacketsAutomation_FINAL.py</code> script, here is the final script in it’s final form.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pkg_resources</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_if_missing(package):</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        pkg_resources.get_distribution(package)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> pkg_resources.DistributionNotFound:</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        subprocess.check_call([sys.executable, <span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, package])</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># List of packages you want to ensure are installed</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>packages <span class="op">=</span> [</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pyautogui"</span>,       <span class="co"># For automating GUI interactions</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pyodbc"</span>,          <span class="co"># For database connections</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"numpy"</span>,           <span class="co"># For numerical operations</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"keyboard"</span>,        <span class="co"># For detecting key presses</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pytesseract"</span>,     <span class="co"># For OCR (Optical Character Recognition)</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pillow"</span>,          <span class="co"># For image processing related to Image</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"opencv-python"</span>,   <span class="co"># For image processing (cv2)</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tkcalendar"</span>       <span class="co"># For calendar widget in Tkinter</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the install_if_missing function to each package</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> package <span class="kw">in</span> packages:</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    install_if_missing(package)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="co"># After ensuring all packages are installed, you can import them as needed in your script</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyautogui  <span class="co"># For automating GUI interactions like mouse movements and clicks</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyodbc  <span class="co"># For establishing database connections and executing SQL queries</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time  <span class="co"># For adding delays and managing time-related functions</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># For numerical operations and handling arrays/matrices</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keyboard  <span class="co"># For detecting and handling keyboard key presses</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> threading  <span class="co"># For running background tasks and creating concurrent threads</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk  <span class="co"># For creating basic GUI elements in Python applications</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkinter <span class="im">import</span> ttk, messagebox  <span class="co"># For advanced Tkinter widgets and displaying dialog boxes</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytesseract  <span class="co"># For OCR (Optical Character Recognition) to read text from images</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image  <span class="co"># For working with image data</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2  <span class="co"># For image processing and computer vision tasks (OpenCV library)</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes  <span class="co"># For interacting with C data types and Windows API functions</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkcalendar <span class="im">import</span> DateEntry  <span class="co"># For adding a calendar widget to Tkinter GUIs</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging  <span class="co"># For logging events, errors, and information during script execution</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime <span class="co"># For handling dates and times</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL LOGICS - CONNECTIONS</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="co">### Logging</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">'S:/Common/Comptroller Tech/Reports/Python/Auto_Mapping_Packet/MappingPacketsAutomation.log'</span>,</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span>logging.DEBUG,</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>console_handler <span class="op">=</span> logging.StreamHandler()</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>console_handler.setLevel(logging.DEBUG)</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>console_handler.setFormatter(logging.Formatter(<span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>))</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>logging.getLogger().addHandler(console_handler)</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a><span class="co">### Kill Script</span></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Global flag to indicate if the script should be stopped</span></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>stop_script <span class="op">=</span> <span class="va">False</span></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monitor_kill_key():</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> stop_script</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Kill key monitor started. Press 'esc' to stop the script."</span>)</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>    keyboard.wait(<span class="st">'esc'</span>)  <span class="co"># Set 'esc' as the kill key</span></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>    stop_script <span class="op">=</span> <span class="va">True</span></span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Kill key pressed. Stopping the script..."</span>)</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the kill key monitoring in a separate thread</span></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>kill_key_thread <span class="op">=</span> threading.Thread(target<span class="op">=</span>monitor_kill_key)</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>kill_key_thread.daemon <span class="op">=</span> <span class="va">True</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>kill_key_thread.start()</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a><span class="co">### Connections: Database</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration for database connection</span></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>db_connection_string <span class="op">=</span> (</span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Driver={SQL Server};"</span></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Server=astxdbprod;"</span></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Database=GRM_Main;"</span></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trusted_Connection=yes;"</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to connect to the database</span></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> connect_to_database(connection_string):</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pyodbc.<span class="ex">connect</span>(connection_string)</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to execute a SQL query and fetch data</span></span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> execute_query(cursor, query):</span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a>    cursor.execute(query)</span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cursor.fetchall()</span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a><span class="co">### Graphic User Interface (GUI) Logic - START</span></span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize variables to avoid 'NameError', will call them into the final product after variable selections</span></span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a>MemoTXT <span class="op">=</span> <span class="st">""</span></span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a>PDESC <span class="op">=</span> <span class="st">""</span></span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> on_submit():</span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> AINLIST, AINFROM, AINTO, PDESC, PFILE, PNUMBER, TREVIEW, MappingPacketType, Initials, MemoTXT, ForYear</span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect inputs for AINFROM and AINTO, and split by commas</span></span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>    AINFROM <span class="op">=</span> [ain.strip() <span class="cf">for</span> ain <span class="kw">in</span> entry_ainfrom.get().strip().upper().split(<span class="st">","</span>)]</span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>    AINTO <span class="op">=</span> [ain.strip() <span class="cf">for</span> ain <span class="kw">in</span> entry_ainto.get().strip().upper().split(<span class="st">","</span>)]</span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine the AINFROM and AINTO lists, removing duplicates</span></span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>    combined_ain_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(AINFROM <span class="op">+</span> AINTO))</span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace AINLIST with the combined list</span></span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a>    AINLIST <span class="op">=</span> combined_ain_list</span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a>    PFILE <span class="op">=</span> entry_pfile.get().strip().upper()</span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a>    PNUMBER <span class="op">=</span> entry_pnumber.get().strip().upper()</span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a>    TREVIEW <span class="op">=</span> entry_treview.get().strip().upper()</span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a>    MappingPacketType <span class="op">=</span> combobox_mappingpackettype.get().strip().upper()</span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a>    Initials <span class="op">=</span> entry_initials.get().strip().upper()</span>
<span id="cb39-129"><a href="#cb39-129" aria-hidden="true" tabindex="-1"></a>    ForYear <span class="op">=</span> for_year_combobox.get().strip()  <span class="co"># Get the selected year</span></span>
<span id="cb39-130"><a href="#cb39-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a>    the_month <span class="op">=</span> datetime.now().month</span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a>    the_day <span class="op">=</span> datetime.now().day</span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a>    the_year <span class="op">=</span> datetime.now().year</span>
<span id="cb39-134"><a href="#cb39-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-135"><a href="#cb39-135" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_month = datetime.datetime.now().month</span></span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_day = datetime.datetime.now().day</span></span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_year = datetime.datetime.now().year</span></span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a>    AINFROM_str <span class="op">=</span> <span class="st">', '</span>.join(AINFROM)</span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a>    AINTO_str <span class="op">=</span> <span class="st">', '</span>.join(AINTO)</span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a>    MemoTXT <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>Initials<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>the_month<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">str</span>(the_year)[<span class="op">-</span><span class="dv">2</span>:]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>MappingPacketType<span class="sc">}</span><span class="ss"> from </span><span class="sc">{</span>AINFROM_str<span class="sc">}</span><span class="ss"> into </span><span class="sc">{</span>AINTO_str<span class="sc">}</span><span class="ss"> for </span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Generated MemoTXT: </span><span class="sc">{</span>MemoTXT<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a>    PDESC <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>MappingPacketType<span class="sc">}</span><span class="ss"> for </span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb39-145"><a href="#cb39-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-146"><a href="#cb39-146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> AINLIST <span class="kw">or</span> <span class="kw">not</span> PFILE <span class="kw">or</span> <span class="kw">not</span> PNUMBER <span class="kw">or</span> <span class="kw">not</span> TREVIEW <span class="kw">or</span> <span class="kw">not</span> MappingPacketType <span class="kw">or</span> <span class="kw">not</span> Initials <span class="kw">or</span> <span class="kw">not</span> MemoTXT <span class="kw">or</span> <span class="kw">not</span> PDESC:</span>
<span id="cb39-147"><a href="#cb39-147" aria-hidden="true" tabindex="-1"></a>        messagebox.showerror(<span class="st">"Input Error"</span>, <span class="st">"All input fields are required."</span>)</span>
<span id="cb39-148"><a href="#cb39-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb39-149"><a href="#cb39-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-150"><a href="#cb39-150" aria-hidden="true" tabindex="-1"></a>    root.destroy()  <span class="co"># Close the GUI</span></span>
<span id="cb39-151"><a href="#cb39-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-152"><a href="#cb39-152" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup_gui():</span>
<span id="cb39-153"><a href="#cb39-153" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> tk.Tk()</span>
<span id="cb39-154"><a href="#cb39-154" aria-hidden="true" tabindex="-1"></a>    root.title(<span class="st">"User Input Form"</span>)</span>
<span id="cb39-155"><a href="#cb39-155" aria-hidden="true" tabindex="-1"></a>    setup_widgets(root)</span>
<span id="cb39-156"><a href="#cb39-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> root</span>
<span id="cb39-157"><a href="#cb39-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-158"><a href="#cb39-158" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_initials(action, value_if_allowed):</span>
<span id="cb39-159"><a href="#cb39-159" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Allow only alphabetic characters and limit to 3 characters</span></span>
<span id="cb39-160"><a href="#cb39-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> action <span class="op">==</span> <span class="st">'1'</span>:  <span class="co"># 1 means an insertion operation</span></span>
<span id="cb39-161"><a href="#cb39-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(value_if_allowed) <span class="op">&gt;</span> <span class="dv">3</span>:</span>
<span id="cb39-162"><a href="#cb39-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-163"><a href="#cb39-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> value_if_allowed.isalpha()</span>
<span id="cb39-164"><a href="#cb39-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb39-165"><a href="#cb39-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-166"><a href="#cb39-166" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup_widgets(root):</span>
<span id="cb39-167"><a href="#cb39-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> entry_ainfrom, entry_ainto, entry_pfile, entry_pnumber, entry_treview, combobox_mappingpackettype, entry_initials, for_year_combobox</span>
<span id="cb39-168"><a href="#cb39-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-169"><a href="#cb39-169" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the current and next year</span></span>
<span id="cb39-170"><a href="#cb39-170" aria-hidden="true" tabindex="-1"></a>    current_year <span class="op">=</span> datetime.now().year</span>
<span id="cb39-171"><a href="#cb39-171" aria-hidden="true" tabindex="-1"></a>    next_year <span class="op">=</span> current_year <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb39-172"><a href="#cb39-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-173"><a href="#cb39-173" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Mapping packet FOR what year?:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-174"><a href="#cb39-174" aria-hidden="true" tabindex="-1"></a>    for_year_combobox <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>[current_year, next_year], width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb39-175"><a href="#cb39-175" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-176"><a href="#cb39-176" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the current year</span></span>
<span id="cb39-177"><a href="#cb39-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-178"><a href="#cb39-178" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AINFROM input</span></span>
<span id="cb39-179"><a href="#cb39-179" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"List AINs FROM (separated by comma):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">0</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-180"><a href="#cb39-180" aria-hidden="true" tabindex="-1"></a>    entry_ainfrom <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb39-181"><a href="#cb39-181" aria-hidden="true" tabindex="-1"></a>    entry_ainfrom.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">0</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-182"><a href="#cb39-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-183"><a href="#cb39-183" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AINTO input</span></span>
<span id="cb39-184"><a href="#cb39-184" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"List AINs TO (separated by comma):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-185"><a href="#cb39-185" aria-hidden="true" tabindex="-1"></a>    entry_ainto <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb39-186"><a href="#cb39-186" aria-hidden="true" tabindex="-1"></a>    entry_ainto.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-187"><a href="#cb39-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-188"><a href="#cb39-188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Existing fields continue below...</span></span>
<span id="cb39-189"><a href="#cb39-189" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Mapping packet FOR what year?:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">2</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-190"><a href="#cb39-190" aria-hidden="true" tabindex="-1"></a>    for_year_combobox <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>[current_year, next_year], width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb39-191"><a href="#cb39-191" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">2</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-192"><a href="#cb39-192" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the current year</span></span>
<span id="cb39-193"><a href="#cb39-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-194"><a href="#cb39-194" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Filing Date (Top Date):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">3</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-195"><a href="#cb39-195" aria-hidden="true" tabindex="-1"></a>    entry_pfile <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb39-196"><a href="#cb39-196" aria-hidden="true" tabindex="-1"></a>    entry_pfile.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">3</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-197"><a href="#cb39-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-198"><a href="#cb39-198" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Permit Number (Bottom Date):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">4</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-199"><a href="#cb39-199" aria-hidden="true" tabindex="-1"></a>    entry_pnumber <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb39-200"><a href="#cb39-200" aria-hidden="true" tabindex="-1"></a>    entry_pnumber.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">4</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-201"><a href="#cb39-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-202"><a href="#cb39-202" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Timber or AG review? Y/N:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">5</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-203"><a href="#cb39-203" aria-hidden="true" tabindex="-1"></a>    entry_treview <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb39-204"><a href="#cb39-204" aria-hidden="true" tabindex="-1"></a>    entry_treview.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">5</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-205"><a href="#cb39-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-206"><a href="#cb39-206" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Select Mapping Packet Type:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">6</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-207"><a href="#cb39-207" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-208"><a href="#cb39-208" aria-hidden="true" tabindex="-1"></a>    mapping_packet_types <span class="op">=</span> [</span>
<span id="cb39-209"><a href="#cb39-209" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MERGE"</span>, <span class="st">"SPLIT"</span>, <span class="st">"BLA"</span>, <span class="st">"LLA"</span>, <span class="st">"RW VACATION"</span>, <span class="st">"RW SPLIT"</span>, <span class="st">"REDESCRIBE"</span>,</span>
<span id="cb39-210"><a href="#cb39-210" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RW AUDIT"</span>, <span class="st">"RW Cat19"</span>, <span class="st">"AIRPORT LEASE NEW PARCEL"</span>, <span class="st">"PLAT VACATION"</span>,</span>
<span id="cb39-211"><a href="#cb39-211" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PARCEL DELETED"</span>, <span class="st">"ACERAGE AUDIT"</span>, <span class="st">"NEW PLAT"</span></span>
<span id="cb39-212"><a href="#cb39-212" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb39-213"><a href="#cb39-213" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>mapping_packet_types, width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb39-214"><a href="#cb39-214" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">6</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-215"><a href="#cb39-215" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the first item</span></span>
<span id="cb39-216"><a href="#cb39-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-217"><a href="#cb39-217" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validation for the Initials Entry</span></span>
<span id="cb39-218"><a href="#cb39-218" aria-hidden="true" tabindex="-1"></a>    vcmd <span class="op">=</span> (root.register(validate_initials), <span class="st">'</span><span class="sc">%d</span><span class="st">'</span>, <span class="st">'%P'</span>)</span>
<span id="cb39-219"><a href="#cb39-219" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-220"><a href="#cb39-220" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Enter (3) Initials:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">7</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-221"><a href="#cb39-221" aria-hidden="true" tabindex="-1"></a>    entry_initials <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>, validate<span class="op">=</span><span class="st">'key'</span>, validatecommand<span class="op">=</span>vcmd)</span>
<span id="cb39-222"><a href="#cb39-222" aria-hidden="true" tabindex="-1"></a>    entry_initials.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">7</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-223"><a href="#cb39-223" aria-hidden="true" tabindex="-1"></a>    entry_initials.insert(<span class="dv">0</span>, <span class="st">"DGW"</span>)</span>
<span id="cb39-224"><a href="#cb39-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-225"><a href="#cb39-225" aria-hidden="true" tabindex="-1"></a>    submit_button <span class="op">=</span> ttk.Button(root, text<span class="op">=</span><span class="st">"Submit"</span>, command<span class="op">=</span>on_submit)</span>
<span id="cb39-226"><a href="#cb39-226" aria-hidden="true" tabindex="-1"></a>    submit_button.grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">8</span>, columnspan<span class="op">=</span><span class="dv">2</span>, pady<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb39-227"><a href="#cb39-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-228"><a href="#cb39-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-229"><a href="#cb39-229" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> setup_gui()</span>
<span id="cb39-230"><a href="#cb39-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-231"><a href="#cb39-231" aria-hidden="true" tabindex="-1"></a><span class="co">### Graphic User Interface (GUI) Logic - </span><span class="re">END</span></span>
<span id="cb39-232"><a href="#cb39-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-233"><a href="#cb39-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-234"><a href="#cb39-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-235"><a href="#cb39-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-236"><a href="#cb39-236" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-237"><a href="#cb39-237" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL LOGICS - LOGIC FUNCTIONS</span></span>
<span id="cb39-238"><a href="#cb39-238" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-239"><a href="#cb39-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-240"><a href="#cb39-240" aria-hidden="true" tabindex="-1"></a><span class="co">#### CAPS LOCK</span></span>
<span id="cb39-241"><a href="#cb39-241" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_capslock_on():</span>
<span id="cb39-242"><a href="#cb39-242" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This will return 1 if CAPS LOCK is on, 0 if it's off</span></span>
<span id="cb39-243"><a href="#cb39-243" aria-hidden="true" tabindex="-1"></a>    hllDll <span class="op">=</span> ctypes.WinDLL(<span class="st">"User32.dll"</span>)</span>
<span id="cb39-244"><a href="#cb39-244" aria-hidden="true" tabindex="-1"></a>    VK_CAPITAL <span class="op">=</span> <span class="bn">0x14</span></span>
<span id="cb39-245"><a href="#cb39-245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hllDll.GetKeyState(VK_CAPITAL) <span class="op">&amp;</span> <span class="dv">1</span></span>
<span id="cb39-246"><a href="#cb39-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-247"><a href="#cb39-247" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ensure_capslock_off():</span>
<span id="cb39-248"><a href="#cb39-248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_capslock_on():</span>
<span id="cb39-249"><a href="#cb39-249" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'capslock'</span>)</span>
<span id="cb39-250"><a href="#cb39-250" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"CAPS LOCK was on. It has been turned off."</span>)</span>
<span id="cb39-251"><a href="#cb39-251" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-252"><a href="#cb39-252" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"CAPS LOCK is already off."</span>)</span>
<span id="cb39-253"><a href="#cb39-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-254"><a href="#cb39-254" aria-hidden="true" tabindex="-1"></a><span class="co">#### SET FOCUS</span></span>
<span id="cb39-255"><a href="#cb39-255" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_focus_and_type(window_title, keys):</span>
<span id="cb39-256"><a href="#cb39-256" aria-hidden="true" tabindex="-1"></a>    window <span class="op">=</span> pyautogui.getWindowsWithTitle(window_title)</span>
<span id="cb39-257"><a href="#cb39-257" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> window:</span>
<span id="cb39-258"><a href="#cb39-258" aria-hidden="true" tabindex="-1"></a>        window[<span class="dv">0</span>].activate()</span>
<span id="cb39-259"><a href="#cb39-259" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(keys)</span>
<span id="cb39-260"><a href="#cb39-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-261"><a href="#cb39-261" aria-hidden="true" tabindex="-1"></a><span class="co">#### PRESS &amp; CLICK KEY LOGIC</span></span>
<span id="cb39-262"><a href="#cb39-262" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_with_modifier_multiple_times(modifier, key, times):</span>
<span id="cb39-263"><a href="#cb39-263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb39-264"><a href="#cb39-264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-265"><a href="#cb39-265" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-266"><a href="#cb39-266" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-267"><a href="#cb39-267" aria-hidden="true" tabindex="-1"></a>        pyautogui.hotkey(modifier, key)</span>
<span id="cb39-268"><a href="#cb39-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-269"><a href="#cb39-269" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_multiple_times(key, times):</span>
<span id="cb39-270"><a href="#cb39-270" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb39-271"><a href="#cb39-271" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-272"><a href="#cb39-272" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-273"><a href="#cb39-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-274"><a href="#cb39-274" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(key)</span>
<span id="cb39-275"><a href="#cb39-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-276"><a href="#cb39-276" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> triple_click(x, y):</span>
<span id="cb39-277"><a href="#cb39-277" aria-hidden="true" tabindex="-1"></a>    pyautogui.click(x, y, clicks<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb39-278"><a href="#cb39-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-279"><a href="#cb39-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-280"><a href="#cb39-280" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-281"><a href="#cb39-281" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL LOGICS - SCREEN HANDLING FUNCTIONS</span></span>
<span id="cb39-282"><a href="#cb39-282" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-283"><a href="#cb39-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-284"><a href="#cb39-284" aria-hidden="true" tabindex="-1"></a><span class="co">### Connections: OCR and Image Paths</span></span>
<span id="cb39-285"><a href="#cb39-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-286"><a href="#cb39-286" aria-hidden="true" tabindex="-1"></a><span class="co">#### OCR</span></span>
<span id="cb39-287"><a href="#cb39-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-288"><a href="#cb39-288" aria-hidden="true" tabindex="-1"></a><span class="co"># This OCR program is required to work with this script, it is available on GitHub</span></span>
<span id="cb39-289"><a href="#cb39-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the tesseract executable path if not in the system path</span></span>
<span id="cb39-290"><a href="#cb39-290" aria-hidden="true" tabindex="-1"></a><span class="co"># Update this path as necessary by user you will need to download and install tesseract from GitHub</span></span>
<span id="cb39-291"><a href="#cb39-291" aria-hidden="true" tabindex="-1"></a><span class="co"># Link https://github.com/tesseract-ocr/tesseract</span></span>
<span id="cb39-292"><a href="#cb39-292" aria-hidden="true" tabindex="-1"></a><span class="co"># Link https://github.com/UB-Mannheim/tesseract/wiki</span></span>
<span id="cb39-293"><a href="#cb39-293" aria-hidden="true" tabindex="-1"></a>pytesseract.pytesseract.tesseract_cmd <span class="op">=</span> <span class="vs">r'C:\Users\dwolfe\AppData\Local\Programs\Tesseract-OCR\tesseract.exe'</span></span>
<span id="cb39-294"><a href="#cb39-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-295"><a href="#cb39-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-296"><a href="#cb39-296" aria-hidden="true" tabindex="-1"></a><span class="co">#### Image Paths - Active and Inactive</span></span>
<span id="cb39-297"><a href="#cb39-297" aria-hidden="true" tabindex="-1"></a>land_tab_images <span class="op">=</span> [</span>
<span id="cb39-298"><a href="#cb39-298" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_tab.PNG'</span>,</span>
<span id="cb39-299"><a href="#cb39-299" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_tab_active.PNG'</span></span>
<span id="cb39-300"><a href="#cb39-300" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-301"><a href="#cb39-301" aria-hidden="true" tabindex="-1"></a>land_base_tab_images <span class="op">=</span> [</span>
<span id="cb39-302"><a href="#cb39-302" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_base_tab.PNG'</span>,</span>
<span id="cb39-303"><a href="#cb39-303" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_base_tab_active.PNG'</span></span>
<span id="cb39-304"><a href="#cb39-304" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-305"><a href="#cb39-305" aria-hidden="true" tabindex="-1"></a>permits_tab_images <span class="op">=</span> [</span>
<span id="cb39-306"><a href="#cb39-306" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_tab.PNG'</span>,</span>
<span id="cb39-307"><a href="#cb39-307" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_tab_active.PNG'</span></span>
<span id="cb39-308"><a href="#cb39-308" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-309"><a href="#cb39-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-310"><a href="#cb39-310" aria-hidden="true" tabindex="-1"></a>permits_add_permit_button <span class="op">=</span> [</span>
<span id="cb39-311"><a href="#cb39-311" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_permit_button.PNG'</span>,</span>
<span id="cb39-312"><a href="#cb39-312" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_permit_button_active.PNG'</span></span>
<span id="cb39-313"><a href="#cb39-313" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-314"><a href="#cb39-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-315"><a href="#cb39-315" aria-hidden="true" tabindex="-1"></a><span class="co">#### Image Paths - Single Images Only</span></span>
<span id="cb39-316"><a href="#cb39-316" aria-hidden="true" tabindex="-1"></a>duplicate_memo_image_path <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_memo_duplicate.PNG'</span></span>
<span id="cb39-317"><a href="#cb39-317" aria-hidden="true" tabindex="-1"></a>add_field_visit_image_path <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_fieldvisit_button.PNG'</span></span>
<span id="cb39-318"><a href="#cb39-318" aria-hidden="true" tabindex="-1"></a>aggregate_land_type_add_button <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_aggregate_land_type_add_button.PNG'</span></span>
<span id="cb39-319"><a href="#cb39-319" aria-hidden="true" tabindex="-1"></a>farm_total_acres_image <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_farm_total_acres.PNG'</span></span>
<span id="cb39-320"><a href="#cb39-320" aria-hidden="true" tabindex="-1"></a>permit_description <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permit_description.PNG'</span></span>
<span id="cb39-321"><a href="#cb39-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-322"><a href="#cb39-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-323"><a href="#cb39-323" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 CAPTURE SCREEN IN GREYSCALE</span></span>
<span id="cb39-324"><a href="#cb39-324" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> capture_and_convert_screenshot():</span>
<span id="cb39-325"><a href="#cb39-325" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Capture the screenshot using pyautogui</span></span>
<span id="cb39-326"><a href="#cb39-326" aria-hidden="true" tabindex="-1"></a>    screenshot <span class="op">=</span> pyautogui.screenshot()</span>
<span id="cb39-327"><a href="#cb39-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-328"><a href="#cb39-328" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the screenshot to a numpy array, then to BGR, and finally to greyscale</span></span>
<span id="cb39-329"><a href="#cb39-329" aria-hidden="true" tabindex="-1"></a>    screenshot_np <span class="op">=</span> np.array(screenshot)</span>
<span id="cb39-330"><a href="#cb39-330" aria-hidden="true" tabindex="-1"></a>    screenshot_np <span class="op">=</span> cv2.cvtColor(screenshot_np, cv2.COLOR_RGB2BGR)</span>
<span id="cb39-331"><a href="#cb39-331" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> cv2.cvtColor(screenshot_np, cv2.COLOR_BGR2GRAY)</span>
<span id="cb39-332"><a href="#cb39-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-333"><a href="#cb39-333" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grey_screenshot</span>
<span id="cb39-334"><a href="#cb39-334" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 CLICK USING A REFERENCE GREYSCALE SCREENSHOT TO A STORED GREYSCALE IMAGE INCLUDES ABILITY TO CLICK RELATIVE POSITION</span></span>
<span id="cb39-335"><a href="#cb39-335" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_on_image(image_path, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">10</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-336"><a href="#cb39-336" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb39-337"><a href="#cb39-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-338"><a href="#cb39-338" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the reference image in greyscale</span></span>
<span id="cb39-339"><a href="#cb39-339" aria-hidden="true" tabindex="-1"></a>    ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb39-340"><a href="#cb39-340" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ref_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb39-341"><a href="#cb39-341" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to load reference image from </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-342"><a href="#cb39-342" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-343"><a href="#cb39-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-344"><a href="#cb39-344" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb39-345"><a href="#cb39-345" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cv2.matchTemplate(grey_screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb39-346"><a href="#cb39-346" aria-hidden="true" tabindex="-1"></a>    _, max_val, _, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb39-347"><a href="#cb39-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-348"><a href="#cb39-348" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence:</span>
<span id="cb39-349"><a href="#cb39-349" aria-hidden="true" tabindex="-1"></a>        top_left <span class="op">=</span> max_loc</span>
<span id="cb39-350"><a href="#cb39-350" aria-hidden="true" tabindex="-1"></a>        h, w <span class="op">=</span> ref_image.shape</span>
<span id="cb39-351"><a href="#cb39-351" aria-hidden="true" tabindex="-1"></a>        right <span class="op">=</span> top_left[<span class="dv">0</span>] <span class="op">+</span> w</span>
<span id="cb39-352"><a href="#cb39-352" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> top_left[<span class="dv">1</span>] <span class="op">+</span> h</span>
<span id="cb39-353"><a href="#cb39-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-354"><a href="#cb39-354" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate click position based on direction and inset/offset</span></span>
<span id="cb39-355"><a href="#cb39-355" aria-hidden="true" tabindex="-1"></a>        click_positions <span class="op">=</span> {</span>
<span id="cb39-356"><a href="#cb39-356" aria-hidden="true" tabindex="-1"></a>            <span class="st">'right'</span>: (right <span class="op">+</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb39-357"><a href="#cb39-357" aria-hidden="true" tabindex="-1"></a>            <span class="st">'left'</span>: (top_left[<span class="dv">0</span>] <span class="op">-</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb39-358"><a href="#cb39-358" aria-hidden="true" tabindex="-1"></a>            <span class="st">'above'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">-</span> offset),</span>
<span id="cb39-359"><a href="#cb39-359" aria-hidden="true" tabindex="-1"></a>            <span class="st">'below'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">+</span> offset),</span>
<span id="cb39-360"><a href="#cb39-360" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_right_corner'</span>: (right <span class="op">-</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb39-361"><a href="#cb39-361" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb39-362"><a href="#cb39-362" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_right_corner'</span>: (right <span class="op">-</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb39-363"><a href="#cb39-363" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb39-364"><a href="#cb39-364" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">-</span> inset),</span>
<span id="cb39-365"><a href="#cb39-365" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb39-366"><a href="#cb39-366" aria-hidden="true" tabindex="-1"></a>            <span class="st">'center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb39-367"><a href="#cb39-367" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb39-368"><a href="#cb39-368" aria-hidden="true" tabindex="-1"></a>        click_x, click_y <span class="op">=</span> click_positions[direction]</span>
<span id="cb39-369"><a href="#cb39-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-370"><a href="#cb39-370" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform the click</span></span>
<span id="cb39-371"><a href="#cb39-371" aria-hidden="true" tabindex="-1"></a>        pyautogui.click(click_x, click_y)</span>
<span id="cb39-372"><a href="#cb39-372" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of the image at (</span><span class="sc">{</span>click_x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>click_y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb39-373"><a href="#cb39-373" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb39-374"><a href="#cb39-374" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-375"><a href="#cb39-375" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="ss">f"No good match found at the confidence level of </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb39-376"><a href="#cb39-376" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-377"><a href="#cb39-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-378"><a href="#cb39-378" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb39-379"><a href="#cb39-379" aria-hidden="true" tabindex="-1"></a><span class="co">        # Ref Function click_on_image in the following functions 3, 4, 5, etc... </span></span>
<span id="cb39-380"><a href="#cb39-380" aria-hidden="true" tabindex="-1"></a><span class="co">        # These reference functions can be called in the final automation script </span></span>
<span id="cb39-381"><a href="#cb39-381" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb39-382"><a href="#cb39-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-383"><a href="#cb39-383" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 USING click_on_image FUNCTION</span></span>
<span id="cb39-384"><a href="#cb39-384" aria-hidden="true" tabindex="-1"></a><span class="co">#Specific Click Functions Here, See click_on_image for directionals, and image pathes for images</span></span>
<span id="cb39-385"><a href="#cb39-385" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_images_multiple(paths, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">50</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.75</span>):</span>
<span id="cb39-386"><a href="#cb39-386" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image_path <span class="kw">in</span> paths:</span>
<span id="cb39-387"><a href="#cb39-387" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Trying to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> on image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-388"><a href="#cb39-388" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_on_image(image_path, direction<span class="op">=</span>direction, offset<span class="op">=</span>offset, inset<span class="op">=</span>inset, confidence<span class="op">=</span>confidence):</span>
<span id="cb39-389"><a href="#cb39-389" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Successfully clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb39-390"><a href="#cb39-390" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb39-391"><a href="#cb39-391" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb39-392"><a href="#cb39-392" aria-hidden="true" tabindex="-1"></a>            logging.warning(<span class="ss">f"Failed to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb39-393"><a href="#cb39-393" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-394"><a href="#cb39-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-395"><a href="#cb39-395" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_image_single(image_path, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">50</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.75</span>):</span>
<span id="cb39-396"><a href="#cb39-396" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Trying to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> on image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-397"><a href="#cb39-397" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_on_image(image_path, direction<span class="op">=</span>direction, offset<span class="op">=</span>offset, inset<span class="op">=</span>inset, confidence<span class="op">=</span>confidence):</span>
<span id="cb39-398"><a href="#cb39-398" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Successfully clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb39-399"><a href="#cb39-399" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb39-400"><a href="#cb39-400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-401"><a href="#cb39-401" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="ss">f"Failed to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb39-402"><a href="#cb39-402" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-403"><a href="#cb39-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-404"><a href="#cb39-404" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-405"><a href="#cb39-405" aria-hidden="true" tabindex="-1"></a><span class="co">    # How to use these click_images_multiple &amp; click_image_single functions in script</span></span>
<span id="cb39-406"><a href="#cb39-406" aria-hidden="true" tabindex="-1"></a><span class="co"> </span></span>
<span id="cb39-407"><a href="#cb39-407" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click below all specified images</span></span>
<span id="cb39-408"><a href="#cb39-408" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_images_multiple(multiple_image_path_name_here, direction='below', offset=100, confidence=0.8):</span></span>
<span id="cb39-409"><a href="#cb39-409" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully.")</span></span>
<span id="cb39-410"><a href="#cb39-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-411"><a href="#cb39-411" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click at the center of a single image</span></span>
<span id="cb39-412"><a href="#cb39-412" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_image_single(single_image_path_name_here, direction='center', confidence=0.8):</span></span>
<span id="cb39-413"><a href="#cb39-413" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully.")</span></span>
<span id="cb39-414"><a href="#cb39-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-415"><a href="#cb39-415" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click at the bottom right corner of a single image</span></span>
<span id="cb39-416"><a href="#cb39-416" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_image_single(single_image_path_name_here, direction='bottom_right_corner', inset=10, confidence=0.8):</span></span>
<span id="cb39-417"><a href="#cb39-417" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully.")</span></span>
<span id="cb39-418"><a href="#cb39-418" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb39-419"><a href="#cb39-419" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click to right of permit_description, by calling offset=5 it was just barely below the image, which is what I wanted</span></span>
<span id="cb39-420"><a href="#cb39-420" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_image_single(permit_description, direction='below', offset=5, confidence=0.8):</span></span>
<span id="cb39-421"><a href="#cb39-421" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully permit_description.")</span></span>
<span id="cb39-422"><a href="#cb39-422" aria-hidden="true" tabindex="-1"></a><span class="co">    time.sleep(1)</span></span>
<span id="cb39-423"><a href="#cb39-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-424"><a href="#cb39-424" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-425"><a href="#cb39-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-426"><a href="#cb39-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-427"><a href="#cb39-427" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 CHECKING IF IMAGE IS PRESENT</span></span>
<span id="cb39-428"><a href="#cb39-428" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_image_found(image_path, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-429"><a href="#cb39-429" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-430"><a href="#cb39-430" aria-hidden="true" tabindex="-1"></a><span class="co">    Check if an image is present on the screen with a specified confidence level.</span></span>
<span id="cb39-431"><a href="#cb39-431" aria-hidden="true" tabindex="-1"></a><span class="co">    :param image_path: Path to the image file to be checked.</span></span>
<span id="cb39-432"><a href="#cb39-432" aria-hidden="true" tabindex="-1"></a><span class="co">    :param confidence: The confidence level for the image matching.</span></span>
<span id="cb39-433"><a href="#cb39-433" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: bool - True if image is found, False otherwise.</span></span>
<span id="cb39-434"><a href="#cb39-434" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-435"><a href="#cb39-435" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the existing function to capture and convert the screenshot</span></span>
<span id="cb39-436"><a href="#cb39-436" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb39-437"><a href="#cb39-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-438"><a href="#cb39-438" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the reference image in greyscale</span></span>
<span id="cb39-439"><a href="#cb39-439" aria-hidden="true" tabindex="-1"></a>    ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb39-440"><a href="#cb39-440" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ref_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb39-441"><a href="#cb39-441" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to load reference image from </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-442"><a href="#cb39-442" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-443"><a href="#cb39-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-444"><a href="#cb39-444" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb39-445"><a href="#cb39-445" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cv2.matchTemplate(grey_screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb39-446"><a href="#cb39-446" aria-hidden="true" tabindex="-1"></a>    _, max_val, _, _ <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb39-447"><a href="#cb39-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-448"><a href="#cb39-448" aria-hidden="true" tabindex="-1"></a>    found <span class="op">=</span> max_val <span class="op">&gt;=</span> confidence</span>
<span id="cb39-449"><a href="#cb39-449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> found:</span>
<span id="cb39-450"><a href="#cb39-450" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Image found with confidence </span><span class="sc">{</span>max_val<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-451"><a href="#cb39-451" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-452"><a href="#cb39-452" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Image not found with sufficient confidence </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-453"><a href="#cb39-453" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-454"><a href="#cb39-454" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> found</span>
<span id="cb39-455"><a href="#cb39-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-456"><a href="#cb39-456" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-457"><a href="#cb39-457" aria-hidden="true" tabindex="-1"></a><span class="co">    # How to use the is_image_found function below in script:</span></span>
<span id="cb39-458"><a href="#cb39-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-459"><a href="#cb39-459" aria-hidden="true" tabindex="-1"></a><span class="co">    # Check if the image is found and decide based on that</span></span>
<span id="cb39-460"><a href="#cb39-460" aria-hidden="true" tabindex="-1"></a><span class="co">    if is_image_found(image_path_name_here, confidence=0.8):</span></span>
<span id="cb39-461"><a href="#cb39-461" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Image was found - executing related tasks.")</span></span>
<span id="cb39-462"><a href="#cb39-462" aria-hidden="true" tabindex="-1"></a><span class="co">        # Perform tasks related to the image being found</span></span>
<span id="cb39-463"><a href="#cb39-463" aria-hidden="true" tabindex="-1"></a><span class="co">    else:</span></span>
<span id="cb39-464"><a href="#cb39-464" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Image was not found - executing alternative tasks.")</span></span>
<span id="cb39-465"><a href="#cb39-465" aria-hidden="true" tabindex="-1"></a><span class="co">        # Perform alternative tasks</span></span>
<span id="cb39-466"><a href="#cb39-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-467"><a href="#cb39-467" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-468"><a href="#cb39-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-469"><a href="#cb39-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-470"><a href="#cb39-470" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 READ TEXT FROM SCREEN</span></span>
<span id="cb39-471"><a href="#cb39-471" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_for_text_on_screen(target_text):</span>
<span id="cb39-472"><a href="#cb39-472" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-473"><a href="#cb39-473" aria-hidden="true" tabindex="-1"></a><span class="co">    Captures the screen, converts it to greyscale, performs OCR, and checks for the specified text.</span></span>
<span id="cb39-474"><a href="#cb39-474" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb39-475"><a href="#cb39-475" aria-hidden="true" tabindex="-1"></a><span class="co">    :param target_text: Text to search for in the OCR results.</span></span>
<span id="cb39-476"><a href="#cb39-476" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: True if the text is found, False otherwise.</span></span>
<span id="cb39-477"><a href="#cb39-477" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-478"><a href="#cb39-478" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb39-479"><a href="#cb39-479" aria-hidden="true" tabindex="-1"></a>    grey_screenshot_pil <span class="op">=</span> Image.fromarray(grey_screenshot)  <span class="co"># Convert numpy array back to a PIL Image</span></span>
<span id="cb39-480"><a href="#cb39-480" aria-hidden="true" tabindex="-1"></a>    screen_text <span class="op">=</span> pytesseract.image_to_string(grey_screenshot_pil)</span>
<span id="cb39-481"><a href="#cb39-481" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> target_text <span class="kw">in</span> screen_text</span>
<span id="cb39-482"><a href="#cb39-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-483"><a href="#cb39-483" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-484"><a href="#cb39-484" aria-hidden="true" tabindex="-1"></a><span class="co">    # How to use the check_for_text_on_screen function below in script:</span></span>
<span id="cb39-485"><a href="#cb39-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-486"><a href="#cb39-486" aria-hidden="true" tabindex="-1"></a><span class="co">    # Define the specific text you're looking for</span></span>
<span id="cb39-487"><a href="#cb39-487" aria-hidden="true" tabindex="-1"></a><span class="co">    specific_text = "text_you_want_to_check_here"</span></span>
<span id="cb39-488"><a href="#cb39-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-489"><a href="#cb39-489" aria-hidden="true" tabindex="-1"></a><span class="co">    # Use the variable in your function call and print statements</span></span>
<span id="cb39-490"><a href="#cb39-490" aria-hidden="true" tabindex="-1"></a><span class="co">    if check_for_text_on_screen(specific_text):</span></span>
<span id="cb39-491"><a href="#cb39-491" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info(f"Found '{specific_text}' on the screen.")</span></span>
<span id="cb39-492"><a href="#cb39-492" aria-hidden="true" tabindex="-1"></a><span class="co">    else:</span></span>
<span id="cb39-493"><a href="#cb39-493" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info(f"Did not find '{specific_text}' on the screen.")</span></span>
<span id="cb39-494"><a href="#cb39-494" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-495"><a href="#cb39-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-496"><a href="#cb39-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-497"><a href="#cb39-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-498"><a href="#cb39-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-499"><a href="#cb39-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-500"><a href="#cb39-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-501"><a href="#cb39-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-502"><a href="#cb39-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-503"><a href="#cb39-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-504"><a href="#cb39-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-505"><a href="#cb39-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-506"><a href="#cb39-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-507"><a href="#cb39-507" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-508"><a href="#cb39-508" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the GUI event loop</span></span>
<span id="cb39-509"><a href="#cb39-509" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-510"><a href="#cb39-510" aria-hidden="true" tabindex="-1"></a>root.mainloop()</span>
<span id="cb39-511"><a href="#cb39-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-512"><a href="#cb39-512" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> AINLIST <span class="kw">or</span> <span class="kw">not</span> MemoTXT <span class="kw">or</span> <span class="kw">not</span> PDESC <span class="kw">or</span> <span class="kw">not</span> PFILE <span class="kw">or</span> <span class="kw">not</span> PNUMBER <span class="kw">or</span> <span class="kw">not</span> TREVIEW:</span>
<span id="cb39-513"><a href="#cb39-513" aria-hidden="true" tabindex="-1"></a>    logging.error(<span class="st">"All input fields are required."</span>)</span>
<span id="cb39-514"><a href="#cb39-514" aria-hidden="true" tabindex="-1"></a>    exit()</span>
<span id="cb39-515"><a href="#cb39-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-516"><a href="#cb39-516" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-517"><a href="#cb39-517" aria-hidden="true" tabindex="-1"></a><span class="co">Connect to the database, </span></span>
<span id="cb39-518"><a href="#cb39-518" aria-hidden="true" tabindex="-1"></a><span class="co">pull a simple SQL query with two columns,</span></span>
<span id="cb39-519"><a href="#cb39-519" aria-hidden="true" tabindex="-1"></a><span class="co">then the  for row in rows assigns those columns as variables </span></span>
<span id="cb39-520"><a href="#cb39-520" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-521"><a href="#cb39-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-522"><a href="#cb39-522" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> connect_to_database(db_connection_string)</span>
<span id="cb39-523"><a href="#cb39-523" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> conn.cursor()</span>
<span id="cb39-524"><a href="#cb39-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-525"><a href="#cb39-525" aria-hidden="true" tabindex="-1"></a><span class="co"># The query should accommodate multiple AINs in a list</span></span>
<span id="cb39-526"><a href="#cb39-526" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="ss">f"SELECT TRIM(pm.AIN), pm.LegalAcres FROM TSBv_Parcelmaster AS pm WHERE pm.AIN IN (</span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(AINLIST)<span class="sc">}</span><span class="ss">)"</span></span>
<span id="cb39-527"><a href="#cb39-527" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> execute_query(cursor, query)</span>
<span id="cb39-528"><a href="#cb39-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-529"><a href="#cb39-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through each row in the results</span></span>
<span id="cb39-530"><a href="#cb39-530" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb39-531"><a href="#cb39-531" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-532"><a href="#cb39-532" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-533"><a href="#cb39-533" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-534"><a href="#cb39-534" aria-hidden="true" tabindex="-1"></a>    DBAIN, DBACRE <span class="op">=</span> row</span>
<span id="cb39-535"><a href="#cb39-535" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb39-536"><a href="#cb39-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-537"><a href="#cb39-537" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process each AIN individually</span></span>
<span id="cb39-538"><a href="#cb39-538" aria-hidden="true" tabindex="-1"></a>    set_focus_and_type(<span class="st">'ProVal'</span>, DBAIN)</span>
<span id="cb39-539"><a href="#cb39-539" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-540"><a href="#cb39-540" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"set_focus_and_type"</span>)</span>
<span id="cb39-541"><a href="#cb39-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-542"><a href="#cb39-542" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-543"><a href="#cb39-543" aria-hidden="true" tabindex="-1"></a><span class="co">    Officially begins the automation and screen navigation</span></span>
<span id="cb39-544"><a href="#cb39-544" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-545"><a href="#cb39-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-546"><a href="#cb39-546" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Open an AIN in ProVal</span></span>
<span id="cb39-547"><a href="#cb39-547" aria-hidden="true" tabindex="-1"></a>    set_focus_and_type(<span class="st">'ProVal'</span>, DBAIN)</span>
<span id="cb39-548"><a href="#cb39-548" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-549"><a href="#cb39-549" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"set_focus_and_type"</span>)</span>
<span id="cb39-550"><a href="#cb39-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-551"><a href="#cb39-551" aria-hidden="true" tabindex="-1"></a>    pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'o'</span>)</span>
<span id="cb39-552"><a href="#cb39-552" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-553"><a href="#cb39-553" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"hotkey"</span>)</span>
<span id="cb39-554"><a href="#cb39-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-555"><a href="#cb39-555" aria-hidden="true" tabindex="-1"></a>    press_key_multiple_times(<span class="st">'up'</span>, <span class="dv">12</span>)</span>
<span id="cb39-556"><a href="#cb39-556" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press_key_multiple_times"</span>)</span>
<span id="cb39-557"><a href="#cb39-557" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-558"><a href="#cb39-558" aria-hidden="true" tabindex="-1"></a>    press_key_multiple_times(<span class="st">'down'</span>, <span class="dv">4</span>)</span>
<span id="cb39-559"><a href="#cb39-559" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press_key_multiple_times"</span>)</span>
<span id="cb39-560"><a href="#cb39-560" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-561"><a href="#cb39-561" aria-hidden="true" tabindex="-1"></a>    pyautogui.press([<span class="st">'tab'</span>])</span>
<span id="cb39-562"><a href="#cb39-562" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press"</span>)</span>
<span id="cb39-563"><a href="#cb39-563" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-564"><a href="#cb39-564" aria-hidden="true" tabindex="-1"></a>    pyautogui.press([<span class="st">'delete'</span>])</span>
<span id="cb39-565"><a href="#cb39-565" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press"</span>)</span>
<span id="cb39-566"><a href="#cb39-566" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-567"><a href="#cb39-567" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="bu">str</span>(DBAIN))</span>
<span id="cb39-568"><a href="#cb39-568" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Sent AIN </span><span class="sc">{</span>DBAIN<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb39-569"><a href="#cb39-569" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-570"><a href="#cb39-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-571"><a href="#cb39-571" aria-hidden="true" tabindex="-1"></a>    pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb39-572"><a href="#cb39-572" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-573"><a href="#cb39-573" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"xxxxx"</span>)</span>
<span id="cb39-574"><a href="#cb39-574" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-575"><a href="#cb39-575" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-576"><a href="#cb39-576" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-577"><a href="#cb39-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-578"><a href="#cb39-578" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-579"><a href="#cb39-579" aria-hidden="true" tabindex="-1"></a><span class="co">    ## NOW </span><span class="re">BEGIN</span><span class="co"> AUTOMATION STEPS FOR THIS TOOL</span></span>
<span id="cb39-580"><a href="#cb39-580" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-581"><a href="#cb39-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-582"><a href="#cb39-582" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-583"><a href="#cb39-583" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Open Memos</span></span>
<span id="cb39-584"><a href="#cb39-584" aria-hidden="true" tabindex="-1"></a>    pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'shift'</span>, <span class="st">'m'</span>)</span>
<span id="cb39-585"><a href="#cb39-585" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-586"><a href="#cb39-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-587"><a href="#cb39-587" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Enter Land Memos</span></span>
<span id="cb39-588"><a href="#cb39-588" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CHECK IF LAND</span></span>
<span id="cb39-589"><a href="#cb39-589" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the specific text you're looking for</span></span>
<span id="cb39-590"><a href="#cb39-590" aria-hidden="true" tabindex="-1"></a>    specific_text <span class="op">=</span> <span class="st">"LAND"</span></span>
<span id="cb39-591"><a href="#cb39-591" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the variable in your function call and print statements</span></span>
<span id="cb39-592"><a href="#cb39-592" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> check_for_text_on_screen(specific_text):</span>
<span id="cb39-593"><a href="#cb39-593" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Found '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb39-594"><a href="#cb39-594" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-595"><a href="#cb39-595" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'l'</span>)</span>
<span id="cb39-596"><a href="#cb39-596" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb39-597"><a href="#cb39-597" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-598"><a href="#cb39-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-599"><a href="#cb39-599" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb39-600"><a href="#cb39-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-601"><a href="#cb39-601" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(MemoTXT)</span>
<span id="cb39-602"><a href="#cb39-602" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-603"><a href="#cb39-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-604"><a href="#cb39-604" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb39-605"><a href="#cb39-605" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-606"><a href="#cb39-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-607"><a href="#cb39-607" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-608"><a href="#cb39-608" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-609"><a href="#cb39-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-610"><a href="#cb39-610" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb39-611"><a href="#cb39-611" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-612"><a href="#cb39-612" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-613"><a href="#cb39-613" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Did not find '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb39-614"><a href="#cb39-614" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb39-615"><a href="#cb39-615" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-616"><a href="#cb39-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-617"><a href="#cb39-617" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'l'</span>)</span>
<span id="cb39-618"><a href="#cb39-618" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-619"><a href="#cb39-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-620"><a href="#cb39-620" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb39-621"><a href="#cb39-621" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-622"><a href="#cb39-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-623"><a href="#cb39-623" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb39-624"><a href="#cb39-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-625"><a href="#cb39-625" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(MemoTXT)</span>
<span id="cb39-626"><a href="#cb39-626" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-627"><a href="#cb39-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-628"><a href="#cb39-628" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-629"><a href="#cb39-629" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-630"><a href="#cb39-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-631"><a href="#cb39-631" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb39-632"><a href="#cb39-632" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-633"><a href="#cb39-633" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-634"><a href="#cb39-634" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-635"><a href="#cb39-635" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-636"><a href="#cb39-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-637"><a href="#cb39-637" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Enter Land Farm Acres</span></span>
<span id="cb39-638"><a href="#cb39-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-639"><a href="#cb39-639" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click Land_Tab</span></span>
<span id="cb39-640"><a href="#cb39-640" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_images_multiple(land_tab_images, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">100</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-641"><a href="#cb39-641" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully land_tab_images."</span>)</span>
<span id="cb39-642"><a href="#cb39-642" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-643"><a href="#cb39-643" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-644"><a href="#cb39-644" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-645"><a href="#cb39-645" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-646"><a href="#cb39-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-647"><a href="#cb39-647" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click Land_Base_Tab</span></span>
<span id="cb39-648"><a href="#cb39-648" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_images_multiple(land_base_tab_images, direction<span class="op">=</span><span class="st">'center'</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-649"><a href="#cb39-649" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully land_base_tab_images."</span>)</span>
<span id="cb39-650"><a href="#cb39-650" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-651"><a href="#cb39-651" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-652"><a href="#cb39-652" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-653"><a href="#cb39-653" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-654"><a href="#cb39-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-655"><a href="#cb39-655" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the image is found and decide based on that</span></span>
<span id="cb39-656"><a href="#cb39-656" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_image_found(farm_total_acres_image, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-657"><a href="#cb39-657" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Image was found - executing related tasks."</span>)</span>
<span id="cb39-658"><a href="#cb39-658" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform tasks related to the image being found</span></span>
<span id="cb39-659"><a href="#cb39-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-660"><a href="#cb39-660" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click to the right of Farm Acres</span></span>
<span id="cb39-661"><a href="#cb39-661" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_image_single(farm_total_acres_image, direction<span class="op">=</span><span class="st">'right'</span>, offset<span class="op">=</span><span class="dv">15</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-662"><a href="#cb39-662" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully farm_total_acres_image."</span>)</span>
<span id="cb39-663"><a href="#cb39-663" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-664"><a href="#cb39-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-665"><a href="#cb39-665" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Delete the contents and send DBACRE</span></span>
<span id="cb39-666"><a href="#cb39-666" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'delete'</span>)</span>
<span id="cb39-667"><a href="#cb39-667" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-668"><a href="#cb39-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-669"><a href="#cb39-669" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb39-670"><a href="#cb39-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-671"><a href="#cb39-671" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="bu">str</span>(DBACRE))</span>
<span id="cb39-672"><a href="#cb39-672" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-673"><a href="#cb39-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-674"><a href="#cb39-674" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-675"><a href="#cb39-675" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-676"><a href="#cb39-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-677"><a href="#cb39-677" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-678"><a href="#cb39-678" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-679"><a href="#cb39-679" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-680"><a href="#cb39-680" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-681"><a href="#cb39-681" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"farm_total_acres_image Image was not found - executing alternative tasks."</span>)</span>
<span id="cb39-682"><a href="#cb39-682" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform alternative tasks</span></span>
<span id="cb39-683"><a href="#cb39-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-684"><a href="#cb39-684" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click to the right of Farm Acres</span></span>
<span id="cb39-685"><a href="#cb39-685" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_image_single(aggregate_land_type_add_button, direction<span class="op">=</span><span class="st">'bottom_right_corner'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-686"><a href="#cb39-686" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully aggregate_land_type_add_button."</span>)</span>
<span id="cb39-687"><a href="#cb39-687" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-688"><a href="#cb39-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-689"><a href="#cb39-689" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send the DBACRE value after clicking the fallback button</span></span>
<span id="cb39-690"><a href="#cb39-690" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="st">'f'</span>)</span>
<span id="cb39-691"><a href="#cb39-691" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-692"><a href="#cb39-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-693"><a href="#cb39-693" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-694"><a href="#cb39-694" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-695"><a href="#cb39-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-696"><a href="#cb39-696" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb39-697"><a href="#cb39-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-698"><a href="#cb39-698" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="bu">str</span>(DBACRE))</span>
<span id="cb39-699"><a href="#cb39-699" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-700"><a href="#cb39-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-701"><a href="#cb39-701" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-702"><a href="#cb39-702" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-703"><a href="#cb39-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-704"><a href="#cb39-704" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-705"><a href="#cb39-705" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-706"><a href="#cb39-706" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-707"><a href="#cb39-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-708"><a href="#cb39-708" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Enter Permit 1/2</span></span>
<span id="cb39-709"><a href="#cb39-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-710"><a href="#cb39-710" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click Permits_Tab</span></span>
<span id="cb39-711"><a href="#cb39-711" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_images_multiple(permits_tab_images, direction<span class="op">=</span><span class="st">'center'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-712"><a href="#cb39-712" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully permits_tab_images."</span>)</span>
<span id="cb39-713"><a href="#cb39-713" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-714"><a href="#cb39-714" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-715"><a href="#cb39-715" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-716"><a href="#cb39-716" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-717"><a href="#cb39-717" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-718"><a href="#cb39-718" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click Permits_Add_Button</span></span>
<span id="cb39-719"><a href="#cb39-719" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_images_multiple(permits_add_permit_button, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">100</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-720"><a href="#cb39-720" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully permits_add_permit_button."</span>)</span>
<span id="cb39-721"><a href="#cb39-721" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-722"><a href="#cb39-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-723"><a href="#cb39-723" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb39-724"><a href="#cb39-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-725"><a href="#cb39-725" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send Permit Number</span></span>
<span id="cb39-726"><a href="#cb39-726" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(PNUMBER)</span>
<span id="cb39-727"><a href="#cb39-727" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-728"><a href="#cb39-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-729"><a href="#cb39-729" aria-hidden="true" tabindex="-1"></a>        pyautogui.press([<span class="st">'tab'</span>])</span>
<span id="cb39-730"><a href="#cb39-730" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-731"><a href="#cb39-731" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-732"><a href="#cb39-732" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Different down to Timber 2 vs Mandatory 11.</span></span>
<span id="cb39-733"><a href="#cb39-733" aria-hidden="true" tabindex="-1"></a>        press_key_multiple_times(<span class="st">'down'</span>, <span class="dv">11</span>)</span>
<span id="cb39-734"><a href="#cb39-734" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-735"><a href="#cb39-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-736"><a href="#cb39-736" aria-hidden="true" tabindex="-1"></a>        press_key_multiple_times([<span class="st">'tab'</span>], <span class="dv">3</span>)</span>
<span id="cb39-737"><a href="#cb39-737" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-738"><a href="#cb39-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-739"><a href="#cb39-739" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb39-740"><a href="#cb39-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-741"><a href="#cb39-741" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send Permit Filing Date</span></span>
<span id="cb39-742"><a href="#cb39-742" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(PFILE)</span>
<span id="cb39-743"><a href="#cb39-743" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-744"><a href="#cb39-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-745"><a href="#cb39-745" aria-hidden="true" tabindex="-1"></a>        press_key_multiple_times([<span class="st">'tab'</span>], <span class="dv">3</span>)</span>
<span id="cb39-746"><a href="#cb39-746" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-747"><a href="#cb39-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-748"><a href="#cb39-748" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Close Add Permit Pop-Up Box</span></span>
<span id="cb39-749"><a href="#cb39-749" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb39-750"><a href="#cb39-750" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Closing Add Permit pop-up, then waiting to send description"</span>)</span>
<span id="cb39-751"><a href="#cb39-751" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">3</span>)</span>
<span id="cb39-752"><a href="#cb39-752" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-753"><a href="#cb39-753" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-754"><a href="#cb39-754" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-755"><a href="#cb39-755" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-756"><a href="#cb39-756" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-757"><a href="#cb39-757" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click to right of permit_description</span></span>
<span id="cb39-758"><a href="#cb39-758" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(permit_description, direction<span class="op">=</span><span class="st">'below'</span>, offset<span class="op">=</span><span class="dv">5</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-759"><a href="#cb39-759" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully permit_description."</span>)</span>
<span id="cb39-760"><a href="#cb39-760" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-761"><a href="#cb39-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-762"><a href="#cb39-762" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb39-763"><a href="#cb39-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-764"><a href="#cb39-764" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Send Permit Description</span></span>
<span id="cb39-765"><a href="#cb39-765" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(PDESC)</span>
<span id="cb39-766"><a href="#cb39-766" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-767"><a href="#cb39-767" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Send description"</span>)</span>
<span id="cb39-768"><a href="#cb39-768" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-769"><a href="#cb39-769" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-770"><a href="#cb39-770" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-771"><a href="#cb39-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-772"><a href="#cb39-772" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Enter Permit 2/2</span></span>
<span id="cb39-773"><a href="#cb39-773" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click FieldVisit_Add_Button</span></span>
<span id="cb39-774"><a href="#cb39-774" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(add_field_visit_image_path, direction<span class="op">=</span><span class="st">'center'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-775"><a href="#cb39-775" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully add_field_visit_image_path."</span>)</span>
<span id="cb39-776"><a href="#cb39-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-777"><a href="#cb39-777" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If found, complete adding Field Visit process</span></span>
<span id="cb39-778"><a href="#cb39-778" aria-hidden="true" tabindex="-1"></a>        press_key_with_modifier_multiple_times(<span class="st">'shift'</span>, <span class="st">'tab'</span>, <span class="dv">6</span>)</span>
<span id="cb39-779"><a href="#cb39-779" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-780"><a href="#cb39-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-781"><a href="#cb39-781" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb39-782"><a href="#cb39-782" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-783"><a href="#cb39-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-784"><a href="#cb39-784" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-785"><a href="#cb39-785" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-786"><a href="#cb39-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-787"><a href="#cb39-787" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="st">'p'</span>)</span>
<span id="cb39-788"><a href="#cb39-788" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-789"><a href="#cb39-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-790"><a href="#cb39-790" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-791"><a href="#cb39-791" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-792"><a href="#cb39-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-793"><a href="#cb39-793" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb39-794"><a href="#cb39-794" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-795"><a href="#cb39-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-796"><a href="#cb39-796" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'right'</span>)</span>
<span id="cb39-797"><a href="#cb39-797" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-798"><a href="#cb39-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-799"><a href="#cb39-799" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Permit Due Date</span></span>
<span id="cb39-800"><a href="#cb39-800" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="ss">f"04/01/</span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-801"><a href="#cb39-801" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-802"><a href="#cb39-802" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-803"><a href="#cb39-803" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-804"><a href="#cb39-804" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-805"><a href="#cb39-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-806"><a href="#cb39-806" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: CHECK FOR TIMBER</span></span>
<span id="cb39-807"><a href="#cb39-807" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Timber Review Logic</span></span>
<span id="cb39-808"><a href="#cb39-808" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> TREVIEW <span class="kw">in</span> [<span class="st">"Yes"</span>, <span class="st">"YES"</span>, <span class="st">"Y"</span>, <span class="st">"y"</span>]:</span>
<span id="cb39-809"><a href="#cb39-809" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Timber YES."</span>)</span>
<span id="cb39-810"><a href="#cb39-810" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb39-811"><a href="#cb39-811" aria-hidden="true" tabindex="-1"></a><span class="co">        # Send Appraiser Permit for TIMBER</span></span>
<span id="cb39-812"><a href="#cb39-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-813"><a href="#cb39-813" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb39-814"><a href="#cb39-814" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Same as permit process except for two changes. Different down to Timber vs Mandatory. Add to Permit Description.</span></span>
<span id="cb39-815"><a href="#cb39-815" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process: Enter Permit 1/2</span></span>
<span id="cb39-816"><a href="#cb39-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-817"><a href="#cb39-817" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click Permits_Tab</span></span>
<span id="cb39-818"><a href="#cb39-818" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_images_multiple(permits_tab_images, direction<span class="op">=</span><span class="st">'center'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-819"><a href="#cb39-819" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully permits_tab_images."</span>)</span>
<span id="cb39-820"><a href="#cb39-820" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-821"><a href="#cb39-821" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-822"><a href="#cb39-822" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-823"><a href="#cb39-823" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-824"><a href="#cb39-824" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-825"><a href="#cb39-825" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click Permits_Add_Button</span></span>
<span id="cb39-826"><a href="#cb39-826" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_images_multiple(permits_add_permit_button, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">100</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-827"><a href="#cb39-827" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully permits_add_permit_button."</span>)</span>
<span id="cb39-828"><a href="#cb39-828" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-829"><a href="#cb39-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-830"><a href="#cb39-830" aria-hidden="true" tabindex="-1"></a>            ensure_capslock_off()</span>
<span id="cb39-831"><a href="#cb39-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-832"><a href="#cb39-832" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Send Permit Number</span></span>
<span id="cb39-833"><a href="#cb39-833" aria-hidden="true" tabindex="-1"></a>            pyautogui.typewrite(PNUMBER)</span>
<span id="cb39-834"><a href="#cb39-834" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-835"><a href="#cb39-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-836"><a href="#cb39-836" aria-hidden="true" tabindex="-1"></a>            pyautogui.press([<span class="st">'tab'</span>])</span>
<span id="cb39-837"><a href="#cb39-837" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-838"><a href="#cb39-838" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-839"><a href="#cb39-839" aria-hidden="true" tabindex="-1"></a>            <span class="co">#Different down to Timber 2 vs Mandatory 11.</span></span>
<span id="cb39-840"><a href="#cb39-840" aria-hidden="true" tabindex="-1"></a>            press_key_multiple_times(<span class="st">'down'</span>, <span class="dv">2</span>)</span>
<span id="cb39-841"><a href="#cb39-841" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-842"><a href="#cb39-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-843"><a href="#cb39-843" aria-hidden="true" tabindex="-1"></a>            press_key_multiple_times([<span class="st">'tab'</span>], <span class="dv">3</span>)</span>
<span id="cb39-844"><a href="#cb39-844" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-845"><a href="#cb39-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-846"><a href="#cb39-846" aria-hidden="true" tabindex="-1"></a>            ensure_capslock_off()</span>
<span id="cb39-847"><a href="#cb39-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-848"><a href="#cb39-848" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Send Permit Filing Date</span></span>
<span id="cb39-849"><a href="#cb39-849" aria-hidden="true" tabindex="-1"></a>            pyautogui.typewrite(PFILE)</span>
<span id="cb39-850"><a href="#cb39-850" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-851"><a href="#cb39-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-852"><a href="#cb39-852" aria-hidden="true" tabindex="-1"></a>            press_key_multiple_times([<span class="st">'tab'</span>], <span class="dv">3</span>)</span>
<span id="cb39-853"><a href="#cb39-853" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-854"><a href="#cb39-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-855"><a href="#cb39-855" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Close Add Permit Pop-Up Box</span></span>
<span id="cb39-856"><a href="#cb39-856" aria-hidden="true" tabindex="-1"></a>            pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb39-857"><a href="#cb39-857" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Closing Add Permit pop-up, then waiting to send description"</span>)</span>
<span id="cb39-858"><a href="#cb39-858" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">3</span>)</span>
<span id="cb39-859"><a href="#cb39-859" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-860"><a href="#cb39-860" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-861"><a href="#cb39-861" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-862"><a href="#cb39-862" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-863"><a href="#cb39-863" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-864"><a href="#cb39-864" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click to right of permit_description</span></span>
<span id="cb39-865"><a href="#cb39-865" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_image_single(permit_description, direction<span class="op">=</span><span class="st">'below'</span>, offset<span class="op">=</span><span class="dv">5</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-866"><a href="#cb39-866" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully permit_description."</span>)</span>
<span id="cb39-867"><a href="#cb39-867" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-868"><a href="#cb39-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-869"><a href="#cb39-869" aria-hidden="true" tabindex="-1"></a>        ensure_capslock_off()</span>
<span id="cb39-870"><a href="#cb39-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-871"><a href="#cb39-871" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send Permit Description -- Add to Permit Description.</span></span>
<span id="cb39-872"><a href="#cb39-872" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(<span class="ss">f"</span><span class="sc">{</span>PDESC<span class="sc">}</span><span class="ss"> FOR TIMBER REVIEW"</span>)</span>
<span id="cb39-873"><a href="#cb39-873" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-874"><a href="#cb39-874" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Send description"</span>)</span>
<span id="cb39-875"><a href="#cb39-875" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb39-876"><a href="#cb39-876" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-877"><a href="#cb39-877" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-878"><a href="#cb39-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-879"><a href="#cb39-879" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process: Enter Permit 2/2</span></span>
<span id="cb39-880"><a href="#cb39-880" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Click FieldVisit_Add_Button</span></span>
<span id="cb39-881"><a href="#cb39-881" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_image_single(add_field_visit_image_path, direction<span class="op">=</span><span class="st">'center'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb39-882"><a href="#cb39-882" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Clicked successfully add_field_visit_image_path."</span>)</span>
<span id="cb39-883"><a href="#cb39-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-884"><a href="#cb39-884" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If found, complete adding Field Visit process</span></span>
<span id="cb39-885"><a href="#cb39-885" aria-hidden="true" tabindex="-1"></a>            press_key_with_modifier_multiple_times(<span class="st">'shift'</span>, <span class="st">'tab'</span>, <span class="dv">6</span>)</span>
<span id="cb39-886"><a href="#cb39-886" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-887"><a href="#cb39-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-888"><a href="#cb39-888" aria-hidden="true" tabindex="-1"></a>            pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb39-889"><a href="#cb39-889" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-890"><a href="#cb39-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-891"><a href="#cb39-891" aria-hidden="true" tabindex="-1"></a>            pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-892"><a href="#cb39-892" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-893"><a href="#cb39-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-894"><a href="#cb39-894" aria-hidden="true" tabindex="-1"></a>            pyautogui.typewrite(<span class="st">'p'</span>)</span>
<span id="cb39-895"><a href="#cb39-895" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-896"><a href="#cb39-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-897"><a href="#cb39-897" aria-hidden="true" tabindex="-1"></a>            pyautogui.press(<span class="st">'tab'</span>)</span>
<span id="cb39-898"><a href="#cb39-898" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-899"><a href="#cb39-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-900"><a href="#cb39-900" aria-hidden="true" tabindex="-1"></a>            pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb39-901"><a href="#cb39-901" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-902"><a href="#cb39-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-903"><a href="#cb39-903" aria-hidden="true" tabindex="-1"></a>            pyautogui.press(<span class="st">'right'</span>)</span>
<span id="cb39-904"><a href="#cb39-904" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-905"><a href="#cb39-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-906"><a href="#cb39-906" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Permit Due Date</span></span>
<span id="cb39-907"><a href="#cb39-907" aria-hidden="true" tabindex="-1"></a>            pyautogui.typewrite(<span class="ss">f"04/01/</span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-908"><a href="#cb39-908" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-909"><a href="#cb39-909" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> stop_script:</span>
<span id="cb39-910"><a href="#cb39-910" aria-hidden="true" tabindex="-1"></a>                logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-911"><a href="#cb39-911" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb39-912"><a href="#cb39-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-913"><a href="#cb39-913" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-914"><a href="#cb39-914" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Timber review not required, skipping this step."</span>)</span>
<span id="cb39-915"><a href="#cb39-915" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-916"><a href="#cb39-916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-917"><a href="#cb39-917" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-918"><a href="#cb39-918" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-919"><a href="#cb39-919" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb39-920"><a href="#cb39-920" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb39-921"><a href="#cb39-921" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb39-922"><a href="#cb39-922" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb39-923"><a href="#cb39-923" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb39-924"><a href="#cb39-924" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save Account</span></span>
<span id="cb39-925"><a href="#cb39-925" aria-hidden="true" tabindex="-1"></a>    pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'s'</span>)</span>
<span id="cb39-926"><a href="#cb39-926" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Save."</span>)</span>
<span id="cb39-927"><a href="#cb39-927" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-928"><a href="#cb39-928" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb39-929"><a href="#cb39-929" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb39-930"><a href="#cb39-930" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-931"><a href="#cb39-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-932"><a href="#cb39-932" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="re">END</span><span class="co"> ALL PROCESSESS</span></span>
<span id="cb39-933"><a href="#cb39-933" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"THE END..."</span>)</span>
<span id="cb39-934"><a href="#cb39-934" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb39-935"><a href="#cb39-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-936"><a href="#cb39-936" aria-hidden="true" tabindex="-1"></a><span class="co"># Close the database connection</span></span>
<span id="cb39-937"><a href="#cb39-937" aria-hidden="true" tabindex="-1"></a>conn.close()</span>
<span id="cb39-938"><a href="#cb39-938" aria-hidden="true" tabindex="-1"></a>logging.info(<span class="st">"Database Connection Closed"</span>)</span>
<span id="cb39-939"><a href="#cb39-939" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb39-940"><a href="#cb39-940" aria-hidden="true" tabindex="-1"></a><span class="co">Notes:</span></span>
<span id="cb39-941"><a href="#cb39-941" aria-hidden="true" tabindex="-1"></a><span class="co">if AIN:</span></span>
<span id="cb39-942"><a href="#cb39-942" aria-hidden="true" tabindex="-1"></a><span class="co">    press_key_multiple_times('down', 4)</span></span>
<span id="cb39-943"><a href="#cb39-943" aria-hidden="true" tabindex="-1"></a><span class="co">elif PIN:</span></span>
<span id="cb39-944"><a href="#cb39-944" aria-hidden="true" tabindex="-1"></a><span class="co">    press_key_multiple_times('down', 0)</span></span>
<span id="cb39-945"><a href="#cb39-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-946"><a href="#cb39-946" aria-hidden="true" tabindex="-1"></a><span class="co">## For testing purposes, </span></span>
<span id="cb39-947"><a href="#cb39-947" aria-hidden="true" tabindex="-1"></a><span class="co"># PIN: KC-DGW = AIN: 345134</span></span>
<span id="cb39-948"><a href="#cb39-948" aria-hidden="true" tabindex="-1"></a><span class="co"># PIN: KC-DAS = AIN: 348586</span></span>
<span id="cb39-949"><a href="#cb39-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-950"><a href="#cb39-950" aria-hidden="true" tabindex="-1"></a><span class="co">345134,348586</span></span>
<span id="cb39-951"><a href="#cb39-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-952"><a href="#cb39-952" aria-hidden="true" tabindex="-1"></a><span class="co">DGW-08/24 SEG ...</span></span>
<span id="cb39-953"><a href="#cb39-953" aria-hidden="true" tabindex="-1"></a><span class="co">SEG PACKET</span></span>
<span id="cb39-954"><a href="#cb39-954" aria-hidden="true" tabindex="-1"></a><span class="co">01/01/2024</span></span>
<span id="cb39-955"><a href="#cb39-955" aria-hidden="true" tabindex="-1"></a><span class="co">01/01/2025</span></span>
<span id="cb39-956"><a href="#cb39-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-957"><a href="#cb39-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-958"><a href="#cb39-958" aria-hidden="true" tabindex="-1"></a><span class="al">###</span><span class="co"> LEFT OFF HERE NEEDS MORE DIRECTION</span></span>
<span id="cb39-959"><a href="#cb39-959" aria-hidden="true" tabindex="-1"></a><span class="co">    time.sleep(1000)</span></span>
<span id="cb39-960"><a href="#cb39-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-961"><a href="#cb39-961" aria-hidden="true" tabindex="-1"></a><span class="co"># Version History</span></span>
<span id="cb39-962"><a href="#cb39-962" aria-hidden="true" tabindex="-1"></a><span class="co"># NEW v1 07/26/2024</span></span>
<span id="cb39-963"><a href="#cb39-963" aria-hidden="true" tabindex="-1"></a><span class="co"># 07/30/2024, I give up for now, I'll circle back to this when I'm done training Pat.</span></span>
<span id="cb39-964"><a href="#cb39-964" aria-hidden="true" tabindex="-1"></a><span class="co"># 08/07/2024, successfully used the OCR to read and nagivate several screens in ProVal. </span></span>
<span id="cb39-965"><a href="#cb39-965" aria-hidden="true" tabindex="-1"></a><span class="co">    # One huge key was to shift the screenshot reading to Greyscale and then actually change the stored images to Greyscale as well.</span></span>
<span id="cb39-966"><a href="#cb39-966" aria-hidden="true" tabindex="-1"></a><span class="co">#08/13/2024, updated to include the capacity to click around images found, to the left of, right of, bottom corner of, etc. </span></span>
<span id="cb39-967"><a href="#cb39-967" aria-hidden="true" tabindex="-1"></a><span class="co">    # Added multiple functionalities </span></span>
<span id="cb39-968"><a href="#cb39-968" aria-hidden="true" tabindex="-1"></a><span class="co">    # Possibly ready for testing?</span></span>
<span id="cb39-969"><a href="#cb39-969" aria-hidden="true" tabindex="-1"></a><span class="co">    # Added logging and tweaks to inputs</span></span>
<span id="cb39-970"><a href="#cb39-970" aria-hidden="true" tabindex="-1"></a><span class="co">    # After running through one live mapping packet, realized the MemoTXT was including brackets and literals</span></span>
<span id="cb39-971"><a href="#cb39-971" aria-hidden="true" tabindex="-1"></a><span class="co">    # Updated to remove these and make the MemoTXT clean</span></span>
<span id="cb39-972"><a href="#cb39-972" aria-hidden="true" tabindex="-1"></a><span class="co">    # Should be ready to test on another nmapping packet tomorrow.</span></span>
<span id="cb39-973"><a href="#cb39-973" aria-hidden="true" tabindex="-1"></a><span class="co">#08/20/2024, entirely new v3, streamlined, simplified, built in re-usable blocks for future templates</span></span>
<span id="cb39-974"><a href="#cb39-974" aria-hidden="true" tabindex="-1"></a><span class="co">    # After much review and many ChatGPT conversations and many tests... v3 is ready to be used as a template for other automations</span></span>
<span id="cb39-975"><a href="#cb39-975" aria-hidden="true" tabindex="-1"></a><span class="co">    # Next ... </span></span>
<span id="cb39-976"><a href="#cb39-976" aria-hidden="true" tabindex="-1"></a><span class="co">    # Write documenation and instruction manual</span></span>
<span id="cb39-977"><a href="#cb39-977" aria-hidden="true" tabindex="-1"></a><span class="co">    # Save Template Version</span></span>
<span id="cb39-978"><a href="#cb39-978" aria-hidden="true" tabindex="-1"></a><span class="co">    # Write a Plat version</span></span>
<span id="cb39-979"><a href="#cb39-979" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb39-980"><a href="#cb39-980" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="template---automation-template" class="level1">
<h1>TEMPLATE - AUTOMATION TEMPLATE</h1>
<p>The following template can be used to auomate your tasks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOTE_StartHERE: Copy, Paste, Rename before making changes to this template</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generally, you should be able to skip over most functions and start building from START_HERE below</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Possibly, you may need to take new images and store those image paths, make sure to greyscale the final image on the shared image location</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">import subprocess</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">import pkg_resources</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">import sys</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">def install_if_missing(package):</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">    try:</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">        pkg_resources.get_distribution(package)</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">    except pkg_resources.DistributionNotFound:</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">        subprocess.check_call([sys.executable, "-m", "pip", "install", package])</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co"># List of packages you want to ensure are installed</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co">packages = [</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co">    "pyautogui",       # For automating GUI interactions</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co">    "pyodbc",          # For database connections</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co">    "numpy",           # For numerical operations</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co">    "keyboard",        # For detecting key presses</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co">    "pytesseract",     # For OCR (Optical Character Recognition)</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="co">    "Pillow",          # For image processing related to Image</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="co">    "opencv-python",   # For image processing (cv2)</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co">    "tkcalendar"       # For calendar widget in Tkinter</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="co">]</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the install_if_missing function to each package</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co">for package in packages:</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co">    install_if_missing(package)</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co"># After ensuring all packages are installed, you can import them as needed in your script</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyautogui  <span class="co"># For automating GUI interactions like mouse movements and clicks</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyodbc  <span class="co"># For establishing database connections and executing SQL queries</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time  <span class="co"># For adding delays and managing time-related functions</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># For numerical operations and handling arrays/matrices</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keyboard  <span class="co"># For detecting and handling keyboard key presses</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> threading  <span class="co"># For running background tasks and creating concurrent threads</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk  <span class="co"># For creating basic GUI elements in Python applications</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkinter <span class="im">import</span> ttk, messagebox  <span class="co"># For advanced Tkinter widgets and displaying dialog boxes</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytesseract  <span class="co"># For OCR (Optical Character Recognition) to read text from images</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image  <span class="co"># For working with image data</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2  <span class="co"># For image processing and computer vision tasks (OpenCV library)</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes  <span class="co"># For interacting with C data types and Windows API functions</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkcalendar <span class="im">import</span> DateEntry  <span class="co"># For adding a calendar widget to Tkinter GUIs</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging  <span class="co"># For logging events, errors, and information during script execution</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime <span class="co"># For handling dates and times</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL LOGICS - CONNECTIONS</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a><span class="co">### Logging</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">'S:/Common/Comptroller Tech/Reports/Python/Auto_Mapping_Packet/MappingPacketsAutomation.log'</span>,</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span>logging.DEBUG,</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>console_handler <span class="op">=</span> logging.StreamHandler()</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>console_handler.setLevel(logging.DEBUG)</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>console_handler.setFormatter(logging.Formatter(<span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>))</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>logging.getLogger().addHandler(console_handler)</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a><span class="co">### Kill Script</span></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Global flag to indicate if the script should be stopped</span></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>stop_script <span class="op">=</span> <span class="va">False</span></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monitor_kill_key():</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> stop_script</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Kill key monitor started. Press 'esc' to stop the script."</span>)</span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>    keyboard.wait(<span class="st">'esc'</span>)  <span class="co"># Set 'esc' as the kill key</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>    stop_script <span class="op">=</span> <span class="va">True</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Kill key pressed. Stopping the script..."</span>)</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the kill key monitoring in a separate thread</span></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>kill_key_thread <span class="op">=</span> threading.Thread(target<span class="op">=</span>monitor_kill_key)</span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>kill_key_thread.daemon <span class="op">=</span> <span class="va">True</span></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>kill_key_thread.start()</span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a><span class="co">### Connections: Database</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration for database connection</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>db_connection_string <span class="op">=</span> (</span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Driver={SQL Server};"</span></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Server=astxdbprod;"</span></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Database=GRM_Main;"</span></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trusted_Connection=yes;"</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to connect to the database</span></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> connect_to_database(connection_string):</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pyodbc.<span class="ex">connect</span>(connection_string)</span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to execute a SQL query and fetch data</span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> execute_query(cursor, query):</span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a>    cursor.execute(query)</span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cursor.fetchall()</span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a><span class="co"># VARIABLES MAY BE UPDATED HERE</span></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a><span class="co">### Graphic User Interface (GUI) Logic - START</span></span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize variables to avoid 'NameError', will call them into the final product after variable selections</span></span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>MemoTXT <span class="op">=</span> <span class="st">""</span></span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>PDESC <span class="op">=</span> <span class="st">""</span></span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> on_submit():</span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> AINLIST, AINFROM, AINTO, PDESC, PFILE, PNUMBER, TREVIEW, MappingPacketType, Initials, MemoTXT, ForYear</span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect inputs for AINFROM and AINTO, and split by commas</span></span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a>    AINFROM <span class="op">=</span> [ain.strip() <span class="cf">for</span> ain <span class="kw">in</span> entry_ainfrom.get().strip().upper().split(<span class="st">","</span>)]</span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a>    AINTO <span class="op">=</span> [ain.strip() <span class="cf">for</span> ain <span class="kw">in</span> entry_ainto.get().strip().upper().split(<span class="st">","</span>)]</span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine the AINFROM and AINTO lists, removing duplicates</span></span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a>    combined_ain_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(AINFROM <span class="op">+</span> AINTO))</span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace AINLIST with the combined list</span></span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a>    AINLIST <span class="op">=</span> combined_ain_list</span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>    PFILE <span class="op">=</span> entry_pfile.get().strip().upper()</span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>    PNUMBER <span class="op">=</span> entry_pnumber.get().strip().upper()</span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>    TREVIEW <span class="op">=</span> entry_treview.get().strip().upper()</span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>    MappingPacketType <span class="op">=</span> combobox_mappingpackettype.get().strip().upper()</span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>    Initials <span class="op">=</span> entry_initials.get().strip().upper()</span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>    ForYear <span class="op">=</span> for_year_combobox.get().strip()  <span class="co"># Get the selected year</span></span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>    the_month <span class="op">=</span> datetime.now().month</span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>    the_day <span class="op">=</span> datetime.now().day</span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a>    the_year <span class="op">=</span> datetime.now().year</span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_month = datetime.datetime.now().month</span></span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_day = datetime.datetime.now().day</span></span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the_year = datetime.datetime.now().year</span></span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>    AINFROM_str <span class="op">=</span> <span class="st">', '</span>.join(AINFROM)</span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>    AINTO_str <span class="op">=</span> <span class="st">', '</span>.join(AINTO)</span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>    MemoTXT <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>Initials<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>the_month<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">str</span>(the_year)[<span class="op">-</span><span class="dv">2</span>:]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>MappingPacketType<span class="sc">}</span><span class="ss"> from </span><span class="sc">{</span>AINFROM_str<span class="sc">}</span><span class="ss"> into </span><span class="sc">{</span>AINTO_str<span class="sc">}</span><span class="ss"> for </span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Generated MemoTXT: </span><span class="sc">{</span>MemoTXT<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>    PDESC <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>MappingPacketType<span class="sc">}</span><span class="ss"> for </span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> AINLIST <span class="kw">or</span> <span class="kw">not</span> PFILE <span class="kw">or</span> <span class="kw">not</span> PNUMBER <span class="kw">or</span> <span class="kw">not</span> TREVIEW <span class="kw">or</span> <span class="kw">not</span> MappingPacketType <span class="kw">or</span> <span class="kw">not</span> Initials <span class="kw">or</span> <span class="kw">not</span> MemoTXT <span class="kw">or</span> <span class="kw">not</span> PDESC:</span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>        messagebox.showerror(<span class="st">"Input Error"</span>, <span class="st">"All input fields are required."</span>)</span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>    root.destroy()  <span class="co"># Close the GUI</span></span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup_gui():</span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> tk.Tk()</span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>    root.title(<span class="st">"User Input Form"</span>)</span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>    setup_widgets(root)</span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> root</span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_initials(action, value_if_allowed):</span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Allow only alphabetic characters and limit to 3 characters</span></span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> action <span class="op">==</span> <span class="st">'1'</span>:  <span class="co"># 1 means an insertion operation</span></span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(value_if_allowed) <span class="op">&gt;</span> <span class="dv">3</span>:</span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> value_if_allowed.isalpha()</span>
<span id="cb40-177"><a href="#cb40-177" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb40-178"><a href="#cb40-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-179"><a href="#cb40-179" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup_widgets(root):</span>
<span id="cb40-180"><a href="#cb40-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> entry_ainfrom, entry_ainto, entry_pfile, entry_pnumber, entry_treview, combobox_mappingpackettype, entry_initials, for_year_combobox</span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the current and next year</span></span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a>    current_year <span class="op">=</span> datetime.now().year</span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a>    next_year <span class="op">=</span> current_year <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-186"><a href="#cb40-186" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Mapping packet FOR what year?:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-187"><a href="#cb40-187" aria-hidden="true" tabindex="-1"></a>    for_year_combobox <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>[current_year, next_year], width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb40-188"><a href="#cb40-188" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the current year</span></span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AINFROM input</span></span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"List AINs FROM (separated by comma):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">0</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a>    entry_ainfrom <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a>    entry_ainfrom.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">0</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-195"><a href="#cb40-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-196"><a href="#cb40-196" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AINTO input</span></span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"List AINs TO (separated by comma):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a>    entry_ainto <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a>    entry_ainto.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">1</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-200"><a href="#cb40-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-201"><a href="#cb40-201" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Existing fields continue below...</span></span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Mapping packet FOR what year?:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">2</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a>    for_year_combobox <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>[current_year, next_year], width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">2</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a>    for_year_combobox.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the current year</span></span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-207"><a href="#cb40-207" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Filing Date (Top Date):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">3</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-208"><a href="#cb40-208" aria-hidden="true" tabindex="-1"></a>    entry_pfile <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a>    entry_pfile.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">3</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Permit Number (Bottom Date):"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">4</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a>    entry_pnumber <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a>    entry_pnumber.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">4</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Timber or AG review? Y/N:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">5</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a>    entry_treview <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a>    entry_treview.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">5</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Select Mapping Packet Type:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">6</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a>    mapping_packet_types <span class="op">=</span> [</span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MERGE"</span>, <span class="st">"SPLIT"</span>, <span class="st">"BLA"</span>, <span class="st">"LLA"</span>, <span class="st">"RW VACATION"</span>, <span class="st">"RW SPLIT"</span>, <span class="st">"REDESCRIBE"</span>,</span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RW AUDIT"</span>, <span class="st">"RW Cat19"</span>, <span class="st">"AIRPORT LEASE NEW PARCEL"</span>, <span class="st">"PLAT VACATION"</span>,</span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PARCEL DELETED"</span>, <span class="st">"ACERAGE AUDIT"</span>, <span class="st">"NEW PLAT"</span></span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype <span class="op">=</span> ttk.Combobox(root, values<span class="op">=</span>mapping_packet_types, width<span class="op">=</span><span class="dv">47</span>)</span>
<span id="cb40-227"><a href="#cb40-227" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">6</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-228"><a href="#cb40-228" aria-hidden="true" tabindex="-1"></a>    combobox_mappingpackettype.current(<span class="dv">0</span>)  <span class="co"># Set default selection to the first item</span></span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validation for the Initials Entry</span></span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a>    vcmd <span class="op">=</span> (root.register(validate_initials), <span class="st">'</span><span class="sc">%d</span><span class="st">'</span>, <span class="st">'%P'</span>)</span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a>    ttk.Label(root, text<span class="op">=</span><span class="st">"Enter (3) Initials:"</span>).grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">7</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a>    entry_initials <span class="op">=</span> ttk.Entry(root, width<span class="op">=</span><span class="dv">50</span>, validate<span class="op">=</span><span class="st">'key'</span>, validatecommand<span class="op">=</span>vcmd)</span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a>    entry_initials.grid(column<span class="op">=</span><span class="dv">1</span>, row<span class="op">=</span><span class="dv">7</span>, padx<span class="op">=</span><span class="dv">10</span>, pady<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-236"><a href="#cb40-236" aria-hidden="true" tabindex="-1"></a>    entry_initials.insert(<span class="dv">0</span>, <span class="st">"DGW"</span>)</span>
<span id="cb40-237"><a href="#cb40-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-238"><a href="#cb40-238" aria-hidden="true" tabindex="-1"></a>    submit_button <span class="op">=</span> ttk.Button(root, text<span class="op">=</span><span class="st">"Submit"</span>, command<span class="op">=</span>on_submit)</span>
<span id="cb40-239"><a href="#cb40-239" aria-hidden="true" tabindex="-1"></a>    submit_button.grid(column<span class="op">=</span><span class="dv">0</span>, row<span class="op">=</span><span class="dv">8</span>, columnspan<span class="op">=</span><span class="dv">2</span>, pady<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb40-240"><a href="#cb40-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-241"><a href="#cb40-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-242"><a href="#cb40-242" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> setup_gui()</span>
<span id="cb40-243"><a href="#cb40-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-244"><a href="#cb40-244" aria-hidden="true" tabindex="-1"></a><span class="co">### Graphic User Interface (GUI) Logic - </span><span class="re">END</span></span>
<span id="cb40-245"><a href="#cb40-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-246"><a href="#cb40-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-247"><a href="#cb40-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-248"><a href="#cb40-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-249"><a href="#cb40-249" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-250"><a href="#cb40-250" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL LOGICS - LOGIC FUNCTIONS</span></span>
<span id="cb40-251"><a href="#cb40-251" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-252"><a href="#cb40-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-253"><a href="#cb40-253" aria-hidden="true" tabindex="-1"></a><span class="co">#### CAPS LOCK</span></span>
<span id="cb40-254"><a href="#cb40-254" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_capslock_on():</span>
<span id="cb40-255"><a href="#cb40-255" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This will return 1 if CAPS LOCK is on, 0 if it's off</span></span>
<span id="cb40-256"><a href="#cb40-256" aria-hidden="true" tabindex="-1"></a>    hllDll <span class="op">=</span> ctypes.WinDLL(<span class="st">"User32.dll"</span>)</span>
<span id="cb40-257"><a href="#cb40-257" aria-hidden="true" tabindex="-1"></a>    VK_CAPITAL <span class="op">=</span> <span class="bn">0x14</span></span>
<span id="cb40-258"><a href="#cb40-258" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hllDll.GetKeyState(VK_CAPITAL) <span class="op">&amp;</span> <span class="dv">1</span></span>
<span id="cb40-259"><a href="#cb40-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-260"><a href="#cb40-260" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ensure_capslock_off():</span>
<span id="cb40-261"><a href="#cb40-261" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_capslock_on():</span>
<span id="cb40-262"><a href="#cb40-262" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(<span class="st">'capslock'</span>)</span>
<span id="cb40-263"><a href="#cb40-263" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"CAPS LOCK was on. It has been turned off."</span>)</span>
<span id="cb40-264"><a href="#cb40-264" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-265"><a href="#cb40-265" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"CAPS LOCK is already off."</span>)</span>
<span id="cb40-266"><a href="#cb40-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-267"><a href="#cb40-267" aria-hidden="true" tabindex="-1"></a><span class="co">#### SET FOCUS</span></span>
<span id="cb40-268"><a href="#cb40-268" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_focus_and_type(window_title, keys):</span>
<span id="cb40-269"><a href="#cb40-269" aria-hidden="true" tabindex="-1"></a>    window <span class="op">=</span> pyautogui.getWindowsWithTitle(window_title)</span>
<span id="cb40-270"><a href="#cb40-270" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> window:</span>
<span id="cb40-271"><a href="#cb40-271" aria-hidden="true" tabindex="-1"></a>        window[<span class="dv">0</span>].activate()</span>
<span id="cb40-272"><a href="#cb40-272" aria-hidden="true" tabindex="-1"></a>        pyautogui.typewrite(keys)</span>
<span id="cb40-273"><a href="#cb40-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-274"><a href="#cb40-274" aria-hidden="true" tabindex="-1"></a><span class="co">#### PRESS &amp; CLICK KEY LOGIC</span></span>
<span id="cb40-275"><a href="#cb40-275" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_with_modifier_multiple_times(modifier, key, times):</span>
<span id="cb40-276"><a href="#cb40-276" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb40-277"><a href="#cb40-277" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb40-278"><a href="#cb40-278" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb40-279"><a href="#cb40-279" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb40-280"><a href="#cb40-280" aria-hidden="true" tabindex="-1"></a>        pyautogui.hotkey(modifier, key)</span>
<span id="cb40-281"><a href="#cb40-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-282"><a href="#cb40-282" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> press_key_multiple_times(key, times):</span>
<span id="cb40-283"><a href="#cb40-283" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</span>
<span id="cb40-284"><a href="#cb40-284" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> stop_script:</span>
<span id="cb40-285"><a href="#cb40-285" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb40-286"><a href="#cb40-286" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb40-287"><a href="#cb40-287" aria-hidden="true" tabindex="-1"></a>        pyautogui.press(key)</span>
<span id="cb40-288"><a href="#cb40-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-289"><a href="#cb40-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-290"><a href="#cb40-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-291"><a href="#cb40-291" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-292"><a href="#cb40-292" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL LOGICS - SCREEN HANDLING FUNCTIONS</span></span>
<span id="cb40-293"><a href="#cb40-293" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-294"><a href="#cb40-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-295"><a href="#cb40-295" aria-hidden="true" tabindex="-1"></a><span class="co">### Connections: OCR and Image Paths</span></span>
<span id="cb40-296"><a href="#cb40-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-297"><a href="#cb40-297" aria-hidden="true" tabindex="-1"></a><span class="co">#### OCR</span></span>
<span id="cb40-298"><a href="#cb40-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-299"><a href="#cb40-299" aria-hidden="true" tabindex="-1"></a><span class="co"># This OCR program is required to work with this script, it is available on GitHub</span></span>
<span id="cb40-300"><a href="#cb40-300" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the tesseract executable path if not in the system path</span></span>
<span id="cb40-301"><a href="#cb40-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Update this path as necessary by user you will need to download and install tesseract from GitHub</span></span>
<span id="cb40-302"><a href="#cb40-302" aria-hidden="true" tabindex="-1"></a><span class="co"># Link https://github.com/tesseract-ocr/tesseract</span></span>
<span id="cb40-303"><a href="#cb40-303" aria-hidden="true" tabindex="-1"></a><span class="co"># Link https://github.com/UB-Mannheim/tesseract/wiki</span></span>
<span id="cb40-304"><a href="#cb40-304" aria-hidden="true" tabindex="-1"></a>pytesseract.pytesseract.tesseract_cmd <span class="op">=</span> <span class="vs">r'C:\Users\dwolfe\AppData\Local\Programs\Tesseract-OCR\tesseract.exe'</span></span>
<span id="cb40-305"><a href="#cb40-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-306"><a href="#cb40-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-307"><a href="#cb40-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-308"><a href="#cb40-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-309"><a href="#cb40-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-310"><a href="#cb40-310" aria-hidden="true" tabindex="-1"></a><span class="co"># IMAGES MAY BE UPDATED HERE</span></span>
<span id="cb40-311"><a href="#cb40-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-312"><a href="#cb40-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-313"><a href="#cb40-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-314"><a href="#cb40-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-315"><a href="#cb40-315" aria-hidden="true" tabindex="-1"></a><span class="co">#### Image Paths - Active and Inactive</span></span>
<span id="cb40-316"><a href="#cb40-316" aria-hidden="true" tabindex="-1"></a>land_tab_images <span class="op">=</span> [</span>
<span id="cb40-317"><a href="#cb40-317" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_tab.PNG'</span>,</span>
<span id="cb40-318"><a href="#cb40-318" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_tab_active.PNG'</span></span>
<span id="cb40-319"><a href="#cb40-319" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb40-320"><a href="#cb40-320" aria-hidden="true" tabindex="-1"></a>land_base_tab_images <span class="op">=</span> [</span>
<span id="cb40-321"><a href="#cb40-321" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_base_tab.PNG'</span>,</span>
<span id="cb40-322"><a href="#cb40-322" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_land_base_tab_active.PNG'</span></span>
<span id="cb40-323"><a href="#cb40-323" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb40-324"><a href="#cb40-324" aria-hidden="true" tabindex="-1"></a>permits_tab_images <span class="op">=</span> [</span>
<span id="cb40-325"><a href="#cb40-325" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_tab.PNG'</span>,</span>
<span id="cb40-326"><a href="#cb40-326" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_tab_active.PNG'</span></span>
<span id="cb40-327"><a href="#cb40-327" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb40-328"><a href="#cb40-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-329"><a href="#cb40-329" aria-hidden="true" tabindex="-1"></a>permits_add_permit_button <span class="op">=</span> [</span>
<span id="cb40-330"><a href="#cb40-330" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_permit_button.PNG'</span>,</span>
<span id="cb40-331"><a href="#cb40-331" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_permit_button_active.PNG'</span></span>
<span id="cb40-332"><a href="#cb40-332" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb40-333"><a href="#cb40-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-334"><a href="#cb40-334" aria-hidden="true" tabindex="-1"></a><span class="co">#### Image Paths - Single Images Only</span></span>
<span id="cb40-335"><a href="#cb40-335" aria-hidden="true" tabindex="-1"></a>duplicate_memo_image_path <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_memo_duplicate.PNG'</span></span>
<span id="cb40-336"><a href="#cb40-336" aria-hidden="true" tabindex="-1"></a>add_field_visit_image_path <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permits_add_fieldvisit_button.PNG'</span></span>
<span id="cb40-337"><a href="#cb40-337" aria-hidden="true" tabindex="-1"></a>aggregate_land_type_add_button <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_aggregate_land_type_add_button.PNG'</span></span>
<span id="cb40-338"><a href="#cb40-338" aria-hidden="true" tabindex="-1"></a>farm_total_acres_image <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_farm_total_acres.PNG'</span></span>
<span id="cb40-339"><a href="#cb40-339" aria-hidden="true" tabindex="-1"></a>permit_description <span class="op">=</span> <span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Proval_permit_description.PNG'</span></span>
<span id="cb40-340"><a href="#cb40-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-341"><a href="#cb40-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-342"><a href="#cb40-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-343"><a href="#cb40-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-344"><a href="#cb40-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-345"><a href="#cb40-345" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 CAPTURE SCREEN IN GREYSCALE</span></span>
<span id="cb40-346"><a href="#cb40-346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> capture_and_convert_screenshot():</span>
<span id="cb40-347"><a href="#cb40-347" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Capture the screenshot using pyautogui</span></span>
<span id="cb40-348"><a href="#cb40-348" aria-hidden="true" tabindex="-1"></a>    screenshot <span class="op">=</span> pyautogui.screenshot()</span>
<span id="cb40-349"><a href="#cb40-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-350"><a href="#cb40-350" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the screenshot to a numpy array, then to BGR, and finally to greyscale</span></span>
<span id="cb40-351"><a href="#cb40-351" aria-hidden="true" tabindex="-1"></a>    screenshot_np <span class="op">=</span> np.array(screenshot)</span>
<span id="cb40-352"><a href="#cb40-352" aria-hidden="true" tabindex="-1"></a>    screenshot_np <span class="op">=</span> cv2.cvtColor(screenshot_np, cv2.COLOR_RGB2BGR)</span>
<span id="cb40-353"><a href="#cb40-353" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> cv2.cvtColor(screenshot_np, cv2.COLOR_BGR2GRAY)</span>
<span id="cb40-354"><a href="#cb40-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-355"><a href="#cb40-355" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grey_screenshot</span>
<span id="cb40-356"><a href="#cb40-356" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 CLICK USING A REFERENCE GREYSCALE SCREENSHOT TO A STORED GREYSCALE IMAGE INCLUDES ABILITY TO CLICK RELATIVE POSITION</span></span>
<span id="cb40-357"><a href="#cb40-357" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_on_image(image_path, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">10</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb40-358"><a href="#cb40-358" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb40-359"><a href="#cb40-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-360"><a href="#cb40-360" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the reference image in greyscale</span></span>
<span id="cb40-361"><a href="#cb40-361" aria-hidden="true" tabindex="-1"></a>    ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb40-362"><a href="#cb40-362" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ref_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb40-363"><a href="#cb40-363" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to load reference image from </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-364"><a href="#cb40-364" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb40-365"><a href="#cb40-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-366"><a href="#cb40-366" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb40-367"><a href="#cb40-367" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cv2.matchTemplate(grey_screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb40-368"><a href="#cb40-368" aria-hidden="true" tabindex="-1"></a>    _, max_val, _, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb40-369"><a href="#cb40-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-370"><a href="#cb40-370" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence:</span>
<span id="cb40-371"><a href="#cb40-371" aria-hidden="true" tabindex="-1"></a>        top_left <span class="op">=</span> max_loc</span>
<span id="cb40-372"><a href="#cb40-372" aria-hidden="true" tabindex="-1"></a>        h, w <span class="op">=</span> ref_image.shape</span>
<span id="cb40-373"><a href="#cb40-373" aria-hidden="true" tabindex="-1"></a>        right <span class="op">=</span> top_left[<span class="dv">0</span>] <span class="op">+</span> w</span>
<span id="cb40-374"><a href="#cb40-374" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> top_left[<span class="dv">1</span>] <span class="op">+</span> h</span>
<span id="cb40-375"><a href="#cb40-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-376"><a href="#cb40-376" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate click position based on direction and inset/offset</span></span>
<span id="cb40-377"><a href="#cb40-377" aria-hidden="true" tabindex="-1"></a>        click_positions <span class="op">=</span> {</span>
<span id="cb40-378"><a href="#cb40-378" aria-hidden="true" tabindex="-1"></a>            <span class="st">'right'</span>: (right <span class="op">+</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb40-379"><a href="#cb40-379" aria-hidden="true" tabindex="-1"></a>            <span class="st">'left'</span>: (top_left[<span class="dv">0</span>] <span class="op">-</span> offset, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>),</span>
<span id="cb40-380"><a href="#cb40-380" aria-hidden="true" tabindex="-1"></a>            <span class="st">'above'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">-</span> offset),</span>
<span id="cb40-381"><a href="#cb40-381" aria-hidden="true" tabindex="-1"></a>            <span class="st">'below'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">+</span> offset),</span>
<span id="cb40-382"><a href="#cb40-382" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_right_corner'</span>: (right <span class="op">-</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb40-383"><a href="#cb40-383" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, bottom <span class="op">-</span> inset),</span>
<span id="cb40-384"><a href="#cb40-384" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_right_corner'</span>: (right <span class="op">-</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb40-385"><a href="#cb40-385" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_left_corner'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> inset, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb40-386"><a href="#cb40-386" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, bottom <span class="op">-</span> inset),</span>
<span id="cb40-387"><a href="#cb40-387" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> inset),</span>
<span id="cb40-388"><a href="#cb40-388" aria-hidden="true" tabindex="-1"></a>            <span class="st">'center'</span>: (top_left[<span class="dv">0</span>] <span class="op">+</span> w <span class="op">//</span> <span class="dv">2</span>, top_left[<span class="dv">1</span>] <span class="op">+</span> h <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb40-389"><a href="#cb40-389" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-390"><a href="#cb40-390" aria-hidden="true" tabindex="-1"></a>        click_x, click_y <span class="op">=</span> click_positions[direction]</span>
<span id="cb40-391"><a href="#cb40-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-392"><a href="#cb40-392" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform the click</span></span>
<span id="cb40-393"><a href="#cb40-393" aria-hidden="true" tabindex="-1"></a>        pyautogui.click(click_x, click_y)</span>
<span id="cb40-394"><a href="#cb40-394" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of the image at (</span><span class="sc">{</span>click_x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>click_y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb40-395"><a href="#cb40-395" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb40-396"><a href="#cb40-396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-397"><a href="#cb40-397" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="ss">f"No good match found at the confidence level of </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb40-398"><a href="#cb40-398" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb40-399"><a href="#cb40-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-400"><a href="#cb40-400" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb40-401"><a href="#cb40-401" aria-hidden="true" tabindex="-1"></a><span class="co">        # Ref Function click_on_image in the following functions 3, 4, 5, etc... </span></span>
<span id="cb40-402"><a href="#cb40-402" aria-hidden="true" tabindex="-1"></a><span class="co">        # These reference functions can be called in the final automation script </span></span>
<span id="cb40-403"><a href="#cb40-403" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb40-404"><a href="#cb40-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-405"><a href="#cb40-405" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 USING click_on_image FUNCTION</span></span>
<span id="cb40-406"><a href="#cb40-406" aria-hidden="true" tabindex="-1"></a><span class="co">#Specific Click Functions Here, See click_on_image for directionals, and image pathes for images</span></span>
<span id="cb40-407"><a href="#cb40-407" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_images_multiple(paths, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">50</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.75</span>):</span>
<span id="cb40-408"><a href="#cb40-408" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image_path <span class="kw">in</span> paths:</span>
<span id="cb40-409"><a href="#cb40-409" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Trying to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> on image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-410"><a href="#cb40-410" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> click_on_image(image_path, direction<span class="op">=</span>direction, offset<span class="op">=</span>offset, inset<span class="op">=</span>inset, confidence<span class="op">=</span>confidence):</span>
<span id="cb40-411"><a href="#cb40-411" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Successfully clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb40-412"><a href="#cb40-412" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb40-413"><a href="#cb40-413" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb40-414"><a href="#cb40-414" aria-hidden="true" tabindex="-1"></a>            logging.warning(<span class="ss">f"Failed to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb40-415"><a href="#cb40-415" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb40-416"><a href="#cb40-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-417"><a href="#cb40-417" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> click_image_single(image_path, direction<span class="op">=</span><span class="st">'center'</span>, offset<span class="op">=</span><span class="dv">50</span>, inset<span class="op">=</span><span class="dv">7</span>, confidence<span class="op">=</span><span class="fl">0.75</span>):</span>
<span id="cb40-418"><a href="#cb40-418" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Trying to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> on image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-419"><a href="#cb40-419" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_on_image(image_path, direction<span class="op">=</span>direction, offset<span class="op">=</span>offset, inset<span class="op">=</span>inset, confidence<span class="op">=</span>confidence):</span>
<span id="cb40-420"><a href="#cb40-420" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Successfully clicked </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb40-421"><a href="#cb40-421" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb40-422"><a href="#cb40-422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-423"><a href="#cb40-423" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="ss">f"Failed to click </span><span class="sc">{</span>direction<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb40-424"><a href="#cb40-424" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb40-425"><a href="#cb40-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-426"><a href="#cb40-426" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-427"><a href="#cb40-427" aria-hidden="true" tabindex="-1"></a><span class="co">    # How to use these click_images_multiple &amp; click_image_single functions in script</span></span>
<span id="cb40-428"><a href="#cb40-428" aria-hidden="true" tabindex="-1"></a><span class="co"> </span></span>
<span id="cb40-429"><a href="#cb40-429" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click below all specified images</span></span>
<span id="cb40-430"><a href="#cb40-430" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_images_multiple(multiple_image_path_name_here, direction='below', offset=100, confidence=0.8):</span></span>
<span id="cb40-431"><a href="#cb40-431" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully.")</span></span>
<span id="cb40-432"><a href="#cb40-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-433"><a href="#cb40-433" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click at the center of a single image</span></span>
<span id="cb40-434"><a href="#cb40-434" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_image_single(single_image_path_name_here, direction='center', confidence=0.8):</span></span>
<span id="cb40-435"><a href="#cb40-435" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully.")</span></span>
<span id="cb40-436"><a href="#cb40-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-437"><a href="#cb40-437" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click at the bottom right corner of a single image</span></span>
<span id="cb40-438"><a href="#cb40-438" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_image_single(single_image_path_name_here, direction='bottom_right_corner', inset=10, confidence=0.8):</span></span>
<span id="cb40-439"><a href="#cb40-439" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully.")</span></span>
<span id="cb40-440"><a href="#cb40-440" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb40-441"><a href="#cb40-441" aria-hidden="true" tabindex="-1"></a><span class="co">    # Click to right of permit_description, by calling offset=5 it was just barely below the image, which is what I wanted</span></span>
<span id="cb40-442"><a href="#cb40-442" aria-hidden="true" tabindex="-1"></a><span class="co">    if click_image_single(permit_description, direction='below', offset=5, confidence=0.8):</span></span>
<span id="cb40-443"><a href="#cb40-443" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Clicked successfully permit_description.")</span></span>
<span id="cb40-444"><a href="#cb40-444" aria-hidden="true" tabindex="-1"></a><span class="co">    time.sleep(1)</span></span>
<span id="cb40-445"><a href="#cb40-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-446"><a href="#cb40-446" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-447"><a href="#cb40-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-448"><a href="#cb40-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-449"><a href="#cb40-449" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 CHECKING IF IMAGE IS PRESENT</span></span>
<span id="cb40-450"><a href="#cb40-450" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_image_found(image_path, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb40-451"><a href="#cb40-451" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-452"><a href="#cb40-452" aria-hidden="true" tabindex="-1"></a><span class="co">    Check if an image is present on the screen with a specified confidence level.</span></span>
<span id="cb40-453"><a href="#cb40-453" aria-hidden="true" tabindex="-1"></a><span class="co">    :param image_path: Path to the image file to be checked.</span></span>
<span id="cb40-454"><a href="#cb40-454" aria-hidden="true" tabindex="-1"></a><span class="co">    :param confidence: The confidence level for the image matching.</span></span>
<span id="cb40-455"><a href="#cb40-455" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: bool - True if image is found, False otherwise.</span></span>
<span id="cb40-456"><a href="#cb40-456" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-457"><a href="#cb40-457" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the existing function to capture and convert the screenshot</span></span>
<span id="cb40-458"><a href="#cb40-458" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb40-459"><a href="#cb40-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-460"><a href="#cb40-460" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the reference image in greyscale</span></span>
<span id="cb40-461"><a href="#cb40-461" aria-hidden="true" tabindex="-1"></a>    ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb40-462"><a href="#cb40-462" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ref_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb40-463"><a href="#cb40-463" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to load reference image from </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-464"><a href="#cb40-464" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb40-465"><a href="#cb40-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-466"><a href="#cb40-466" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb40-467"><a href="#cb40-467" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cv2.matchTemplate(grey_screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb40-468"><a href="#cb40-468" aria-hidden="true" tabindex="-1"></a>    _, max_val, _, _ <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb40-469"><a href="#cb40-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-470"><a href="#cb40-470" aria-hidden="true" tabindex="-1"></a>    found <span class="op">=</span> max_val <span class="op">&gt;=</span> confidence</span>
<span id="cb40-471"><a href="#cb40-471" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> found:</span>
<span id="cb40-472"><a href="#cb40-472" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Image found with confidence </span><span class="sc">{</span>max_val<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-473"><a href="#cb40-473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-474"><a href="#cb40-474" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Image not found with sufficient confidence </span><span class="sc">{</span>confidence<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-475"><a href="#cb40-475" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-476"><a href="#cb40-476" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> found</span>
<span id="cb40-477"><a href="#cb40-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-478"><a href="#cb40-478" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-479"><a href="#cb40-479" aria-hidden="true" tabindex="-1"></a><span class="co">    # How to use the is_image_found function below in script:</span></span>
<span id="cb40-480"><a href="#cb40-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-481"><a href="#cb40-481" aria-hidden="true" tabindex="-1"></a><span class="co">    # Check if the image is found and decide based on that</span></span>
<span id="cb40-482"><a href="#cb40-482" aria-hidden="true" tabindex="-1"></a><span class="co">    if is_image_found(image_path_name_here, confidence=0.8):</span></span>
<span id="cb40-483"><a href="#cb40-483" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Image was found - executing related tasks.")</span></span>
<span id="cb40-484"><a href="#cb40-484" aria-hidden="true" tabindex="-1"></a><span class="co">        # Perform tasks related to the image being found</span></span>
<span id="cb40-485"><a href="#cb40-485" aria-hidden="true" tabindex="-1"></a><span class="co">    else:</span></span>
<span id="cb40-486"><a href="#cb40-486" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info("Image was not found - executing alternative tasks.")</span></span>
<span id="cb40-487"><a href="#cb40-487" aria-hidden="true" tabindex="-1"></a><span class="co">        # Perform alternative tasks</span></span>
<span id="cb40-488"><a href="#cb40-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-489"><a href="#cb40-489" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-490"><a href="#cb40-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-491"><a href="#cb40-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-492"><a href="#cb40-492" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 READ TEXT FROM SCREEN</span></span>
<span id="cb40-493"><a href="#cb40-493" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_for_text_on_screen(target_text):</span>
<span id="cb40-494"><a href="#cb40-494" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-495"><a href="#cb40-495" aria-hidden="true" tabindex="-1"></a><span class="co">    Captures the screen, converts it to greyscale, performs OCR, and checks for the specified text.</span></span>
<span id="cb40-496"><a href="#cb40-496" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb40-497"><a href="#cb40-497" aria-hidden="true" tabindex="-1"></a><span class="co">    :param target_text: Text to search for in the OCR results.</span></span>
<span id="cb40-498"><a href="#cb40-498" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: True if the text is found, False otherwise.</span></span>
<span id="cb40-499"><a href="#cb40-499" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-500"><a href="#cb40-500" aria-hidden="true" tabindex="-1"></a>    grey_screenshot <span class="op">=</span> capture_and_convert_screenshot()</span>
<span id="cb40-501"><a href="#cb40-501" aria-hidden="true" tabindex="-1"></a>    grey_screenshot_pil <span class="op">=</span> Image.fromarray(grey_screenshot)  <span class="co"># Convert numpy array back to a PIL Image</span></span>
<span id="cb40-502"><a href="#cb40-502" aria-hidden="true" tabindex="-1"></a>    screen_text <span class="op">=</span> pytesseract.image_to_string(grey_screenshot_pil)</span>
<span id="cb40-503"><a href="#cb40-503" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> target_text <span class="kw">in</span> screen_text</span>
<span id="cb40-504"><a href="#cb40-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-505"><a href="#cb40-505" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-506"><a href="#cb40-506" aria-hidden="true" tabindex="-1"></a><span class="co">    # How to use the check_for_text_on_screen function below in script:</span></span>
<span id="cb40-507"><a href="#cb40-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-508"><a href="#cb40-508" aria-hidden="true" tabindex="-1"></a><span class="co">    # Define the specific text you're looking for</span></span>
<span id="cb40-509"><a href="#cb40-509" aria-hidden="true" tabindex="-1"></a><span class="co">    specific_text = "text_you_want_to_check_here"</span></span>
<span id="cb40-510"><a href="#cb40-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-511"><a href="#cb40-511" aria-hidden="true" tabindex="-1"></a><span class="co">    # Use the variable in your function call and print statements</span></span>
<span id="cb40-512"><a href="#cb40-512" aria-hidden="true" tabindex="-1"></a><span class="co">    if check_for_text_on_screen(specific_text):</span></span>
<span id="cb40-513"><a href="#cb40-513" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info(f"Found '{specific_text}' on the screen.")</span></span>
<span id="cb40-514"><a href="#cb40-514" aria-hidden="true" tabindex="-1"></a><span class="co">    else:</span></span>
<span id="cb40-515"><a href="#cb40-515" aria-hidden="true" tabindex="-1"></a><span class="co">        logging.info(f"Did not find '{specific_text}' on the screen.")</span></span>
<span id="cb40-516"><a href="#cb40-516" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-517"><a href="#cb40-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-518"><a href="#cb40-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-519"><a href="#cb40-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-520"><a href="#cb40-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-521"><a href="#cb40-521" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-522"><a href="#cb40-522" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the GUI event loop</span></span>
<span id="cb40-523"><a href="#cb40-523" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-524"><a href="#cb40-524" aria-hidden="true" tabindex="-1"></a>root.mainloop()</span>
<span id="cb40-525"><a href="#cb40-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-526"><a href="#cb40-526" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> AINLIST <span class="kw">or</span> <span class="kw">not</span> MemoTXT <span class="kw">or</span> <span class="kw">not</span> PDESC <span class="kw">or</span> <span class="kw">not</span> PFILE <span class="kw">or</span> <span class="kw">not</span> PNUMBER <span class="kw">or</span> <span class="kw">not</span> TREVIEW:</span>
<span id="cb40-527"><a href="#cb40-527" aria-hidden="true" tabindex="-1"></a>    logging.error(<span class="st">"All input fields are required."</span>)</span>
<span id="cb40-528"><a href="#cb40-528" aria-hidden="true" tabindex="-1"></a>    exit()</span>
<span id="cb40-529"><a href="#cb40-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-530"><a href="#cb40-530" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-531"><a href="#cb40-531" aria-hidden="true" tabindex="-1"></a><span class="co">Connect to the database, </span></span>
<span id="cb40-532"><a href="#cb40-532" aria-hidden="true" tabindex="-1"></a><span class="co">pull a simple SQL query with two columns,</span></span>
<span id="cb40-533"><a href="#cb40-533" aria-hidden="true" tabindex="-1"></a><span class="co">then the  for row in rows assigns those columns as variables </span></span>
<span id="cb40-534"><a href="#cb40-534" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-535"><a href="#cb40-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-536"><a href="#cb40-536" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> connect_to_database(db_connection_string)</span>
<span id="cb40-537"><a href="#cb40-537" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> conn.cursor()</span>
<span id="cb40-538"><a href="#cb40-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-539"><a href="#cb40-539" aria-hidden="true" tabindex="-1"></a><span class="co"># The query should accommodate multiple AINs in a list</span></span>
<span id="cb40-540"><a href="#cb40-540" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="ss">f"SELECT TRIM(pm.AIN), pm.LegalAcres FROM TSBv_Parcelmaster AS pm WHERE pm.AIN IN (</span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(AINLIST)<span class="sc">}</span><span class="ss">)"</span></span>
<span id="cb40-541"><a href="#cb40-541" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> execute_query(cursor, query)</span>
<span id="cb40-542"><a href="#cb40-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-543"><a href="#cb40-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through each row in the results</span></span>
<span id="cb40-544"><a href="#cb40-544" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb40-545"><a href="#cb40-545" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb40-546"><a href="#cb40-546" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb40-547"><a href="#cb40-547" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb40-548"><a href="#cb40-548" aria-hidden="true" tabindex="-1"></a>    DBAIN, DBACRE <span class="op">=</span> row</span>
<span id="cb40-549"><a href="#cb40-549" aria-hidden="true" tabindex="-1"></a>    ensure_capslock_off()</span>
<span id="cb40-550"><a href="#cb40-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-551"><a href="#cb40-551" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process each AIN individually</span></span>
<span id="cb40-552"><a href="#cb40-552" aria-hidden="true" tabindex="-1"></a>    set_focus_and_type(<span class="st">'ProVal'</span>, DBAIN)</span>
<span id="cb40-553"><a href="#cb40-553" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-554"><a href="#cb40-554" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"set_focus_and_type"</span>)</span>
<span id="cb40-555"><a href="#cb40-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-556"><a href="#cb40-556" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-557"><a href="#cb40-557" aria-hidden="true" tabindex="-1"></a><span class="co">    Officially begins the automation and screen navigation</span></span>
<span id="cb40-558"><a href="#cb40-558" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-559"><a href="#cb40-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-560"><a href="#cb40-560" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process: Open an AIN in ProVal</span></span>
<span id="cb40-561"><a href="#cb40-561" aria-hidden="true" tabindex="-1"></a>    set_focus_and_type(<span class="st">'ProVal'</span>, DBAIN)</span>
<span id="cb40-562"><a href="#cb40-562" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-563"><a href="#cb40-563" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"set_focus_and_type"</span>)</span>
<span id="cb40-564"><a href="#cb40-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-565"><a href="#cb40-565" aria-hidden="true" tabindex="-1"></a>    pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'o'</span>)</span>
<span id="cb40-566"><a href="#cb40-566" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-567"><a href="#cb40-567" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"hotkey"</span>)</span>
<span id="cb40-568"><a href="#cb40-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-569"><a href="#cb40-569" aria-hidden="true" tabindex="-1"></a>    press_key_multiple_times(<span class="st">'up'</span>, <span class="dv">12</span>)</span>
<span id="cb40-570"><a href="#cb40-570" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press_key_multiple_times"</span>)</span>
<span id="cb40-571"><a href="#cb40-571" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-572"><a href="#cb40-572" aria-hidden="true" tabindex="-1"></a>    press_key_multiple_times(<span class="st">'down'</span>, <span class="dv">4</span>)</span>
<span id="cb40-573"><a href="#cb40-573" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press_key_multiple_times"</span>)</span>
<span id="cb40-574"><a href="#cb40-574" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-575"><a href="#cb40-575" aria-hidden="true" tabindex="-1"></a>    pyautogui.press([<span class="st">'tab'</span>])</span>
<span id="cb40-576"><a href="#cb40-576" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press"</span>)</span>
<span id="cb40-577"><a href="#cb40-577" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-578"><a href="#cb40-578" aria-hidden="true" tabindex="-1"></a>    pyautogui.press([<span class="st">'delete'</span>])</span>
<span id="cb40-579"><a href="#cb40-579" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"press"</span>)</span>
<span id="cb40-580"><a href="#cb40-580" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-581"><a href="#cb40-581" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="bu">str</span>(DBAIN))</span>
<span id="cb40-582"><a href="#cb40-582" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Sent AIN </span><span class="sc">{</span>DBAIN<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb40-583"><a href="#cb40-583" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-584"><a href="#cb40-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-585"><a href="#cb40-585" aria-hidden="true" tabindex="-1"></a>    pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb40-586"><a href="#cb40-586" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-587"><a href="#cb40-587" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Close Pop-Up, Open the </span><span class="sc">{DBAIN}</span><span class="st">}"</span>)</span>
<span id="cb40-588"><a href="#cb40-588" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb40-589"><a href="#cb40-589" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb40-590"><a href="#cb40-590" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb40-591"><a href="#cb40-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-592"><a href="#cb40-592" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-593"><a href="#cb40-593" aria-hidden="true" tabindex="-1"></a><span class="co">    ## NOW </span><span class="re">BEGIN</span><span class="co"> AUTOMATION STEPS FOR THIS TOOL</span></span>
<span id="cb40-594"><a href="#cb40-594" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-595"><a href="#cb40-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-596"><a href="#cb40-596" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-597"><a href="#cb40-597" aria-hidden="true" tabindex="-1"></a><span class="co">    ## START EXAMPLE EXECUTIONS TO BE REPLACE BY YOUR ACTUAL SCRIPT</span></span>
<span id="cb40-598"><a href="#cb40-598" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-599"><a href="#cb40-599" aria-hidden="true" tabindex="-1"></a>    <span class="co"># is_image_found</span></span>
<span id="cb40-600"><a href="#cb40-600" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How to use the is_image_found function below in script:</span></span>
<span id="cb40-601"><a href="#cb40-601" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the image is found and decide based on that</span></span>
<span id="cb40-602"><a href="#cb40-602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_image_found(image_path_name_here, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb40-603"><a href="#cb40-603" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Image was found - executing related tasks."</span>)</span>
<span id="cb40-604"><a href="#cb40-604" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform tasks related to the image being found</span></span>
<span id="cb40-605"><a href="#cb40-605" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-606"><a href="#cb40-606" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Image was not found - executing alternative tasks."</span>)</span>
<span id="cb40-607"><a href="#cb40-607" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform alternative tasks</span></span>
<span id="cb40-608"><a href="#cb40-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-609"><a href="#cb40-609" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check_for_text_on_screen</span></span>
<span id="cb40-610"><a href="#cb40-610" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How to use the check_for_text_on_screen function below in script:</span></span>
<span id="cb40-611"><a href="#cb40-611" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the specific text you're looking for</span></span>
<span id="cb40-612"><a href="#cb40-612" aria-hidden="true" tabindex="-1"></a>    specific_text <span class="op">=</span> <span class="st">"text_you_want_to_check_here"</span></span>
<span id="cb40-613"><a href="#cb40-613" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the variable in your function call and print statements</span></span>
<span id="cb40-614"><a href="#cb40-614" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> check_for_text_on_screen(specific_text):</span>
<span id="cb40-615"><a href="#cb40-615" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Found '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb40-616"><a href="#cb40-616" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-617"><a href="#cb40-617" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Did not find '</span><span class="sc">{</span>specific_text<span class="sc">}</span><span class="ss">' on the screen."</span>)</span>
<span id="cb40-618"><a href="#cb40-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-619"><a href="#cb40-619" aria-hidden="true" tabindex="-1"></a>    <span class="co"># click_images_multiple</span></span>
<span id="cb40-620"><a href="#cb40-620" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How to use these click_images_multiple &amp; click_image_single functions in script</span></span>
<span id="cb40-621"><a href="#cb40-621" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click below all specified images</span></span>
<span id="cb40-622"><a href="#cb40-622" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_images_multiple(multiple_image_path_name_here, direction<span class="op">=</span><span class="st">'below'</span>, offset<span class="op">=</span><span class="dv">100</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb40-623"><a href="#cb40-623" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully."</span>)</span>
<span id="cb40-624"><a href="#cb40-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-625"><a href="#cb40-625" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click at the center of a single image</span></span>
<span id="cb40-626"><a href="#cb40-626" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(single_image_path_name_here, direction<span class="op">=</span><span class="st">'center'</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb40-627"><a href="#cb40-627" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully."</span>)</span>
<span id="cb40-628"><a href="#cb40-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-629"><a href="#cb40-629" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click at the bottom right corner of a single image</span></span>
<span id="cb40-630"><a href="#cb40-630" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(single_image_path_name_here, direction<span class="op">=</span><span class="st">'bottom_right_corner'</span>, inset<span class="op">=</span><span class="dv">10</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb40-631"><a href="#cb40-631" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully."</span>)</span>
<span id="cb40-632"><a href="#cb40-632" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-633"><a href="#cb40-633" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click to right of permit_description, by calling offset=5 it was just barely below the image, which is what I wanted</span></span>
<span id="cb40-634"><a href="#cb40-634" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> click_image_single(permit_description, direction<span class="op">=</span><span class="st">'below'</span>, offset<span class="op">=</span><span class="dv">5</span>, confidence<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb40-635"><a href="#cb40-635" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Clicked successfully permit_description."</span>)</span>
<span id="cb40-636"><a href="#cb40-636" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-637"><a href="#cb40-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-638"><a href="#cb40-638" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pyautogui.typewrite()</span></span>
<span id="cb40-639"><a href="#cb40-639" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="bu">str</span>(DBACRE))</span>
<span id="cb40-640"><a href="#cb40-640" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="bu">str</span>(DBAIN))</span>
<span id="cb40-641"><a href="#cb40-641" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(MemoTXT)</span>
<span id="cb40-642"><a href="#cb40-642" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(PNUMBER)</span>
<span id="cb40-643"><a href="#cb40-643" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="st">'f'</span>)</span>
<span id="cb40-644"><a href="#cb40-644" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="ss">f"04/01/</span><span class="sc">{</span>ForYear<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-645"><a href="#cb40-645" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="ss">f"</span><span class="sc">{</span>PDESC<span class="sc">}</span><span class="ss"> FOR TIMBER REVIEW"</span>)</span>
<span id="cb40-646"><a href="#cb40-646" aria-hidden="true" tabindex="-1"></a>    pyautogui.typewrite(<span class="st">'p'</span>)</span>
<span id="cb40-647"><a href="#cb40-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-648"><a href="#cb40-648" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pyautogui.hotkey()</span></span>
<span id="cb40-649"><a href="#cb40-649" aria-hidden="true" tabindex="-1"></a>    pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'o'</span>)</span>
<span id="cb40-650"><a href="#cb40-650" aria-hidden="true" tabindex="-1"></a>    pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'shift'</span>, <span class="st">'m'</span>)</span>
<span id="cb40-651"><a href="#cb40-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-652"><a href="#cb40-652" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pyautogui.press()</span></span>
<span id="cb40-653"><a href="#cb40-653" aria-hidden="true" tabindex="-1"></a>    pyautogui.press([<span class="st">'tab'</span>])</span>
<span id="cb40-654"><a href="#cb40-654" aria-hidden="true" tabindex="-1"></a>    pyautogui.press([<span class="st">'delete'</span>])</span>
<span id="cb40-655"><a href="#cb40-655" aria-hidden="true" tabindex="-1"></a>    pyautogui.press(<span class="st">'enter'</span>)</span>
<span id="cb40-656"><a href="#cb40-656" aria-hidden="true" tabindex="-1"></a>    pyautogui.press(<span class="st">'l'</span>)</span>
<span id="cb40-657"><a href="#cb40-657" aria-hidden="true" tabindex="-1"></a>    pyautogui.press(<span class="st">'space'</span>)</span>
<span id="cb40-658"><a href="#cb40-658" aria-hidden="true" tabindex="-1"></a>    pyautogui.press(<span class="st">'right'</span>)</span>
<span id="cb40-659"><a href="#cb40-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-660"><a href="#cb40-660" aria-hidden="true" tabindex="-1"></a>    <span class="co"># press_key_multiple_times</span></span>
<span id="cb40-661"><a href="#cb40-661" aria-hidden="true" tabindex="-1"></a>    press_key_multiple_times(<span class="st">'up'</span>, <span class="dv">12</span>)</span>
<span id="cb40-662"><a href="#cb40-662" aria-hidden="true" tabindex="-1"></a>    press_key_multiple_times(<span class="st">'down'</span>, <span class="dv">4</span>)</span>
<span id="cb40-663"><a href="#cb40-663" aria-hidden="true" tabindex="-1"></a>    press_key_multiple_times([<span class="st">'tab'</span>], <span class="dv">3</span>)</span>
<span id="cb40-664"><a href="#cb40-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-665"><a href="#cb40-665" aria-hidden="true" tabindex="-1"></a>    <span class="co"># press_key_with_modifier_multiple_times</span></span>
<span id="cb40-666"><a href="#cb40-666" aria-hidden="true" tabindex="-1"></a>    press_key_with_modifier_multiple_times(<span class="st">'shift'</span>, <span class="st">'tab'</span>, <span class="dv">6</span>)</span>
<span id="cb40-667"><a href="#cb40-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-668"><a href="#cb40-668" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-669"><a href="#cb40-669" aria-hidden="true" tabindex="-1"></a><span class="co">    ## </span><span class="re">END</span><span class="co"> EXAMPLE EXECUTIONS TO BE REPLACE BY YOUR ACTUAL SCRIPT</span></span>
<span id="cb40-670"><a href="#cb40-670" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-671"><a href="#cb40-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-672"><a href="#cb40-672" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-673"><a href="#cb40-673" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-674"><a href="#cb40-674" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save Account</span></span>
<span id="cb40-675"><a href="#cb40-675" aria-hidden="true" tabindex="-1"></a>    pyautogui.hotkey(<span class="st">'ctrl'</span>, <span class="st">'s'</span>)</span>
<span id="cb40-676"><a href="#cb40-676" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"Save."</span>)</span>
<span id="cb40-677"><a href="#cb40-677" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-678"><a href="#cb40-678" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_script:</span>
<span id="cb40-679"><a href="#cb40-679" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Script stopping due to kill key press."</span>)</span>
<span id="cb40-680"><a href="#cb40-680" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb40-681"><a href="#cb40-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-682"><a href="#cb40-682" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="re">END</span><span class="co"> ALL PROCESSESS</span></span>
<span id="cb40-683"><a href="#cb40-683" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="st">"THE END..."</span>)</span>
<span id="cb40-684"><a href="#cb40-684" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb40-685"><a href="#cb40-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-686"><a href="#cb40-686" aria-hidden="true" tabindex="-1"></a><span class="co"># Close the database connection</span></span>
<span id="cb40-687"><a href="#cb40-687" aria-hidden="true" tabindex="-1"></a>conn.close()</span>
<span id="cb40-688"><a href="#cb40-688" aria-hidden="true" tabindex="-1"></a>logging.info(<span class="st">"Database Connection Closed"</span>)</span>
<span id="cb40-689"><a href="#cb40-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-690"><a href="#cb40-690" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb40-691"><a href="#cb40-691" aria-hidden="true" tabindex="-1"></a><span class="co">TEMPLATE 08/20/2024</span></span>
<span id="cb40-692"><a href="#cb40-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-693"><a href="#cb40-693" aria-hidden="true" tabindex="-1"></a><span class="co">Notes:</span></span>
<span id="cb40-694"><a href="#cb40-694" aria-hidden="true" tabindex="-1"></a><span class="co">if AIN:</span></span>
<span id="cb40-695"><a href="#cb40-695" aria-hidden="true" tabindex="-1"></a><span class="co">    press_key_multiple_times('down', 4)</span></span>
<span id="cb40-696"><a href="#cb40-696" aria-hidden="true" tabindex="-1"></a><span class="co">elif PIN:</span></span>
<span id="cb40-697"><a href="#cb40-697" aria-hidden="true" tabindex="-1"></a><span class="co">    press_key_multiple_times('down', 0)</span></span>
<span id="cb40-698"><a href="#cb40-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-699"><a href="#cb40-699" aria-hidden="true" tabindex="-1"></a><span class="co">## For testing purposes, </span></span>
<span id="cb40-700"><a href="#cb40-700" aria-hidden="true" tabindex="-1"></a><span class="co"># PIN: KC-DGW = AIN: 345134</span></span>
<span id="cb40-701"><a href="#cb40-701" aria-hidden="true" tabindex="-1"></a><span class="co"># PIN: KC-DAS = AIN: 348586</span></span>
<span id="cb40-702"><a href="#cb40-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-703"><a href="#cb40-703" aria-hidden="true" tabindex="-1"></a><span class="co">345134,348586</span></span>
<span id="cb40-704"><a href="#cb40-704" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="additional-informaiton" class="level1">
<h1>ADDITIONAL INFORMAITON</h1>
<section id="button-logic" class="level3">
<h3 class="anchored" data-anchor-id="button-logic">BUTTON LOGIC</h3>
<p><strong><em>NOTE: This button logic fails with ProVal because it is so badly designed that it fails to include on-screen labels and definitions for the buttons. We had to default back to using OCR in lieu of this, but with other programs it could work, possibly. </em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>button_info <span class="op">=</span> {</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"window_title"</span>: <span class="st">"ProVal"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"class_name"</span>: <span class="st">"WindowsForms10.BUTTON.app.0.13965fa_r8_ad19"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"button_text"</span>: <span class="st">"Add"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"region_title"</span>: <span class="st">"Aggregate Land"</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="arguments-args" class="level1">
<h1>Arguments (Args)</h1>
<p>The term “Args” in the documentation of a Python function is short for “arguments.” It refers to the parameters that you can pass to the function when you call it. These arguments are essentially inputs that the function uses to perform its operations or calculations. Here’s a quick rundown of what each part of the function documentation typically includes:</p>
<ul>
<li>Args (or Parameters): This section lists all the parameters that the function expects, along with a brief description of each one. It often specifies the type of data each parameter should be (like string, integer, list, etc.) and a short explanation of what it’s used for in the function.</li>
</ul>
<p>In the example I provided for the handle_image_detection function, the “Args” section looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Args:</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    image_path (<span class="bu">str</span>): Path to the image <span class="bu">file</span> to look <span class="cf">for</span>.</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    on_found (<span class="bu">callable</span>, optional): Function to execute <span class="cf">if</span> the image <span class="kw">is</span> found. It should accept no arguments.</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    on_not_found (<span class="bu">callable</span>, optional): Function to execute <span class="cf">if</span> the image <span class="kw">is</span> <span class="kw">not</span> found. It should accept no arguments.</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    confidence (<span class="bu">float</span>): Confidence level <span class="cf">for</span> image detection.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Each line in this section describes one of the function’s parameters:</p>
<ul>
<li>image_path: A string that specifies the path to the image file the function needs to search for.</li>
<li>on_found: A callable (like a function) that is executed if the image is found. It’s optional because you might not always need to perform an action if the image is found.</li>
<li>on_not_found: A callable that is executed if the image is not found, which is also optional.</li>
<li>confidence: A floating-point number that sets the threshold for deciding whether the detected image matches the target image.</li>
</ul>
<p>This part of the documentation helps users understand how to use the function properly by specifying what kind of data to provide and what each piece of data represents.</p>
</section>
<section id="example-breaking-down-a-function-into-blocks-of-code-chunks" class="level1">
<h1>EXAMPLE: Breaking down a function into blocks of code chunks</h1>
<p>ChatGPT Explains: Let’s break down the code snippet you’ve provided, which encapsulates a sequence of operations for image detection and subsequent actions in an automation script using Python. This will help ensure you understand each part before integrating it into your projects:</p>
<section id="try-except-block" class="level2">
<h2 class="anchored" data-anchor-id="try-except-block">1. Try-Except Block</h2>
<p>This block is used to catch and handle any exceptions that might occur during the execution of the code within the try block. It prevents the entire script from crashing and allows for logging specific errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Code that might throw an exception</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handling the exception</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="taking-a-screenshot" class="level2">
<h2 class="anchored" data-anchor-id="taking-a-screenshot">2. Taking a Screenshot</h2>
<p>The function pyautogui.screenshot() captures the current screen, which is then used for image detection. This screenshot is the basis for all subsequent operations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>screenshot <span class="op">=</span> pyautogui.screenshot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-screenshot-to-grayscale" class="level2">
<h2 class="anchored" data-anchor-id="converting-screenshot-to-grayscale">3. Converting Screenshot to Grayscale</h2>
<p>The screenshot is converted to grayscale using OpenCV (cv2). Grayscale conversion is common in image processing tasks like template matching because it simplifies the image, reducing the computational complexity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>screenshot <span class="op">=</span> cv2.cvtColor(np.array(screenshot), cv2.COLOR_BGR2GRAY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reading-the-reference-image" class="level2">
<h2 class="anchored" data-anchor-id="reading-the-reference-image">4. Reading the Reference Image</h2>
<p>The reference image (ref_image) is loaded in grayscale. This is the image you are looking for on the screen. The path to this image is specified by image_path.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="template-matching" class="level2">
<h2 class="anchored" data-anchor-id="template-matching">5. Template Matching</h2>
<p>The cv2.matchTemplate function is used to find the reference image within the screenshot. It slides the reference image over the screenshot and calculates match scores based on the similarity between the reference image and the part of the screenshot it covers.</p>
<ul>
<li>TM_CCOEFF_NORMED: A method for template matching which returns a coefficient that normalizes the matching process, giving a score between -1 and 1 where 1 indicates a perfect match.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> cv2.matchTemplate(screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="finding-the-maximum-match-value" class="level2">
<h2 class="anchored" data-anchor-id="finding-the-maximum-match-value">6. Finding the Maximum Match Value</h2>
<p>cv2.minMaxLoc is used to find the location of the best match in the result matrix returned by matchTemplate. It returns the minimum and maximum values and their locations within the result matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>min_val, max_val, min_loc, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluating-the-match" class="level2">
<h2 class="anchored" data-anchor-id="evaluating-the-match">7. Evaluating the Match</h2>
<p>The maximum value (max_val) is compared against a threshold (confidence). If max_val is greater than or equal to confidence, it is assumed that the image has been found.</p>
<ul>
<li>If Found: If the image is found (max_val &gt;= confidence), log that the image is found and call the on_found function if it is provided.</li>
<li>If Not Found: If the image is not found, log that the image is not found and call the on_not_found function if it is provided.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence:</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Image found: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> on_found:</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        on_found()</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    logging.info(<span class="ss">f"Image not found: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> on_not_found:</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        on_not_found()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exception-handling" class="level2">
<h2 class="anchored" data-anchor-id="exception-handling">8. Exception Handling</h2>
<p>If any errors occur during the execution of the image detection code (like file not found, or an error in the OpenCV operations), they are caught in the except block. The error is logged, providing details that can help in debugging.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    logging.error(<span class="ss">f"Failed to check image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    logging.error(<span class="ss">f"Exception: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This comprehensive breakdown clarifies the sequence of operations involved in image detection using Python with pyautogui and OpenCV, providing robust error handling and flexible response mechanisms through callbacks (on_found and on_not_found).</p>
</section>
<section id="user-defined-confidence-vs-default-confidence" class="level2">
<h2 class="anchored" data-anchor-id="user-defined-confidence-vs-default-confidence">9. User defined confidence vs default confidence</h2>
<section id="understanding-cv2.minmaxloc" class="level3">
<h3 class="anchored" data-anchor-id="understanding-cv2.minmaxloc">Understanding cv2.minMaxLoc</h3>
<p>The function cv2.minMaxLoc() finds the minimum and maximum values and their positions in a given array (in your case, the result of the template matching operation). It returns four values:</p>
<ul>
<li>minVal: The minimum value in the array.</li>
<li>maxVal: The maximum value in the array.</li>
<li>minLoc: The position of the minimum value.</li>
<li>maxLoc: The position of the maximum value.</li>
</ul>
</section>
<section id="explanation-of-the-line" class="level3">
<h3 class="anchored" data-anchor-id="explanation-of-the-line">Explanation of the Line</h3>
<p>In the line <em>, max_val, </em>, _ = cv2.minMaxLoc(result), here’s what each part does:</p>
<ul>
<li>The first _ is used to ignore the minVal.</li>
<li>max_val captures the maxVal, which is what you’re interested in for checking the confidence of the match.</li>
<li>The second and third _ ignore the minLoc and maxLoc respectively.</li>
</ul>
<p>This usage of underscores is helpful for keeping your code cleaner and more focused on the variables you actually need, avoiding the clutter of unused variables. It’s particularly useful in cases like image processing where a function may return multiple pieces of information, but only some of them are relevant to your specific task.</p>
<p>The max_val obtained is then compared against a user-set confidence threshold to decide whether the match is strong enough to be considered valid. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example try/except</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if the image is on the screen</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        screenshot <span class="op">=</span> pyautogui.screenshot()</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        screenshot <span class="op">=</span> cv2.cvtColor(np.array(screenshot), cv2.COLOR_BGR2GRAY)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>        ref_image <span class="op">=</span> cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> cv2.matchTemplate(screenshot, ref_image, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        min_val, max_val, min_loc, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># _, max_val, _, _ = cv2.minMaxLoc(result)</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence:</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Image found: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> on_found:</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>                on_found()</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Image not found: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> on_not_found:</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                on_not_found()</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Failed to check image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Exception: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co"># default confidence level</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>min_val, max_val, min_loc, max_loc <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>handle_image_detection(</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    image_path<span class="op">=</span><span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Settings_icon.PNG'</span>,</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    on_found<span class="op">=</span>access_settings,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    on_not_found<span class="op">=</span>settings_icon_missing</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="co"># VERSUS</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="co"># user defined confidence level</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>_, max_val, _, _ <span class="op">=</span> cv2.minMaxLoc(result)</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="co"># High confidence needed for accessing settings</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>handle_image_detection(</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>    image_path<span class="op">=</span><span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Settings_icon.PNG'</span>,</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>    on_found<span class="op">=</span>access_settings,</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>    on_not_found<span class="op">=</span>settings_icon_missing,</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    confidence<span class="op">=</span><span class="fl">0.95</span>  <span class="co"># High confidence for critical settings adjustment</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower confidence for less critical actions</span></span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>handle_image_detection(</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    image_path<span class="op">=</span><span class="vs">r'S:\Common\Comptroller Tech\Reports\Python\py_images\Optional_feature_icon.PNG'</span>,</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>    on_found<span class="op">=</span>enable_optional_feature,</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>    on_not_found<span class="op">=</span>optional_feature_missing,</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>    confidence<span class="op">=</span><span class="fl">0.7</span>  <span class="co"># Lower confidence might be acceptable here</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>confidence_threshold <span class="op">=</span> <span class="fl">0.8</span>  <span class="co"># User-set confidence</span></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> max_val <span class="op">&gt;=</span> confidence_threshold:</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Proceed with the action because the image match is strong enough</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle the case where the image match is too weak</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="sample-section-header-for-future-additions-to-this-ref-guide" class="level1">
<h1>Sample Section Header For Future Additions To This Ref Guide</h1>
<section id="samplesubheader" class="level3">
<h3 class="anchored" data-anchor-id="samplesubheader">SampleSubHeader</h3>
<ul>
<li>List</li>
<li>List
<ul>
<li>List indented</li>
<li>List indented</li>
</ul></li>
</ul>
<p>This is a code chuck</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS THE FUNCTION</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># THIS IS CALLING THE FUNCTION BELOW IN SCRIPT</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>