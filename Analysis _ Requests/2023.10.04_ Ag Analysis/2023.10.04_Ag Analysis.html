<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ag-analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="2023.10.04_Ag Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="2023.10.04_Ag Analysis_files/libs/quarto-html/quarto.js"></script>
<script src="2023.10.04_Ag Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="2023.10.04_Ag Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2023.10.04_Ag Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="2023.10.04_Ag Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2023.10.04_Ag Analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2023.10.04_Ag Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2023.10.04_Ag Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2023.10.04_Ag Analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="ag-analysis" class="level1">
<h1>Ag Analysis</h1>
<section id="a-review-of-the-impact-on-changing-the-agriculture-exemption" class="level2">
<h2 class="anchored" data-anchor-id="a-review-of-the-impact-on-changing-the-agriculture-exemption">A review of the impact on changing the Agriculture exemption</h2>
<hr>
<section id="the-background" class="level3">
<h3 class="anchored" data-anchor-id="the-background">The Background:</h3>
<p>Jessica Roach, Jefferson County Assessor and Representatives Raymond and Furniss are interested in Ag Exemption changes and want to know how those changes would impact other Idaho counties.</p>
<p>The current iteration of the changes would investigate how increasing the 5-acre minimum for Ag Exemptions to 10, 15, or 20 acres might eliminate some from taking advantage of the program and help preserve true agricultural land by disincentivizing owners from breaking up their parcels into smaller chunks, thereby preserving true agricultural land. The change would also require an IRS form for anything under 20 acres, proving true agricultural land use and profit.</p>
<hr>
</section>
<section id="open-questions" class="level3">
<h3 class="anchored" data-anchor-id="open-questions">Open Questions:</h3>
<ol type="1">
<li><p>How does increasing the 5 acres or less requirements to 10, 15, or 20 acres impact your county?</p>
<ul>
<li><p>How many NON-CONTIGUOUS parcels between 5-20 acres are receiving the AG valuations VS how many are not?</p></li>
<li><p>How many NON-CONTIGUOUS parcels between 15-20 acres are receiving the AG valuation VS how many are not?</p></li>
<li><p>Does 10, 15, or 20 acres solve the issues, the most, of those taking advantage of the tax break?</p></li>
</ul></li>
<li><p>What is the fiscal impact to your county on AG?</p></li>
<li><p>Do you still track the exempted value on AG?</p></li>
<li><p>What is the break down of tax burden per category (residential, AG, commercial, operating property?</p></li>
</ol>
<hr>
</section>
<section id="r-analysis---pulling-in-relevant-data" class="level3">
<h3 class="anchored" data-anchor-id="r-analysis---pulling-in-relevant-data">R Analysis - Pulling in Relevant Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @Year <span class="dt">INT</span> <span class="op">=</span> <span class="dv">20230101</span>;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @LastUpdateYear <span class="dt">VARCHAR</span>(<span class="dv">10</span>) <span class="op">=</span> <span class="st">'2023-01-01'</span>;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>CTE_Allocations <span class="kw">AS</span> (</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  e.lrsn</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>, e.ext_id</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>, e.extension</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>, e.ext_description</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>, a.land_line_number</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>, a.group_code</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>, impgroup.tbl_element_desc <span class="kw">AS</span> ImpGroup_Descr</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>, a.cost_value</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> extensions <span class="kw">AS</span> e</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> allocations <span class="kw">AS</span> a <span class="kw">ON</span> a.lrsn<span class="op">=</span>e.lrsn </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> a.extension<span class="op">=</span>e.extension</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> a.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> codes_table <span class="kw">AS</span> impgroup <span class="kw">ON</span> impgroup.tbl_element<span class="op">=</span>a.group_code</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> impgroup.code_status<span class="op">=</span><span class="st">'A'</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> impgroup.tbl_type_code <span class="op">=</span> <span class="st">'impgroup'</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> a.group_code <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'81%'</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> a.group_code <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'99%'</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> a.group_code <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'98%'</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">--AND a.group_code IN ('01','03','04','05')</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">--AND a.group_code IN ('01','03','04','05','06','07','09')</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> e.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> e.eff_year <span class="op">=</span> @Year</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> e.extension <span class="kw">LIKE</span> <span class="st">'L%'</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>CTE_LandDetails <span class="kw">AS</span> (</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>lh.RevObjId <span class="kw">AS</span> lrsn</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>,lh.TotalMktAcreage</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>,lh.TotalMktValue</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>,ld.LandLineNumber</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>,ld.LandType</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>,lt.land_type_desc</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>,ld.AppdValue</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>,ld.ActualFrontage</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>,ld.LDAcres <span class="kw">AS</span> Land_Detail_Acres</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>,ld.SoilIdent</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>, <span class="cf">CASE</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> lh.TotalMktAcreage <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Under_5_Acres'</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> lh.TotalMktAcreage <span class="op">&gt;=</span> <span class="dv">5</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">10</span> <span class="cf">THEN</span> <span class="st">'5-9_Acres'</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> lh.TotalMktAcreage <span class="op">&gt;=</span> <span class="dv">10</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">THEN</span> <span class="st">'10-14_Acres'</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> lh.TotalMktAcreage <span class="op">&gt;=</span> <span class="dv">15</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">20</span> <span class="cf">THEN</span> <span class="st">'15-19_Acres'</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> lh.TotalMktAcreage <span class="op">&gt;=</span> <span class="dv">20</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">50</span> <span class="cf">THEN</span> <span class="st">'20-49_Acres'</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> lh.TotalMktAcreage <span class="op">&gt;=</span> <span class="dv">50</span> <span class="cf">THEN</span> <span class="st">'50_Plus_Acres'</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> <span class="st">'Review'</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">END</span> <span class="kw">AS</span> TotalMktAcre_Size_Groups</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>, <span class="cf">CASE</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Under_5_Acres'</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> ld.LDAcres <span class="op">&gt;=</span> <span class="dv">5</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">10</span> <span class="cf">THEN</span> <span class="st">'5-9_Acres'</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> ld.LDAcres <span class="op">&gt;=</span> <span class="dv">10</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">15</span> <span class="cf">THEN</span> <span class="st">'10-14_Acres'</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> ld.LDAcres <span class="op">&gt;=</span> <span class="dv">15</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">20</span> <span class="cf">THEN</span> <span class="st">'15-19_Acres'</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> ld.LDAcres <span class="op">&gt;=</span> <span class="dv">20</span> <span class="kw">AND</span> ld.LDAcres <span class="op">&lt;</span> <span class="dv">50</span> <span class="cf">THEN</span> <span class="st">'20-49_Acres'</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> ld.LDAcres <span class="op">&gt;=</span> <span class="dv">50</span> <span class="cf">THEN</span> <span class="st">'50_Plus_Acres'</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> <span class="st">'Review'</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">END</span> <span class="kw">AS</span> LandDetailAcre_Size_Groups</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co">--Land Header</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> LandHeader <span class="kw">AS</span> lh</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co">--AS lh ON lh.RevObjId=a.lrsn </span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="co">--Land Detail</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> LandDetail <span class="kw">AS</span> ld <span class="kw">ON</span> lh.<span class="kw">id</span><span class="op">=</span>ld.LandHeaderId </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> ld.EffStatus<span class="op">=</span><span class="st">'A'</span> </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> ld.PostingSource<span class="op">=</span><span class="st">'A'</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="co">--AND ld.LandType IN ('4','41','45','52','6','61','62','73','75','8')</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Land Types</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> land_types <span class="kw">AS</span> lt <span class="kw">ON</span> ld.LandType<span class="op">=</span>lt.land_type</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> lh.EffStatus<span class="op">=</span> <span class="st">'A'</span> </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> lh.PostingSource<span class="op">=</span><span class="st">'A'</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> lh.LastUpdate <span class="op">&gt;</span> @LastUpdateYear</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>CTE_ImpCat <span class="kw">AS</span> (</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    c.tbl_type_code <span class="kw">AS</span> CodeType</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>,   <span class="fu">CONVERT</span>(<span class="dt">VARCHAR</span>(<span class="dv">255</span>), <span class="fu">TRIM</span>(c.tbl_element)) <span class="kw">AS</span> Imp_GroupCode_Num</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>,    c.tbl_element_desc <span class="kw">AS</span> Imp_GroupCode_Description</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>,    <span class="fu">CAST</span>(<span class="kw">LEFT</span>(c.tbl_element, <span class="dv">2</span>) <span class="kw">AS</span> <span class="dt">INT</span>) <span class="kw">AS</span> StateCode#</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>,    <span class="cf">CASE</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'99'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Non-Allocated_Error'</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'98'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Non-Allocated_Error'</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'01'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Ag'</span> <span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'03'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Ag'</span><span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'04'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Ag'</span><span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'05'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Ag'</span><span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'06'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Timber'</span><span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'07'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Timber'</span><span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'08'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Reforested_Expired'</span><span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'09'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Mineral'</span><span class="co">--Or 'Timber_Ag'</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'10'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'11'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'12'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'15'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'20'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'25'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'26'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'30'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'31'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'32'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'33'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'34'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'37'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'41'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'46'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'47'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'48'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'49'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'50'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'55'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'65'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'13'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'14'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'16'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'17'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'18'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'21'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'22'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'27'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'35'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'36'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'38'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'39'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'42'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'43'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'51'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'19'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Public_Owned'</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'45'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Operating_Property'</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'EXEMPT'</span>, c.tbl_element_desc) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Exempt_Property'</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'OPERATING'</span>, c.tbl_element_desc) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Operating_Property'</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'QIE'</span>, c.tbl_element_desc) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Qualified_Improvement_Expenditure'</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> CHARINDEX(<span class="st">'P'</span>, c.tbl_element) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Business_Personal_Property'</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">ELSE</span> <span class="kw">NULL</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span> <span class="kw">AS</span> Imp_Type_Key</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    codes_table <span class="kw">AS</span> c</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> c.tbl_type_code <span class="op">=</span> <span class="st">'impgroup'</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> c.code_status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>CTE_Cert <span class="kw">AS</span> (</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> </span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>    lrsn,</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Certified Values</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    v.land_market_val <span class="kw">AS</span> CertValue_Land_NoEx,</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    v.imp_val <span class="kw">AS</span> CertValue_Imp,</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>    (v.imp_val <span class="op">+</span> v.land_market_val) <span class="kw">AS</span> CertValue_Total,</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    v.eff_year <span class="kw">AS</span> Tax_Year,</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> v.lrsn <span class="kw">ORDER</span> <span class="kw">BY</span> v.last_update <span class="kw">DESC</span>) <span class="kw">AS</span> RowNumber</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> valuation <span class="kw">AS</span> v</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> v.eff_year <span class="kw">BETWEEN</span> <span class="dv">20230101</span> <span class="kw">AND</span> <span class="dv">20231231</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a><span class="co">--Change to desired year</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> v.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>CTE_Assessed <span class="kw">AS</span> (</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> </span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>    lrsn,</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Assessed Values</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    v.land_assess <span class="kw">AS</span> AssessedValue_Land_wEx,</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    v.imp_assess <span class="kw">AS</span> AssessedValue_Imp,</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    (v.imp_assess <span class="op">+</span> v.land_assess) <span class="kw">AS</span> AssessedValue_Total,</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    v.eff_year <span class="kw">AS</span> Tax_Year,</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> v.lrsn <span class="kw">ORDER</span> <span class="kw">BY</span> v.last_update <span class="kw">DESC</span>) <span class="kw">AS</span> RowNumber</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> valuation <span class="kw">AS</span> v</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> v.eff_year <span class="kw">BETWEEN</span> <span class="dv">20230101</span> <span class="kw">AND</span> <span class="dv">20231231</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a><span class="co">--Change to desired year</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> v.status <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  <span class="co">--------------------------------</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  <span class="co">--ParcelMaster</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>  <span class="co">--------------------------------</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Select</span> <span class="kw">Distinct</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  pm.lrsn</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>, <span class="cf">CASE</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">9000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">6003</span> <span class="cf">THEN</span> <span class="st">'District_6'</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">6002</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">6001</span> <span class="cf">THEN</span> <span class="st">'District_6'</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">6000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">5003</span> <span class="cf">THEN</span> <span class="st">'District_5'</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">5002</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">5001</span> <span class="cf">THEN</span> <span class="st">'District_5'</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">5000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">4000</span> <span class="cf">THEN</span> <span class="st">'District_4'</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">3000</span> <span class="cf">THEN</span> <span class="st">'District_3'</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">2000</span> <span class="cf">THEN</span> <span class="st">'District_2'</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">1021</span> <span class="cf">THEN</span> <span class="st">'District_1'</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">1020</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">1001</span> <span class="cf">THEN</span> <span class="st">'District_1'</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">1000</span> <span class="cf">THEN</span> <span class="st">'Manufactured_Homes'</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">451</span> <span class="cf">THEN</span> <span class="st">'Commercial'</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">450</span> <span class="cf">THEN</span> <span class="st">'Specialized_Cell_Towers'</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Commercial'</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.neighborhood <span class="op">=</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'N/A_or_Error'</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> <span class="kw">NULL</span></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>  <span class="cf">END</span> <span class="kw">AS</span> District</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>, pm.neighborhood <span class="kw">AS</span> GEO</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.NeighborHoodName) <span class="kw">AS</span> GEO_Name</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.pin) <span class="kw">AS</span> PIN</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.AIN) <span class="kw">AS</span> AIN</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>, crt.CertValue_Land_NoEx</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>, crt.CertValue_Imp</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>, crt.CertValue_Total</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>  <span class="co">--Assessed Values</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>, asd.AssessedValue_Land_wEx</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>, asd.AssessedValue_Imp</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>, asd.AssessedValue_Total</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>, cal.ext_id</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>, cal.extension</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>, cal.ext_description</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>, cal.land_line_number <span class="kw">AS</span> Allocations_LandLineNumber <span class="co">--&lt;As Quality Check</span></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>, cld.LandLineNumber <span class="kw">AS</span> LandDetail_LandLineNumber <span class="co">--&lt;As Quality Check</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>, impkey.Imp_Type_Key</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>, cal.group_code <span class="kw">AS</span> Imp_GroupCode</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>, cal.ImpGroup_Descr</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>, cld.LandType</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>, cld.land_type_desc <span class="kw">AS</span> LandType_Description</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>, cal.cost_value <span class="kw">AS</span> ProVal_Line_Value</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>, cld.AppdValue <span class="kw">AS</span> Appraised_Line_Value</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>, cld.Land_Detail_Acres</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>,  pm.LegalAcres</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>, cld.TotalMktAcre_Size_Groups</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>, cld.LandDetailAcre_Size_Groups</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>, cld.TotalMktAcreage</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>, cld.TotalMktValue</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>, cld.ActualFrontage</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>, cld.SoilIdent</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>, pm.ClassCD <span class="kw">AS</span> PCC_ClassCD</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.PropClassDescr) <span class="kw">AS</span> PCC_Property_Class_Type</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>, <span class="cf">CASE</span> </span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="kw">IN</span> (<span class="st">'010'</span>, <span class="st">'020'</span>, <span class="st">'021'</span>, <span class="st">'022'</span>, <span class="st">'030'</span>, <span class="st">'031'</span>, <span class="st">'032'</span>, <span class="st">'040'</span>, <span class="st">'050'</span>, <span class="st">'060'</span>, <span class="st">'070'</span>, <span class="st">'080'</span>, <span class="st">'090'</span>) <span class="cf">THEN</span> <span class="st">'Business_Personal_Property'</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="kw">IN</span> (<span class="st">'314'</span>, <span class="st">'317'</span>, <span class="st">'322'</span>, <span class="st">'336'</span>, <span class="st">'339'</span>, <span class="st">'343'</span>, <span class="st">'413'</span>, <span class="st">'416'</span>, <span class="st">'421'</span>, <span class="st">'435'</span>, <span class="st">'438'</span>, <span class="st">'442'</span>, <span class="st">'451'</span>, <span class="st">'527'</span>,<span class="st">'461'</span>) <span class="cf">THEN</span> <span class="st">'Commercial_Industrial'</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="kw">IN</span> (<span class="st">'411'</span>, <span class="st">'512'</span>, <span class="st">'515'</span>, <span class="st">'520'</span>, <span class="st">'534'</span>, <span class="st">'537'</span>, <span class="st">'541'</span>, <span class="st">'546'</span>, <span class="st">'548'</span>, <span class="st">'549'</span>, <span class="st">'550'</span>, <span class="st">'555'</span>, <span class="st">'565'</span>,<span class="st">'526'</span>,<span class="st">'561'</span>) <span class="cf">THEN</span> <span class="st">'Residential'</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="kw">IN</span> (<span class="st">'441'</span>, <span class="st">'525'</span>, <span class="st">'690'</span>) <span class="cf">THEN</span> <span class="st">'Mixed_Use_Residential_Commercial'</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="kw">IN</span> (<span class="st">'101'</span>,<span class="st">'103'</span>,<span class="st">'105'</span>,<span class="st">'106'</span>,<span class="st">'107'</span>,<span class="st">'110'</span>,<span class="st">'118'</span>) <span class="cf">THEN</span> <span class="st">'Timber_Ag_Land'</span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="op">=</span> <span class="st">'667'</span> <span class="cf">THEN</span> <span class="st">'Operating_Property'</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="op">=</span> <span class="st">'681'</span> <span class="cf">THEN</span> <span class="st">'Exempt_Property'</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.ClassCD <span class="op">=</span> <span class="st">'Unasigned'</span> <span class="cf">THEN</span> <span class="st">'Unasigned_or_OldInactiveParcel'</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> <span class="st">'Unasigned_or_OldInactiveParcel'</span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>  <span class="cf">END</span> <span class="kw">AS</span> Property_Type_Class</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.TAG) <span class="kw">AS</span> TAG</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a><span class="co">--,  TRIM(pm.DisplayName)) AS Owner</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.SitusAddress) <span class="kw">AS</span> SitusAddress</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.SitusCity) <span class="kw">AS</span> SitusCity</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.SitusState) <span class="kw">AS</span> SitusState</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.SitusZip) <span class="kw">AS</span> SitusZip</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>, <span class="fu">TRIM</span>(pm.CountyNumber) <span class="kw">AS</span> CountyNumber</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>, <span class="cf">CASE</span></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>    <span class="cf">WHEN</span> pm.CountyNumber <span class="op">=</span> <span class="st">'28'</span> <span class="cf">THEN</span> <span class="st">'Kootenai_County'</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>    <span class="cf">ELSE</span> <span class="kw">NULL</span></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>  <span class="cf">END</span> <span class="kw">AS</span> County_Name</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>,  pm.Improvement_Status <span class="co">-- &lt;Improved vs Vacant</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> TSBv_PARCELMASTER <span class="kw">AS</span> pm</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> CTE_Allocations <span class="kw">AS</span> cal <span class="kw">ON</span> cal.lrsn<span class="op">=</span>pm.lrsn</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> CTE_ImpCat <span class="kw">AS</span> impkey <span class="kw">ON</span> impkey.Imp_GroupCode_Num<span class="op">=</span>cal.group_code</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> CTE_LandDetails <span class="kw">AS</span> cld <span class="kw">ON</span> cld.lrsn<span class="op">=</span>cal.lrsn</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> cal.land_line_number<span class="op">=</span>cld.LandLineNumber</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> CTE_Cert <span class="kw">AS</span> crt <span class="kw">ON</span> pm.lrsn <span class="op">=</span> crt.lrsn</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> CTE_Assessed <span class="kw">AS</span> asd <span class="kw">ON</span> pm.lrsn <span class="op">=</span> asd.lrsn</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a><span class="kw">Where</span> pm.EffStatus <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> pm.ClassCD <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'060%'</span> <span class="co">-- &lt;Invalid Personal Property Parcels</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> pm.ClassCD <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'070%'</span> <span class="co">-- &lt;Invalid Personal Property Parcels</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> pm.ClassCD <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'090%'</span> <span class="co">-- &lt;Invalid Personal Property Parcels</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> cal.land_line_number<span class="op">=</span>cld.LandLineNumber</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>  <span class="co">--AND pm.lrsn = '2' --&lt;Used to debug</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> crt.RowNumber<span class="op">=</span><span class="dv">1</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> asd.RowNumber<span class="op">=</span><span class="dv">1</span>; <span class="co">-- End Query</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-analysis---load-libraries" class="level3">
<h3 class="anchored" data-anchor-id="r-analysis---load-libraries">R Analysis - Load Libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(c("tidyverse", "ggplot2", "vctrs"))</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#update.packages(ask = FALSE)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#remove.packages("DBI")</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#update.packages("DBI")</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("vctrs")</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("DBI")</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("odbc")</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(odbc)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vctrs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dbconnect" class="level3">
<h3 class="anchored" data-anchor-id="dbconnect">dbConnect</h3>
</section>
<section id="dbgetquery" class="level3">
<h3 class="anchored" data-anchor-id="dbgetquery">dbGetQuery</h3>
<p><em>Use SQL inside dbGetQuery to create a dataframe called: ag_analysis</em></p>
</section>
<section id="ag_analysis-dataframes-column-names" class="level3">
<h3 class="anchored" data-anchor-id="ag_analysis-dataframes-column-names">ag_analysis dataframe’s column names</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ag_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "lrsn"                       "District"                  
 [3] "GEO"                        "GEO_Name"                  
 [5] "PIN"                        "AIN"                       
 [7] "CertValue_Land_NoEx"        "CertValue_Imp"             
 [9] "CertValue_Total"            "AssessedValue_Land_wEx"    
[11] "AssessedValue_Imp"          "AssessedValue_Total"       
[13] "ext_id"                     "extension"                 
[15] "ext_description"            "Allocations_LandLineNumber"
[17] "LandDetail_LandLineNumber"  "Imp_Type_Key"              
[19] "Imp_GroupCode"              "ImpGroup_Descr"            
[21] "LandType"                   "LandType_Description"      
[23] "ProVal_Line_Value"          "Appraised_Line_Value"      
[25] "Land_Detail_Acres"          "LegalAcres"                
[27] "TotalMktAcre_Size_Groups"   "LandDetailAcre_Size_Groups"
[29] "TotalMktAcreage"            "TotalMktValue"             
[31] "ActualFrontage"             "SoilIdent"                 
[33] "PCC_ClassCD"                "PCC_Property_Class_Type"   
[35] "Property_Type_Class"        "TAG"                       
[37] "SitusAddress"               "SitusCity"                 
[39] "SitusState"                 "SitusZip"                  
[41] "CountyNumber"               "County_Name"               
[43] "Improvement_Status"        </code></pre>
</div>
</div>
</section>
<section id="creating-a-view-dataframe-ag_exemption_compare" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-view-dataframe-ag_exemption_compare">Creating a view dataframe: ag_exemption_compare</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ag_exemption_compare <span class="ot">&lt;-</span> ag_analysis <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Imp_Type_Key <span class="sc">==</span> <span class="st">"Ag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Imp_Type_Key, Property_Type_Class, LandType_Description, ImpGroup_Descr, lrsn, District, GEO, AIN, CertValue_Land_NoEx, AssessedValue_Land_wEx) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dollar_Difference =</span> CertValue_Land_NoEx <span class="sc">-</span> AssessedValue_Land_wEx,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Percent_Difference =</span> (Dollar_Difference <span class="sc">/</span> CertValue_Land_NoEx) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#View(ag_exemption_compare)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#View(head(ag_exemption_compare, 50))</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ag_exemption_compare)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Imp_Type_Key       Property_Type_Class LandType_Description ImpGroup_Descr    
 Length:2628        Length:2628         Length:2628          Length:2628       
 Class :character   Class :character    Class :character     Class :character  
 Mode  :character   Mode  :character    Mode  :character     Mode  :character  
                                                                               
                                                                               
                                                                               
      lrsn          District              GEO           AIN           
 Min.   :    45   Length:2628        Min.   :   4   Length:2628       
 1st Qu.: 27800   Class :character   1st Qu.:2020   Class :character  
 Median : 57020   Mode  :character   Median :5100   Mode  :character  
 Mean   :152814                      Mean   :3894                     
 3rd Qu.: 77596                      3rd Qu.:5600                     
 Max.   :567410                      Max.   :6461                     
 CertValue_Land_NoEx AssessedValue_Land_wEx Dollar_Difference
 Min.   :     20     Min.   :     20        Min.   :      0  
 1st Qu.:  29863     1st Qu.:  23388        1st Qu.:      0  
 Median : 226850     Median : 166651        Median :      0  
 Mean   : 248717     Mean   : 180333        Mean   :  68384  
 3rd Qu.: 350710     3rd Qu.: 296394        3rd Qu.:      0  
 Max.   :4012948     Max.   :1922126        Max.   :3856193  
 Percent_Difference
 Min.   : 0.00     
 1st Qu.: 0.00     
 Median : 0.00     
 Mean   :14.35     
 3rd Qu.: 0.00     
 Max.   :99.47     </code></pre>
</div>
</div>
</section>
<section id="creating-a-view-dataframe-ag_exemption_summary" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-view-dataframe-ag_exemption_summary">Creating a view dataframe: ag_exemption_summary</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ag_exemption_summary <span class="ot">&lt;-</span> ag_exemption_compare <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Dollar_Difference =</span> <span class="fu">sum</span>(Dollar_Difference, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_Percent_Difference =</span> <span class="fu">sum</span>(Percent_Difference, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for average instead of sum: </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Total_Percent_Difference = mean(Percent_Difference, na.rm = TRUE)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#View(ag_exemption_summary)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ag_exemption_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Total_Dollar_Difference Total_Percent_Difference
 Min.   :179713990       Min.   :14.35           
 1st Qu.:179713990       1st Qu.:14.35           
 Median :179713990       Median :14.35           
 Mean   :179713990       Mean   :14.35           
 3rd Qu.:179713990       3rd Qu.:14.35           
 Max.   :179713990       Max.   :14.35           </code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>